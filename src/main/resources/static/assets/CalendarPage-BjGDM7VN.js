import{r as l,j as c,E as P,G as E,H as S,m as G,c as f,b as t,x as R,e as h,P as q,l as b,$ as j,f as y,v as D,k as F,t as k,h as $,a0 as K,a1 as L,a2 as H,F as Y,i as p}from"./vendor-DMmp5gzX.js";import{_ as J,a as u}from"./auth-CM7Hud5Y.js";const Q={class:"container py-4"},W={class:"d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2"},X={class:"d-flex flex-wrap gap-2"},Z={key:0,class:"text-center mt-4"},ee=["src"],te={key:0,class:"modal-backdrop"},ae={class:"modal-box"},oe={class:"d-flex justify-content-end gap-2"},ne={key:1,class:"modal-backdrop"},se={class:"modal-box"},le={class:"mb-1"},re={class:"mb-1"},de={class:"d-flex justify-content-end gap-2"},ie={__name:"CalendarPage",setup(ue){const B=l(null),d=l([]),w=l("all");c({type:"title",q:""});const x=l(!1),A=l(""),g=l(!1),O=l(!1),V=l(!1),v=l(!1),i=c({}),s=c({title:"",date:"",category:"ê¸°íƒ€",desc:""});c({title:"",category:"ê¸°íƒ€",startDate:"",endDate:"",days:[],freq:"daily",interval:1,startTime:"",endTime:"",desc:""});const z=c({plugins:[P,E,S],initialView:"dayGridMonth",locale:"ko",height:700,events:d,eventClick({event:n}){}});function I(n){switch(n){case"IN_PROGRESS":return{bg:"#0d6efd",border:"#0a58ca"};case"DONE":return{bg:"#198754",border:"#146c43"};case"CANCELLED":return{bg:"#dc3545",border:"#b02a37"};default:return{bg:"#adb5bd",border:"#868e96"}}}async function C(){const n=localStorage.getItem("token");if(!n)return;d.value=[];const[e,a,m]=await Promise.all([u.get("/day",{headers:{Authorization:"Bearer "+n}}),u.get("/search/schedule",{headers:{Authorization:"Bearer "+n}}),u.get("/search/project/todo",{headers:{Authorization:"Bearer "+n}})]);Array.isArray(e.data?.D_Day)&&e.data.D_Day.forEach(o=>{d.value.push({id:`d-${o.id}`,title:`[D-DAY] ${o.examName}`,start:o.examDate,allDay:!0,backgroundColor:"#ffc107",borderColor:"#ffc107",textColor:"#000",extendedProps:{category:o.category,goal:o.goal}})}),Array.isArray(a.data?.todos)&&a.data.todos.forEach(o=>{const r=I(o.status||"IN_PROGRESS");d.value.push({id:`s-${o.scheduleId}`,title:`[ìº˜ë¦°ë”] ${o.title}`,start:o.endDatetime,allDay:!0,backgroundColor:r.bg,borderColor:r.border,extendedProps:{description:o.description,category:o.category}})}),Array.isArray(m.data?.todos)&&m.data.todos.forEach(o=>{const r=I(o.status||"TODO");d.value.push({id:`p-${o.todo_id}`,title:`[ìž¥ê¸°ëª©í‘œ] ${o.title}`,start:o.end,allDay:!0,backgroundColor:r.bg,borderColor:r.border,extendedProps:{description:o.description,category:o.category}})})}async function N(){const n=localStorage.getItem("token");try{await u.post("/save/schedule",{title:s.title,endDatetime:s.date+"T23:59:59",allDay:!0,category:s.category,description:s.desc},{headers:{Authorization:"Bearer "+n}}),g.value=!1,Object.assign(s,{title:"",date:"",category:"ê¸°íƒ€",desc:""}),await C()}catch{alert("ì €ìž¥ ì‹¤íŒ¨")}}function M({event:n}){Object.assign(i,{id:n.id,title:n.title,date:n.startStr.substring(0,10),category:n.extendedProps.category||"",desc:n.extendedProps.description||""}),v.value=!0}async function _(n){const e=localStorage.getItem("token");try{await u.post(`/schedule/delete/${n}`,null,{headers:{Authorization:"Bearer "+e}}),v.value=!1,await C()}catch{alert("ì‚­ì œ ì‹¤íŒ¨")}}async function T(){const n=localStorage.getItem("token"),{data:e}=await u.get("/user/id",{headers:{Authorization:"Bearer "+n}}),a=e.userId,m={filters:[],refreshInterval:{pause:!0,value:0},time:{from:"now-30d",to:"now"}},o={dataView:"9766ed94-3782-4050-b2d1-9d1f6f418b76",query:{language:"kuery",query:`userId.keyword : "${a}"`}},r=window.rison.encode(m),U=window.rison.encode(o);A.value=`https://kibana.montkim.com/app/visualize#/create?embed=true&type=horizontal_bar&indexPattern=9766ed94-3782-4050-b2d1-9d1f6f418b76&_g=${encodeURIComponent(r)}&_a=${encodeURIComponent(U)}`}return G(async()=>{await C(),await T()}),(n,e)=>(p(),f(Y,null,[t("div",Q,[t("div",W,[e[14]||(e[14]=t("h4",{class:"mb-0"},"ðŸ“… ë‚´ ìº˜ë¦°ë”",-1)),t("div",X,[t("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=a=>w.value="all")},"ðŸ“Œ ì „ì²´"),t("button",{class:"btn btn-success",onClick:e[1]||(e[1]=a=>w.value="completed")},"âœ… ì™„ë£Œ"),t("button",{class:"btn btn-warning",onClick:e[2]||(e[2]=a=>w.value="pending")},"â³ ì˜ˆì •"),t("button",{class:"btn btn-info",onClick:e[3]||(e[3]=a=>x.value=!x.value)},"ðŸ“Š í†µê³„"),t("button",{class:"btn btn-primary",onClick:e[4]||(e[4]=a=>g.value=!0)},"+ ì¼ì • ì¶”ê°€"),t("button",{class:"btn btn-outline-warning",onClick:e[5]||(e[5]=a=>O.value=!0)},"ðŸ”„ ë°˜ë³µ ì¼ì •"),t("button",{class:"btn btn-outline-danger",onClick:e[6]||(e[6]=a=>V.value=!0)},"ðŸ—‘ ë°˜ë³µ ì‚­ì œ")])]),t("div",null,[R(b(j),{ref_key:"calendarRef",ref:B,class:"shadow rounded-3 p-2",plugins:[b(P),b(E),b(S)],"initial-view":"dayGridMonth",locale:"ko",height:"700",events:d.value,onEventClick:M},null,8,["plugins","events"])]),x.value?(p(),f("div",Z,[t("iframe",{src:A.value,height:"600",width:"100%",style:{"max-width":"800px"}},null,8,ee)])):h("",!0),(p(),q(K,{to:"body"},[g.value?(p(),f("div",te,[t("div",ae,[e[16]||(e[16]=t("h5",null,"ðŸ“Œ ìƒˆ ì¼ì • ì¶”ê°€",-1)),y(t("input",{"onUpdate:modelValue":e[7]||(e[7]=a=>s.title=a),class:"form-control mb-2",placeholder:"ì œëª©"},null,512),[[D,s.title]]),y(t("input",{type:"date","onUpdate:modelValue":e[8]||(e[8]=a=>s.date=a),class:"form-control mb-2"},null,512),[[D,s.date]]),y(t("select",{"onUpdate:modelValue":e[9]||(e[9]=a=>s.category=a),class:"form-select mb-2"},e[15]||(e[15]=[t("option",{value:"ìš´ë™"},"ìš´ë™",-1),t("option",{value:"ì•½ì†"},"ì•½ì†",-1),t("option",{value:"ê³µë¶€"},"ê³µë¶€",-1),t("option",{value:"ì•Œë°”"},"ì•Œë°”",-1),t("option",{value:"ë°ì´íŠ¸"},"ë°ì´íŠ¸",-1),t("option",{value:"ê¸°íƒ€"},"ê¸°íƒ€",-1)]),512),[[F,s.category]]),y(t("textarea",{"onUpdate:modelValue":e[10]||(e[10]=a=>s.desc=a),class:"form-control mb-3",placeholder:"ë‚´ìš©"},null,512),[[D,s.desc]]),t("div",oe,[t("button",{class:"btn btn-secondary btn-sm",onClick:e[11]||(e[11]=a=>g.value=!1)},"ì·¨ì†Œ"),t("button",{class:"btn btn-primary btn-sm",onClick:N},"ì €ìž¥")])])])):h("",!0),v.value?(p(),f("div",ne,[t("div",se,[t("h5",null,k(i.title),1),t("p",le,[e[17]||(e[17]=t("b",null,"ë‚ ì§œ",-1)),$(" : "+k(i.date),1)]),t("p",re,[e[18]||(e[18]=t("b",null,"ì¹´í…Œê³ ë¦¬",-1)),$(" : "+k(i.category),1)]),t("p",null,[e[19]||(e[19]=t("b",null,"ë‚´ìš©",-1)),$(" : "+k(i.desc),1)]),t("div",de,[t("button",{class:"btn btn-danger btn-sm",onClick:e[12]||(e[12]=a=>_(i.id))},"ì‚­ì œ"),t("button",{class:"btn btn-secondary btn-sm",onClick:e[13]||(e[13]=a=>v.value=!1)},"ë‹«ê¸°")])])])):h("",!0)]))]),R(b(j),L(H(z)),null,16)],64))}},pe=J(ie,[["__scopeId","data-v-4ccc5da7"]]);export{pe as default};
