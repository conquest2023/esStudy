import"./index-CxoReeRl.js";import{p as $,c as g,b as e,h as l,t as u,e as A,F,q as U,n as V,u as R,i as p,r as w,m as J,a4 as K,P as X,M as Y}from"./vendor-DMmp5gzX.js";import{_ as j,a as Z}from"./auth-CM7Hud5Y.js";const ee={class:"we-rcGrid"},te={class:"we-card we-pane we-pane--passage"},se={class:"we-paneHead"},ne={class:"we-timer"},oe={class:"we-passage"},le={class:"we-quote"},ae=["innerHTML"],ie={class:"we-card we-pane we-pane--question"},re={class:"we-paneHead"},ue={class:"we-chip",style:{"box-shadow":"none"}},de={class:"we-qContent"},ce={class:"we-options"},ve=["onClick"],pe={class:"we-optBadge"},fe={class:"we-optText"},we={class:"we-actions"},ge=["disabled"],me=["disabled"],be=["disabled"],ye=["disabled"],xe={key:0,class:"we-explain"},ke={class:"we-explainBody"},$e={class:"we-correctMark"},he={style:{color:"#0f172a"}},Ce={__name:"RcQuestionRenderer",props:{question:{type:Object,required:!0},selectedIndex:{type:Number,default:null},result:{type:Object,default:null},showExplanation:{type:Boolean,default:!1},timerText:{type:String,default:"00:00"}},emits:["select","grade","toggle-explain","next"],setup(i){const a=i,y=R(),d=$(()=>a.question?.content?.questions?.[0]?.options||[]),h=$(()=>a.question.content.questions[0].explanation);function C(o){return String.fromCharCode(65+o)}function q(o){return o?o.replace(/-+/g,'<span class="we-blank">_______</span>'):""}function m(o){const s=[];return a.selectedIndex===o&&s.push("is-selected"),a.result&&(o===a.result.correctIndex&&s.push("is-correct"),a.selectedIndex===o&&o!==a.result.correctIndex&&s.push("is-wrong")),s.join(" ")}async function f(){if(!a.result||a.result.isCorrect||!a.question||!confirm("ì˜¤ë‹µë…¸íŠ¸ì— ì €ìž¥í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))return;const o=localStorage.getItem("token");if(!o){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."),y.push("/login");return}const s={objectId:a.question.id,category:a.question.type,part:a.question.part,level:a.question.level};try{await Z.post("/wrongnote",s,{headers:{Authorization:`Bearer ${o}`}}),console.log("ì˜¤ë‹µë…¸íŠ¸ ì €ìž¥ ì™„ë£Œ"),alert("ì˜¤ë‹µë…¸íŠ¸ì— ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(c){console.error("ì˜¤ë‹µë…¸íŠ¸ ì €ìž¥ ì‹¤íŒ¨",c),alert("ì˜¤ë‹µë…¸íŠ¸ ì €ìž¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}}return(o,s)=>(p(),g("div",ee,[e("section",te,[e("div",se,[s[4]||(s[4]=e("div",{class:"we-paneTitle"},[e("i",{class:"fa-solid fa-align-left",style:{color:"#2563eb"}}),l(" RC PASSAGE ")],-1)),e("div",ne,[s[3]||(s[3]=e("i",{class:"fa-solid fa-clock"},null,-1)),l(" "+u(i.timerText),1)])]),e("div",oe,[e("div",le,[e("span",{innerHTML:q(i.question.content.passage)},null,8,ae)]),s[5]||(s[5]=e("div",{class:"we-passageHint"}," ë¬¸ë§¥ì— ë§žëŠ” ë‹¨ì–´/í˜•íƒœë¥¼ ì„ íƒí•˜ì„¸ìš”. ",-1))])]),e("section",ie,[e("div",re,[s[7]||(s[7]=e("div",{class:"we-paneTitle"},[e("i",{class:"fa-solid fa-circle-question",style:{color:"#2563eb"}}),l(" QUESTION ")],-1)),e("div",ue,[s[6]||(s[6]=e("i",{class:"fa-solid fa-layer-group"},null,-1)),l(" Part "+u(i.question.part),1)])]),e("div",de,[s[14]||(s[14]=e("h2",{class:"we-qTitle"},"ë¹ˆì¹¸ì— ë“¤ì–´ê°ˆ ê°€ìž¥ ì ì ˆí•œ ë‹µì„ ê³ ë¥´ì‹œì˜¤.",-1)),s[15]||(s[15]=e("div",{class:"we-qSub"},"ì„ íƒ í›„ ì±„ì í•˜ë©´ ê²°ê³¼ì™€ í•´ì„¤ì„ í™•ì¸í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.",-1)),e("div",ce,[(p(!0),g(F,null,U(d.value,(c,v)=>(p(),g("button",{key:c+v,class:V(["we-opt",m(v)]),onClick:S=>o.$emit("select",v)},[e("div",pe,u(C(v)),1),e("div",fe,u(c),1)],10,ve))),128))]),e("div",we,[e("button",{class:"we-actionBtn we-actionBtn--primary",disabled:i.selectedIndex===null||!!i.result,onClick:s[0]||(s[0]=c=>o.$emit("grade"))},s[8]||(s[8]=[e("i",{class:"fa-solid fa-check"},null,-1),l(" ì±„ì  ")]),8,ge),e("button",{class:"we-actionBtn",disabled:!i.result,onClick:s[1]||(s[1]=c=>o.$emit("toggle-explain"))},[s[9]||(s[9]=e("i",{class:"fa-solid fa-circle-info"},null,-1)),l(" í•´ì„¤ "+u(i.showExplanation?"ë‹«ê¸°":"ë³´ê¸°"),1)],8,me),e("button",{class:"we-actionBtn we-actionBtn--ghost",disabled:!i.result||i.result?.isCorrect,onClick:f},s[10]||(s[10]=[e("i",{class:"fa-solid fa-bookmark"},null,-1),l(" ì €ìž¥ ")]),8,be),e("button",{class:"we-actionBtn",disabled:!i.result,onClick:s[2]||(s[2]=c=>o.$emit("next"))},s[11]||(s[11]=[e("i",{class:"fa-solid fa-arrow-right"},null,-1),l(" ë‹¤ìŒ ")]),8,ye)]),i.showExplanation&&i.result?(p(),g("div",xe,[s[13]||(s[13]=e("div",{class:"we-explainTitle"},[e("div",{class:"we-explainDot"}),l(" í•´ì„¤ ")],-1)),e("div",ke,u(h.value),1),e("div",$e,[s[12]||(s[12]=l(" ì •ë‹µ: ")),e("b",he,u(d.value[i.result.correctIndex]),1)])])):A("",!0)])])]))}},qe=j(Ce,[["__scopeId","data-v-181f1682"]]),Se={class:"we-page"},Ie={class:"we-container we-session"},Te={key:0,class:"we-loading-state"},Be={key:1,class:"we-complete-state"},_e={class:"we-complete-actions"},Ee={key:2},Ae={class:"we-sessionHead"},Re={class:"we-chipRow",style:{"margin-top":"10px"}},je={class:"we-chip"},Me={class:"we-chip"},Ne={class:"we-sessionHead__right"},Pe={class:"we-progressTop"},Oe={class:"we-progressTop__row"},ze={class:"we-progressTop__value"},He={class:"we-progressTop__bar"},Le={key:3,class:"we-empty-state"},De={class:"we-bottomTabs"},Ge={class:"we-bottomTabs__inner"},Qe={__name:"PracticeSession",setup(i){const a=R(),y=n=>a.push(n),d=w([]),h=w(!1),C=w(!1),q=w(null),m=w(0),f=w(null),o=w(null),s=w(!1),c=w("01:24");let v=84,S=null;const M=n=>n?{A:0,B:1,C:2,D:3}[n.toUpperCase().trim()]??0:0;async function T(n=null){h.value=!0,C.value=!1;try{const r=`/api/english?size=10${n?`&lastId=${n}`:""}`,k=await fetch(r);if(!k.ok)throw new Error("ë„¤íŠ¸ì›Œí¬ ì‘ë‹µì´ ì¢‹ì§€ ì•ŠìŠµë‹ˆë‹¤.");const b=(await k.json())?.ok;Array.isArray(b)&&b.length>0?(d.value=b.map(_=>{const W=_.content?.questions||[];return{..._,content:{..._.content,questions:W.map(E=>({...E,correctIndex:M(E.answer)}))}}}),q.value=b[b.length-1]._id||b[b.length-1].id,m.value=0):n&&alert("ë” ì´ìƒ ë¶ˆëŸ¬ì˜¬ ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤.")}catch(t){console.error("Fetch Error:",t),alert("ë¬¸ì œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{h.value=!1}}function N(){T(q.value)}J(()=>{T(null),S=setInterval(()=>{v=Math.max(0,v-1);const n=String(Math.floor(v/60)).padStart(2,"0"),t=String(v%60).padStart(2,"0");c.value=`${n}:${t}`},1e3)}),K(()=>{S&&clearInterval(S)});const x=$(()=>d.value[m.value]),B=$(()=>d.value.length),P=$(()=>x.value?.level??"â€”"),O=$(()=>x.value?.tags??[]),z=$(()=>B.value===0?0:Math.round((m.value+1)/B.value*100));function H(n){o.value||(f.value=n)}function L(){if(f.value===null)return;const n=x.value.content.questions[0].correctIndex,t=f.value===n;o.value={isCorrect:t,correctIndex:n},D(t),t||(s.value=!0)}async function D(n){const t=x.value,r=String.fromCharCode(65+f.value),k={objectId:t._id||t.id,chosenAnswer:r,isCorrect:n,category:t.type,part:t.part,level:t.level};try{const I=localStorage.getItem("token");if(!(await fetch("/api/english/log",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${I}`},body:JSON.stringify(k)})).ok)throw new Error("ë¡œê·¸ ì €ìž¥ ì‹¤íŒ¨")}catch(I){console.error("Save Log Error:",I)}}function G(){if(m.value>=B.value-1){d.value=[],C.value=!0;return}m.value+=1,f.value=null,o.value=null,s.value=!1,v=84}async function Q(){if(!o.value)return;const n=x.value,t=n.content.questions[0],r={questionId:n._id||n.id,type:n.type,part:n.part,level:n.level,tags:n.tags,passage:n.content.passage,options:t.options,selectedIndex:f.value,correctIndex:o.value.correctIndex,explanation:t.explanation,solvedAt:new Date().toISOString()};try{(await fetch("/api/v1/learning-logs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok&&alert("ì˜¤ë‹µë…¸íŠ¸ì— ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(k){console.error("Save Wrong Error:",k)}}return(n,t)=>(p(),g("div",Se,[e("main",Ie,[h.value&&d.value.length===0?(p(),g("div",Te,t[7]||(t[7]=[e("i",{class:"fa-solid fa-circle-notch fa-spin"},null,-1),l(" ë¬¸ì œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ìž…ë‹ˆë‹¤... ")]))):C.value?(p(),g("div",Be,[t[10]||(t[10]=e("div",{class:"we-complete-icon"},"ðŸŽ‰",-1)),t[11]||(t[11]=e("h2",{class:"we-complete-title"},"ì˜¤ëŠ˜ì˜ ì—°ìŠµ ì™„ë£Œ!",-1)),t[12]||(t[12]=e("p",{class:"we-complete-sub"},"í•œ ì„¸íŠ¸(10ë¬¸ì œ)ë¥¼ ëª¨ë‘ ì •ë³µí•˜ì…¨ìŠµë‹ˆë‹¤.",-1)),e("div",_e,[e("button",{onClick:N,class:"we-btn we-btn--primary"},t[8]||(t[8]=[e("i",{class:"fa-solid fa-rotate-right"},null,-1),l(" 10ë¬¸ì œ ë” í’€ê¸° ")])),e("button",{onClick:t[0]||(t[0]=r=>y("/wrong-notes")),class:"we-btn we-btn--outline"},t[9]||(t[9]=[e("i",{class:"fa-solid fa-book"},null,-1),l(" ì˜¤ë‹µë…¸íŠ¸ í™•ì¸ ")]))])])):d.value.length>0?(p(),g("div",Ee,[e("div",Ae,[e("div",null,[t[16]||(t[16]=e("h1",{class:"we-sessionTitle"},"RC ë¬¸ì œí’€ì´",-1)),t[17]||(t[17]=e("div",{class:"we-sessionSub"},"Part 5 Â· ë¬¸ë²•/ì–´íœ˜ ë¹ˆì¹¸ ì±„ìš°ê¸°",-1)),e("div",Re,[t[15]||(t[15]=e("div",{class:"we-chip"},[e("i",{class:"fa-solid fa-layer-group"}),l(" RC")],-1)),e("div",je,[t[13]||(t[13]=e("i",{class:"fa-solid fa-medal"},null,-1)),l(" "+u(P.value),1)]),e("div",Me,[t[14]||(t[14]=e("i",{class:"fa-solid fa-hashtag"},null,-1)),l(" "+u(O.value.join(" Â· ")),1)])])]),e("div",Ne,[e("div",Pe,[e("div",Oe,[t[18]||(t[18]=e("div",{class:"we-progressTop__label"},"Current Batch Progress",-1)),e("div",ze,u(m.value+1)+" / "+u(d.value.length),1)]),e("div",He,[e("div",{class:"we-progressTop__fill",style:Y({width:z.value+"%"})},null,4)])])])]),x.value?(p(),X(qe,{key:0,question:x.value,"selected-index":f.value,result:o.value,"show-explanation":s.value,"timer-text":c.value,onSelect:H,onGrade:L,onToggleExplain:t[1]||(t[1]=r=>s.value=!s.value),onNext:G,onSaveWrong:Q},null,8,["question","selected-index","result","show-explanation","timer-text"])):A("",!0)])):(p(),g("div",Le,[t[19]||(t[19]=e("p",null,"í’€ì–´ë³¼ ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤.",-1)),e("button",{onClick:t[2]||(t[2]=r=>T(null)),class:"we-btn we-btn--primary",style:{"margin-top":"20px"}}," ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œìž‘ ")])),e("div",De,[e("div",Ge,[e("button",{class:"we-tabBtn is-active",onClick:t[3]||(t[3]=r=>y("/practice/rc"))},t[20]||(t[20]=[e("i",{class:"fa-solid fa-file-pen"},null,-1),l(" RC ")])),e("button",{class:"we-tabBtn",onClick:t[4]||(t[4]=r=>y("/practice/vocab"))},t[21]||(t[21]=[e("i",{class:"fa-solid fa-spell-check"},null,-1),l(" ë‹¨ì–´ ")])),e("button",{class:"we-tabBtn",onClick:t[5]||(t[5]=r=>y("/practice/speaking"))},t[22]||(t[22]=[e("i",{class:"fa-solid fa-microphone-lines"},null,-1),l(" íšŒí™” ")])),e("button",{class:"we-tabBtn",onClick:t[6]||(t[6]=r=>y("/wrong-notes"))},t[23]||(t[23]=[e("i",{class:"fa-solid fa-book-bookmark"},null,-1),l(" ì˜¤ë‹µë…¸íŠ¸ ")]))])])])]))}},Ve=j(Qe,[["__scopeId","data-v-de919a6a"]]);export{Ve as default};
