import{r as o,j as J,m as W,c as r,b as e,x as Y,h as T,w as Z,n as q,y as ee,T as te,f as P,v as Q,K as se,F as M,q as A,e as h,t as i,a as d,i as c,A as ae,Q as ne}from"./vendor-DMmp5gzX.js";import{_ as le}from"./auth-CM7Hud5Y.js";const ie={class:"container py-4"},re={class:"mb-4"},ce={class:"d-flex justify-content-between align-items-center mb-2"},ue={class:"list-group"},de=["onClick"],ve={class:"me-3"},me={class:"fw-bold mb-1 text-truncate"},be={class:"text-muted"},fe={class:"row g-3 mb-4"},ye={class:"col-md-8"},ge={class:"input-group"},pe={class:"col-md-4"},_e={class:"d-flex flex-wrap gap-2"},he=["onClick"],we={class:"row"},ke={class:"col-lg-8"},xe={key:0,class:"text-center py-5 text-muted"},$e={key:1},Ce=["onClick"],Ie={class:"card-body"},Te={class:"card-title mb-2 text-truncate-2"},Pe={class:"card-text small text-muted mb-1"},Me={class:"d-flex justify-content-between text-muted small"},Ae={key:0,class:"d-flex justify-content-center my-4"},Se=["disabled"],Ue={class:"align-self-center"},ze=["disabled"],Be={class:"modal-dialog modal-lg modal-dialog-scrollable"},Le={class:"modal-content"},je={class:"modal-header"},Ke={class:"modal-title"},De={class:"modal-body"},Oe=["innerHTML"],qe=["disabled"],Qe={key:0},He={key:1,class:"spinner-border spinner-border-sm"},Ve={key:0,class:"text-muted small mb-1"},Ee=["innerHTML"],Ge={__name:"GovInterviewPanel",setup(oe){const k=["행정직","경찰","소방"],v=o(""),y=o(!1),m=o([]),S=o([]);o([]);const b=o(0),U=o(0),u=o(0),H=o(10),n=o(null),f=o(""),g=o(!1),z=o(null),B=localStorage.getItem("token"),p=o(!0);function x(){p.value=!p.value}let $=null;const w=J({series:["행정직"]});async function V(){u.value=0;const s=v.value.trim(),{data:t}=await d.get(`/api/search/interview/${encodeURIComponent(s)}`);m.value=t.searchResult||[],b.value=1,U.value=m.value.length;try{await d.post("/api/interview/log",{eventType:"search",targetId:null,query:s,category:"공무원",subCategory:w.series[0]||null},{headers:{Authorization:B?`Bearer ${B}`:void 0}})}catch(a){console.warn("검색 로그 저장 실패:",a)}}async function E(){if(!f.value||f.value.trim()===""){alert("답변을 입력해주세요.");return}g.value=!0;try{const s=localStorage.getItem("token");if(!s){alert("로그인이 필요합니다.");return}const t={questionId:n.value?.id,title:n.value?.question,answer:f.value},a=await d.post("/api/save/interview/question",t,{headers:{Authorization:`Bearer ${s}`}});a.data.success?(alert(a.data.message||"답변이 저장되었습니다."),K(),f.value=""):alert("답변 저장에 실패했습니다.")}catch(s){console.error(s),alert("서버 오류가 발생했습니다.")}finally{g.value=!1}}async function C(){if(n.value?.id)try{const t=(await d.get("/api/interview/best/answer",{headers:{"X-Question-Ids":n.value.id}})).data;if(Array.isArray(t)&&t.length>0){const a=t[0];n.value.answerKey=a.answer,n.value.bestUsername=a.username||"익명"}else n.value.answerKey='<p class="text-muted">베스트 답변이 아직 없습니다.</p>',n.value.bestUsername=null}catch(s){console.warn("베스트 답변 불러오기 실패:",s),n.value.answerKey='<p class="text-muted">불러오는 중 오류가 발생했습니다.</p>',n.value.bestUsername=null}}async function _(){const s=w.series[0]||"행정직",{data:t}=await d.get(`/api/interview/공무원/${s}`,{params:{page:u.value,size:H.value}});m.value=t.interview||[],b.value=t.totalPages,U.value=t.totalElements}async function L(){y.value=!0;try{v.value&&v.value.trim()!==""?await V():await _()}finally{y.value=!1}}function G(s){w.series=[s],v.value="",u.value=0,L()}function N(){u.value<b.value-1&&(u.value++,_())}function R(){u.value>0&&(u.value--,_())}async function F(){const s=w.series[0]||"행정직";try{const{data:t}=await d.get(`/api/interview/aggregation/${s}`);S.value=t.aggregation||[]}catch(t){console.warn("TOP5 조회 실패:",t)}}async function X(s){const t=localStorage.getItem("token")||null,a={eventType:"click",userId:null,username:null,targetId:s.id,query:null,category:s.category||"공무원",subCategory:s.subCategory||null};try{await d.post("/api/interview/log",a,{headers:t?{Authorization:`Bearer ${t}`}:{}})}catch(I){console.warn("로그 저장 실패:",I.message)}}function D(s){O(s),C(),X(s)}function O(s){n.value=s,j()}function j(){$||($=new ne(z.value)),$.show()}function K(){$.hide(),n.value=null}const l=s=>new Date(s).toLocaleDateString();return W(()=>{F(),_()}),(s,t)=>(c(),r("div",ie,[t[10]||(t[10]=e("header",{class:"d-flex align-items-center gap-3 mb-4"},[e("i",{class:"fas fa-user-shield fs-2 text-primary"}),e("h1",{class:"h3 fw-bold mb-0"},"공무원 면접 질문 뱅크")],-1)),e("section",re,[e("div",ce,[t[2]||(t[2]=e("h6",{class:"fw-semibold mb-0"},[e("i",{class:"fas fa-fire me-2 text-danger"}),T("이번 주 인기 TOP 5 ")],-1)),e("button",{class:"btn btn-sm btn-outline-secondary",onClick:Z(x,["stop"]),style:{"z-index":"1",position:"relative"}},[e("i",{class:q(p.value?"fas fa-chevron-up":"fas fa-chevron-down")},null,2)])]),Y(te,{name:"fade"},{default:ee(()=>[P(e("ul",ue,[(c(!0),r(M,null,A(S.value,(a,I)=>(c(),r("li",{key:a.id,class:"list-group-item list-group-item-action d-flex justify-content-between align-items-start py-3 px-3 hover-shadow-sm cursor-pointer",onClick:zt=>O(a)},[e("div",ve,[e("div",me,i(I+1)+". "+i(a.question),1),e("small",be,"카테고리: "+i(a.category)+" / "+i(a.subCategory),1)])],8,de))),128))],512),[[ae,p.value]])]),_:1})]),e("div",fe,[e("div",ye,[e("div",ge,[P(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>v.value=a),onKeyup:se(L,["enter"]),type:"search",class:"form-control",placeholder:"키워드·질문 입력 후 Enter"},null,544),[[Q,v.value]]),e("button",{class:"btn btn-primary",onClick:L},"검색")])]),e("div",pe,[e("div",_e,[(c(),r(M,null,A(k,a=>e("span",{key:a,onClick:I=>G(a),class:q(["badge rounded-pill py-2 px-3 cursor-pointer",w.series.includes(a)?"bg-primary text-white":"bg-light text-dark"])},i(a),11,he)),64))])])]),e("div",we,[e("main",ke,[y.value?(c(),r("div",xe,t[3]||(t[3]=[e("div",{class:"spinner-border",role:"status"},null,-1)]))):h("",!0),!y.value&&m.value&&m.value.length>0?(c(),r("div",$e,[(c(!0),r(M,null,A(m.value,a=>(c(),r("div",{key:a.id,class:"card mb-3 shadow-sm hover-shadow cursor-pointer",onClick:I=>D(a)},[e("div",Ie,[e("h5",Te,i(a.question),1),e("p",Pe,"카테고리: "+i(a.category)+" / "+i(a.subCategory),1),e("div",Me,[e("span",null,[t[4]||(t[4]=e("i",{class:"fas fa-clock me-1"},null,-1)),T(i(l(a.createdAt)),1)])])])],8,Ce))),128))])):h("",!0)]),b.value>1?(c(),r("div",Ae,[e("button",{class:"btn btn-outline-secondary me-2",onClick:R,disabled:u.value===0},"이전",8,Se),e("span",Ue,"Page "+i(u.value+1)+" / "+i(b.value),1),e("button",{class:"btn btn-outline-secondary ms-2",onClick:N,disabled:u.value+1>=b.value},"다음",8,ze)])):h("",!0)]),e("div",{class:"modal fade",tabindex:"-1",ref_key:"questionModal",ref:z},[e("div",Be,[e("div",Le,[e("div",je,[e("h5",Ke,i(n.value?.question),1),e("button",{type:"button",class:"btn-close",onClick:K})]),e("div",De,[e("div",{innerHTML:n.value?.body,class:"mb-4"},null,8,Oe),t[6]||(t[6]=e("hr",null,null,-1)),t[7]||(t[7]=e("h6",{class:"fw-bold mb-2"},"내 답변",-1)),P(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=a=>f.value=a),class:"form-control mb-3",rows:"4",placeholder:"여기에 답변을 작성해 보세요…"},null,512),[[Q,f.value]]),e("button",{class:"btn btn-success",onClick:E,disabled:g.value},[g.value?(c(),r("span",He)):(c(),r("span",Qe,"저장"))],8,qe),t[8]||(t[8]=e("hr",{class:"my-4"},null,-1)),t[9]||(t[9]=e("h6",{class:"fw-bold mb-2"},"모범 답안 / 해설",-1)),n.value?.bestUsername?(c(),r("p",Ve,[t[5]||(t[5]=e("i",{class:"fas fa-user me-1"},null,-1)),T(i(n.value.bestUsername)+"님의 답변 ",1)])):h("",!0),e("div",{innerHTML:n.value?.answerKey},null,8,Ee)]),e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary",onClick:K},"닫기")])])])],512)]))}},Ne=le(Ge,[["__scopeId","data-v-bd2cb6dc"]]),jt=Object.freeze(Object.defineProperty({__proto__:null,default:Ne},Symbol.toStringTag,{value:"Module"})),Re={class:"container py-4"},Fe={class:"mb-4"},Xe={class:"d-flex justify-content-between align-items-center mb-2"},Je={class:"list-group"},We=["onClick"],Ye={class:"me-3"},Ze={class:"fw-bold mb-1 text-truncate"},et={class:"text-muted"},tt={class:"row g-3 mb-4"},st={class:"col-md-8"},at={class:"input-group"},nt={class:"col-md-4"},lt={class:"d-flex flex-wrap gap-2"},ot=["onClick"],it={class:"row"},rt={class:"col-lg-8"},ct={key:0,class:"text-center py-5 text-muted"},ut={key:1},dt=["onClick"],vt={class:"card-body"},mt={class:"card-title mb-2 text-truncate-2"},bt={class:"card-text small text-muted mb-1"},ft={class:"d-flex justify-content-between text-muted small"},yt={key:0,class:"d-flex justify-content-center my-4"},gt=["disabled"],pt={class:"align-self-center"},_t=["disabled"],ht={class:"modal-dialog modal-lg modal-dialog-scrollable"},wt={class:"modal-content"},kt={class:"modal-header"},xt={class:"modal-title"},$t={class:"modal-body"},Ct=["innerHTML"],It=["disabled"],Tt={key:0},Pt={key:1,class:"spinner-border spinner-border-sm"},Mt={key:0,class:"text-muted small mb-1"},At=["innerHTML"],St={__name:"PriInterviewPanel",setup(oe){const k=J({series:["사기업"]}),v=o(""),y=o(!1),m=o([]),S=o([]);o([]);const b=o(0),U=o(0),u=o(0),H=o(10),n=o(null),f=o(""),g=o(!1),z=o(null),B=localStorage.getItem("token"),p=o(!0);let x=null;function $(){p.value=!p.value}async function w(){u.value=0;const l=v.value.trim(),{data:s}=await d.get(`/api/search/interview/${encodeURIComponent(l)}`);m.value=s.searchResult||[],b.value=1,U.value=m.value.length;try{await d.post("/api/interview/log",{eventType:"search",targetId:null,query:l,category:"일반",subCategory:"사기업"},{headers:{Authorization:B?`Bearer ${B}`:void 0}})}catch(t){console.warn("검색 로그 저장 실패:",t)}}async function V(){if(!f.value||f.value.trim()===""){alert("답변을 입력해주세요.");return}g.value=!0;try{const l=localStorage.getItem("token");if(!l){alert("로그인이 필요합니다.");return}const s={questionId:n.value?.id,title:n.value?.question,answer:f.value},t=await d.post("/api/save/interview/question",s,{headers:{Authorization:`Bearer ${l}`}});t.data.success?(alert(t.data.message||"답변이 저장되었습니다."),j(),f.value=""):alert("답변 저장에 실패했습니다.")}catch(l){console.error(l),alert("서버 오류가 발생했습니다.")}finally{g.value=!1}}async function E(){if(n.value?.id)try{const s=(await d.get("/api/interview/best/answer",{headers:{"X-Question-Ids":n.value.id}})).data;if(Array.isArray(s)&&s.length>0){const t=s[0];n.value.answerKey=t.answer,n.value.bestUsername=t.username||"익명"}else n.value.answerKey='<p class="text-muted">베스트 답변이 아직 없습니다.</p>',n.value.bestUsername=null}catch(l){console.warn("베스트 답변 불러오기 실패:",l),n.value.answerKey='<p class="text-muted">불러오는 중 오류가 발생했습니다.</p>',n.value.bestUsername=null}}async function C(){const l=k.series[0]||"인성",{data:s}=await d.get(`/api/interview/일반/${l}`,{params:{page:u.value,size:H.value}});m.value=s.interview||[],b.value=s.totalPages,U.value=s.totalElements}async function _(){y.value=!0;try{v.value&&v.value.trim()!==""?await w():await C()}finally{y.value=!1}}function L(l){k.series=[l],v.value="",u.value=0,_()}function G(){u.value<b.value-1&&(u.value++,C())}function N(){u.value>0&&(u.value--,C())}async function R(){const l=k.series[0]||"인성";try{const{data:s}=await d.get(`/api/interview/aggregation/${l}`);S.value=s.aggregation||[]}catch(s){console.warn("TOP5 조회 실패:",s)}}async function F(l){const s=localStorage.getItem("token")||null,t={eventType:"click",userId:null,username:null,targetId:l.id,query:null,category:l.category||"사기업",subCategory:l.subCategory||null};try{await d.post("/api/interview/log",t,{headers:s?{Authorization:`Bearer ${s}`}:{}})}catch(a){console.warn("로그 저장 실패:",a.message)}}function X(l){D(l),E(),F(l)}function D(l){n.value=l,O()}function O(){x||(x=new ne(z.value)),x.show()}function j(){x.hide(),n.value=null}const K=l=>new Date(l).toLocaleDateString();return W(()=>{R(),C()}),(l,s)=>(c(),r("div",Re,[s[10]||(s[10]=e("header",{class:"d-flex align-items-center gap-3 mb-4"},[e("i",{class:"fas fa-building fs-2 text-success"}),e("h1",{class:"h3 fw-bold mb-0"},"사기업 면접 질문 뱅크")],-1)),e("section",Fe,[e("div",Xe,[s[2]||(s[2]=e("h6",{class:"fw-semibold mb-0"},[e("i",{class:"fas fa-fire me-2 text-danger"}),T("이번 주 인기 TOP 5 ")],-1)),e("button",{class:"btn btn-sm btn-outline-secondary",onClick:Z($,["stop"]),style:{"z-index":"1",position:"relative"}},[e("i",{class:q(p.value?"fas fa-chevron-up":"fas fa-chevron-down")},null,2)])]),Y(te,{name:"fade"},{default:ee(()=>[P(e("ul",Je,[(c(!0),r(M,null,A(S.value,(t,a)=>(c(),r("li",{key:t.id,class:"list-group-item list-group-item-action d-flex justify-content-between align-items-start py-3 px-3 hover-shadow-sm cursor-pointer",onClick:I=>D(t)},[e("div",Ye,[e("div",Ze,i(a+1)+". "+i(t.question),1),e("small",et,"카테고리: "+i(t.category)+" / "+i(t.subCategory),1)])],8,We))),128))],512),[[ae,p.value]])]),_:1})]),e("div",tt,[e("div",st,[e("div",at,[P(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>v.value=t),onKeyup:se(_,["enter"]),type:"search",class:"form-control",placeholder:"키워드·질문 입력 후 Enter"},null,544),[[Q,v.value]]),e("button",{class:"btn btn-primary",onClick:_},"검색")])]),e("div",nt,[e("div",lt,[(c(!0),r(M,null,A(l.seriesList,t=>(c(),r("span",{key:t,onClick:a=>L(t),class:q(["badge rounded-pill py-2 px-3 cursor-pointer",k.series.includes(t)?"bg-primary text-white":"bg-light text-dark"])},i(t),11,ot))),128))])])]),e("div",it,[e("main",rt,[y.value?(c(),r("div",ct,s[3]||(s[3]=[e("div",{class:"spinner-border",role:"status"},null,-1)]))):h("",!0),!y.value&&m.value&&m.value.length>0?(c(),r("div",ut,[(c(!0),r(M,null,A(m.value,t=>(c(),r("div",{key:t.id,class:"card mb-3 shadow-sm hover-shadow cursor-pointer",onClick:a=>X(t)},[e("div",vt,[e("h5",mt,i(t.question),1),e("p",bt,"카테고리: "+i(t.category)+" / "+i(t.subCategory),1),e("div",ft,[e("span",null,[s[4]||(s[4]=e("i",{class:"fas fa-clock me-1"},null,-1)),T(i(K(t.createdAt)),1)])])])],8,dt))),128))])):h("",!0)]),b.value>1?(c(),r("div",yt,[e("button",{class:"btn btn-outline-secondary me-2",onClick:N,disabled:u.value===0},"이전",8,gt),e("span",pt,"Page "+i(u.value+1)+" / "+i(b.value),1),e("button",{class:"btn btn-outline-secondary ms-2",onClick:G,disabled:u.value+1>=b.value},"다음",8,_t)])):h("",!0)]),e("div",{class:"modal fade",tabindex:"-1",ref_key:"questionModal",ref:z},[e("div",ht,[e("div",wt,[e("div",kt,[e("h5",xt,i(n.value?.question),1),e("button",{type:"button",class:"btn-close",onClick:j})]),e("div",$t,[e("div",{innerHTML:n.value?.body,class:"mb-4"},null,8,Ct),s[6]||(s[6]=e("hr",null,null,-1)),s[7]||(s[7]=e("h6",{class:"fw-bold mb-2"},"내 답변",-1)),P(e("textarea",{"onUpdate:modelValue":s[1]||(s[1]=t=>f.value=t),class:"form-control mb-3",rows:"4",placeholder:"여기에 답변을 작성해 보세요…"},null,512),[[Q,f.value]]),e("button",{class:"btn btn-success",onClick:V,disabled:g.value},[g.value?(c(),r("span",Pt)):(c(),r("span",Tt,"저장"))],8,It),s[8]||(s[8]=e("hr",{class:"my-4"},null,-1)),s[9]||(s[9]=e("h6",{class:"fw-bold mb-2"},"모범 답안 / 해설",-1)),n.value?.bestUsername?(c(),r("p",Mt,[s[5]||(s[5]=e("i",{class:"fas fa-user me-1"},null,-1)),T(i(n.value.bestUsername)+"님의 답변 ",1)])):h("",!0),e("div",{innerHTML:n.value?.answerKey},null,8,At)]),e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary",onClick:j},"닫기")])])])],512)]))}},Ut=le(St,[["__scopeId","data-v-80b332fd"]]),Kt=Object.freeze(Object.defineProperty({__proto__:null,default:Ut},Symbol.toStringTag,{value:"Module"}));export{jt as G,Kt as P};
