import{a as F,d as V,r as g,u as _,o as K,c as y,b as e,w as q,e as I,t as C,f as b,v as k,g as B,h as E,i as h,j as G,n as Z,k as H,l as M,m as L}from"./vendor-DMmp5gzX.js";const x=F.create({baseURL:"/api",withCredentials:!0});x.interceptors.request.use(c=>{const o=localStorage.getItem("token");return o&&(c.headers.Authorization=`Bearer ${o}`),c});x.interceptors.response.use(c=>c,c=>(c.response?.status===401&&useUserStore().logout(),Promise.reject(c)));const R=V("user",{state:()=>({isLoggedIn:!!localStorage.getItem("token"),username:localStorage.getItem("username")||"",notifications:JSON.parse(localStorage.getItem("notifications")||"[]"),_inFlight:null,loading:!1}),actions:{async fetchMe(){return localStorage.getItem("token")?this._inFlight?this._inFlight:(this.loading=!0,this._inFlight=(async()=>{try{const{data:o}=await x.get("/info");this.isLoggedIn=!!o?.isLoggedIn,this.username=o?.username||""}catch{this.$reset()}finally{this.loading=!1,this._inFlight=null}})(),this._inFlight):this.$reset()},setAuth(c,o){localStorage.setItem("token",c),localStorage.setItem("username",o),this.isLoggedIn=!0,this.username=o},logout(){localStorage.removeItem("token"),localStorage.removeItem("username"),this.$reset()},addNotification(c){const{postId:o=null,message:a}=c,l={id:Date.now(),postId:o,message:a,read:!1};return this.notifications=[l,...this.notifications],localStorage.setItem("notifications",JSON.stringify(this.notifications)),l},markAllRead(){this.notifications.forEach(c=>c.read=!0),localStorage.setItem("notifications",JSON.stringify(this.notifications))},$reset(){this.isLoggedIn=!1,this.username="",this.notifications=[],this.loading=!1}}}),S=g([]),P=new Map,Q=(c,o,a)=>{if(!Number.isFinite(o)||o<=0)return;const l=P.get(c);l&&clearTimeout(l);const u=setTimeout(()=>a(c),o);P.set(c,u)};function X(){const c=_(),o=l=>{const u=P.get(l);u&&(clearTimeout(u),P.delete(l));const p=S.value.findIndex(i=>i.id===l);p!==-1&&S.value.splice(p,1)};return{push:(l,u=null,p={})=>{const i=typeof l=="string"?{type:"text",msg:l,routePath:u,...p}:{...l},s=String(i.id??i.stableKey??Date.now()+Math.random()),d=Number.isFinite(i.duration)?i.duration:5e3;i.routePath&&!i.onClick&&(i.onClick=()=>c.push(i.routePath));const n={id:s,...i};n._close=()=>o(s);const t=S.value.findIndex(r=>r.id===s);return t>=0?S.value[t]={...S.value[t],...n}:S.value.unshift(n),Q(s,d,o),s},remove:o,toasts:S}}let v=null,A=!1,$=null;const U=new Map,Y=15e3;function N(c){if(!c)return!1;const o=Date.now();for(const[l,u]of U)u<o&&U.delete(l);const a=U.get(c);return a&&a>o?!0:(U.set(c,o+Y),!1)}function O(c,o,a){if(o?.id)return String(o.id);if(a)return String(a);if(c==="point"){const l=o.pointTxId||o.txId||o.eventId||o.userId||"anon",u=o.amount??o.points??"0",p=o.createdAt||o.time||"";return`point:${l}:${u}:${p}`}return o?.postId?`${o.type||"notif"}:${o.postId}`:`ev:${c}:${Date.now()}`}function oe(c){if(!c){console.warn("[SSE] í† í° ì—†ìŒ: ì—°ê²°í•˜ì§€ ì•ŠìŒ");return}const o=_(),{push:a}=X(),l=R(),u=t=>{let r;try{r=JSON.parse(t.data)}catch{return}const m=Array.isArray(r.analysis)?r.analysis:[],f=O("analysis",r,t.lastEventId);N(f)||a({id:f,type:"analysis",title:r.message||"ì˜¤ëŠ˜ì˜ í•˜ë£¨ ë¶„ì„ ê²°ê³¼",analysis:m,duration:1e6,isCenter:!0,onClick:()=>o.push("/analysis-detail")})},p=t=>{let r;try{r=JSON.parse(t.data)}catch{return}const m=O("rank-top1",r,t.lastEventId);if(N(m))return;const f=`ğŸ‘‘ ${r.message||"ë­í‚¹ 1ìœ„ ê²Œì‹œê¸€"}`;r.postId?a({id:m,msg:f,routePath:`/post/${r.postId}`,duration:5e3}):a({id:m,msg:f,routePath:"/trending/top3",duration:5e3})},i=t=>{let r;try{r=JSON.parse(t.data)}catch{return}const m=Array.isArray(r.posts)?r.posts.slice(0,3):[];if(!m.length)return;const f=r.id||`top3:${m.map(w=>w.postId).join(",")}`;N(f)||a({id:f,type:"top3",title:"ì˜¤ëŠ˜ì˜ ë² ìŠ¤íŠ¸ Top 3",message:r.message||"ì—…ë°ì´íŠ¸ ë˜ì—ˆìŠµë‹ˆë‹¤!",posts:m,duration:1e5,onClick:()=>o.push("/trending/top3"),onItemClick:w=>o.push(`/post/${w.postId}`)})},s=t=>{let r;try{r=JSON.parse(t.data)}catch{return}const m=Array.isArray(r.posts)?r.posts.slice(0,5):[];if(!m.length)return;const f=r.id||`poll-missing:${r.count}:${m.map(w=>w.postId).join(",")}`;N(f)||a({id:f,type:"poll-missing",title:"ì•„ì§ ì•ˆ í•œ íˆ¬í‘œê°€ ìˆì–´ìš”",message:r.message||`ì•„ì§ ì°¸ì—¬í•˜ì§€ ì•Šì€ íˆ¬í‘œê°€ ${r.count??m.length}ê°œ ìˆìŠµë‹ˆë‹¤.`,posts:m,duration:1e5,label:"ë³´ëŸ¬ê°€ê¸°",onClick:()=>o.push("/poll"),onItemClick:w=>o.push(`/post/${w.postId}`)})},d=(t,r,m)=>{let f;try{f=JSON.parse(t.data)}catch(W){return console.error("[SSE] ì•Œë¦¼ JSON íŒŒì‹± ì‹¤íŒ¨:",t.data,W)}const w=m==="point"?"point":f.type||m||"generic",z=`${O(w,f,t.lastEventId)}_${Date.now()}`,j=l.addNotification?.(f)??f,D=`${r} ${j.message??"ìƒˆ ì•Œë¦¼ì´ ë„ì°©í–ˆìŠµë‹ˆë‹¤"}`,J={id:z,msg:D,duration:1e5};j.postId?a({...J,routePath:`/post/${j.postId}`}):a({...J,routePath:"/notifications"})},n=()=>{v||(v=new EventSource(`/api/subscribe?token=${encodeURIComponent(c)}`),v.onopen=()=>{console.log("[SSE] ì—°ê²° ì„±ê³µ"),$&&(clearTimeout($),$=null)},v.onerror=t=>{console.warn("[SSE] ì˜¤ë¥˜/ëŠê¹€ â†’ 20ì´ˆ í›„ ì¬ì—°ê²°",t);try{v.close()}catch{}v=null,$||($=setTimeout(()=>{$=null,n()},2e4))},A||(v.addEventListener("comment-notification",t=>d(t,"ğŸ’¬","comment")),v.addEventListener("todo-notification",t=>d(t,"ğŸ“","todo")),v.addEventListener("reply-notification",t=>d(t,"â†©ï¸","reply")),v.addEventListener("notice-notification",t=>d(t,"ğŸ“¢","notice")),v.addEventListener("point-notification",t=>d(t,"ğŸ’°","point")),v.addEventListener("like-notification",t=>d(t,"ğŸ’—","like")),v.addEventListener("analysis-notification",u),v.addEventListener("rank-top1-notification",p),v.addEventListener("rank-top3-notification",i),v.addEventListener("poll-notification",s),A=!0))};n(),K(()=>{})}const T=(c,o)=>{const a=c.__vccOpts||c;for(const[l,u]of o)a[l]=u;return a},tt="/kakao.png",et="/naver.png",ot="/google.png",st={class:"login-wrapper"},nt={class:"login-card"},at={key:0,class:"error-message text-danger mb-3"},rt={class:"mb-3"},it={class:"mb-3"},lt={class:"form-check text-start mb-3"},ct={class:"d-flex flex-column gap-2 mt-4"},dt={class:"d-flex gap-2 mt-3"},ut={__name:"Login",setup(c){const o=g(!1),a=_(),l=g(""),u=g(""),p=g("");function i(){if(!l.value||!u.value){p.value="ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.";return}F.post("/api/authlogin",{userId:l.value,password:u.value,autoLogin:o.value}).then(n=>{n.data.accessToken?(localStorage.setItem("token",n.data.accessToken),window.location.href="/"):p.value="ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤."}).catch(()=>{p.value="ë¡œê·¸ì¸ ì‹¤íŒ¨! ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”."})}function s(n){window.location.href=n}function d(n){a.push(n)}return(n,t)=>(h(),y("div",st,[e("div",nt,[t[13]||(t[13]=e("h2",{class:"brand-title"},"Workly",-1)),t[14]||(t[14]=e("p",{class:"text-muted"},"ë¡œê·¸ì¸í•˜ì—¬ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•˜ì„¸ìš”.",-1)),e("form",{onSubmit:q(i,["prevent"])},[p.value?(h(),y("div",at,C(p.value),1)):I("",!0),e("div",rt,[b(e("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>l.value=r),type:"text",class:"form-control",placeholder:"ì•„ì´ë”” ì…ë ¥",required:""},null,512),[[k,l.value]])]),e("div",it,[b(e("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>u.value=r),type:"password",class:"form-control",placeholder:"ë¹„ë°€ë²ˆí˜¸ ì…ë ¥",required:""},null,512),[[k,u.value]])]),e("div",lt,[b(e("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>o.value=r),class:"form-check-input",type:"checkbox",id:"autoLoginCheck"},null,512),[[B,o.value]]),t[8]||(t[8]=e("label",{class:"form-check-label",for:"autoLoginCheck"}," ìë™ ë¡œê·¸ì¸ ",-1))]),t[12]||(t[12]=e("button",{type:"submit",class:"btn btn-primary w-100"},"ë¡œê·¸ì¸",-1)),e("div",ct,[e("button",{type:"button",class:"btn btn-warning w-100",onClick:t[3]||(t[3]=r=>s("/api/kakao"))},t[9]||(t[9]=[e("img",{src:tt,alt:"ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸",style:{height:"24px","margin-right":"8px"}},null,-1),E(" ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ")])),e("button",{type:"button",class:"btn w-100 d-flex align-items-center justify-content-center",onClick:t[4]||(t[4]=r=>s("/api/naver")),style:{"background-color":"#05bf18",color:"#fff","font-weight":"bold"}},t[10]||(t[10]=[e("img",{src:et,alt:"ë„¤ì´ë²„ ë¡œê·¸ì¸",style:{height:"24px","margin-right":"8px"}},null,-1),E(" ë„¤ì´ë²„ ë¡œê·¸ì¸ ")])),e("button",{type:"button",class:"btn w-100 d-flex align-items-center justify-content-center",onClick:t[5]||(t[5]=r=>s("/api/google")),style:{"background-color":"#fff",color:"#5f6368","font-weight":"500",border:"1px solid #dadce0"}},t[11]||(t[11]=[e("img",{src:ot,alt:"êµ¬ê¸€ ë¡œê·¸ì¸",style:{height:"20px","margin-right":"12px"}},null,-1),e("span",null,"Googleë¡œ ë¡œê·¸ì¸",-1)]))]),e("div",dt,[e("button",{type:"button",class:"btn btn-outline-secondary w-50",onClick:t[6]||(t[6]=r=>d("/signup"))},"íšŒì›ê°€ì…"),e("button",{type:"button",class:"btn btn-secondary w-50",onClick:t[7]||(t[7]=r=>d("/"))},"í™ˆìœ¼ë¡œ")])],32)])]))}},pt=T(ut,[["__scopeId","data-v-50ee95f1"]]),se=Object.freeze(Object.defineProperty({__proto__:null,default:pt},Symbol.toStringTag,{value:"Module"})),mt={class:"d-flex vh-100 justify-content-center align-items-center"},ft={class:"signup-card w-100"},gt={key:0,class:"alert alert-danger text-center"},vt={class:"mb-3"},bt={class:"input-group"},yt={class:"mb-3"},ht={class:"mb-3"},wt={class:"mb-3"},kt={class:"mb-3"},St={key:0,class:"text-danger"},_t={class:"d-flex gap-2 mt-3"},$t={__name:"SignUp",setup(c){const o=_(),a=G({userId:"",username:"",age:"",password:"",confirmPassword:""}),l=g(""),u=g(!1),p=g("");async function i(){if(!a.userId)return;const{data:d}=await x.post("/check",{userId:a.userId});u.value=d,l.value=d?"ì‚¬ìš© ê°€ëŠ¥í•œ ì•„ì´ë””ì…ë‹ˆë‹¤.":"ì•„ì´ë””ê°€ ì¤‘ë³µë©ë‹ˆë‹¤."}async function s(){if(!u.value)return p.value="ì•„ì´ë”” ì¤‘ë³µ í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.";if(a.password!==a.confirmPassword)return p.value="ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.";const{confirmPassword:d,...n}=a;try{await x.post("/signup/pass",n),alert("íšŒì›ê°€ì… ì„±ê³µ!"),o.push("/login")}catch{p.value="íšŒì›ê°€ì… ì‹¤íŒ¨. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”."}}return(d,n)=>(h(),y("section",mt,[e("div",ft,[n[14]||(n[14]=e("h2",{class:"brand-title"},"Workly",-1)),n[15]||(n[15]=e("p",{class:"text-muted mb-4"},"íšŒì›ê°€ì…í•˜ê³  ë‹¤ì–‘í•œ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•˜ì„¸ìš”.",-1)),e("form",{onSubmit:q(s,["prevent"])},[p.value?(h(),y("div",gt,C(p.value),1)):I("",!0),e("div",vt,[n[7]||(n[7]=e("label",{for:"userId",class:"form-label"},"ì•„ì´ë””",-1)),e("div",bt,[b(e("input",{"onUpdate:modelValue":n[0]||(n[0]=t=>a.userId=t),type:"text",id:"userId",class:"form-control",placeholder:"ì•„ì´ë”” ì…ë ¥",pattern:"^[a-zA-Z0-9]+$",title:"íŠ¹ìˆ˜ë¬¸ìë¥¼ ì œì™¸í•´ì£¼ì„¸ìš”",required:""},null,512),[[k,a.userId]]),e("button",{type:"button",class:"btn btn-outline-secondary",onClick:i},"ì¤‘ë³µí™•ì¸")]),e("small",{id:"checkResult",class:Z(["form-text",{"text-success":u.value,"text-danger":!u.value}])},C(l.value),3)]),e("div",yt,[n[8]||(n[8]=e("label",{for:"username",class:"form-label"},"ì´ë¦„",-1)),b(e("input",{"onUpdate:modelValue":n[1]||(n[1]=t=>a.username=t),type:"text",id:"username",class:"form-control",placeholder:"ì´ë¦„ ì…ë ¥",pattern:"^[a-zA-Zê°€-í£0-9]+$",title:"íŠ¹ìˆ˜ë¬¸ìë¥¼ ì œì™¸í•´ì£¼ì„¸ìš”",required:""},null,512),[[k,a.username]])]),e("div",ht,[n[10]||(n[10]=e("label",{for:"age",class:"form-label"},"ë‚˜ì´",-1)),b(e("select",{"onUpdate:modelValue":n[2]||(n[2]=t=>a.age=t),id:"age",class:"form-control",required:""},n[9]||(n[9]=[e("option",{disabled:"",value:""},"ë‚˜ì´ëŒ€ ì„ íƒ",-1),e("option",null,"10ëŒ€",-1),e("option",null,"20ëŒ€",-1),e("option",null,"30ëŒ€",-1),e("option",null,"40ëŒ€",-1),e("option",null,"50ëŒ€",-1),e("option",null,"60ëŒ€",-1),e("option",null,"70ëŒ€",-1)]),512),[[H,a.age]])]),e("div",wt,[n[11]||(n[11]=e("label",{for:"password",class:"form-label"},"ë¹„ë°€ë²ˆí˜¸",-1)),b(e("input",{"onUpdate:modelValue":n[3]||(n[3]=t=>a.password=t),type:"password",id:"password",class:"form-control",placeholder:"ë¹„ë°€ë²ˆí˜¸ ì…ë ¥",pattern:"^(?=.*[a-zA-Z])(?=.*\\d).{8,}$",title:"ë¹„ë°€ë²ˆí˜¸ëŠ” ì˜ë¬¸, ìˆ«ìë¥¼ í¬í•¨í•´ 8ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.",required:""},null,512),[[k,a.password]])]),e("div",kt,[n[12]||(n[12]=e("label",{for:"confirmPassword",class:"form-label"},"ë¹„ë°€ë²ˆí˜¸ í™•ì¸",-1)),b(e("input",{"onUpdate:modelValue":n[4]||(n[4]=t=>a.confirmPassword=t),type:"password",id:"confirmPassword",class:"form-control",placeholder:"ë¹„ë°€ë²ˆí˜¸ í™•ì¸",required:""},null,512),[[k,a.confirmPassword]]),a.confirmPassword&&a.confirmPassword!==a.password?(h(),y("small",St," ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ")):I("",!0)]),n[13]||(n[13]=e("button",{type:"submit",class:"btn btn-primary w-100"},"íšŒì›ê°€ì…",-1)),e("div",_t,[e("button",{type:"button",class:"btn btn-outline-secondary w-50",onClick:n[5]||(n[5]=t=>M(o).push("/login"))},"ë¡œê·¸ì¸"),e("button",{type:"button",class:"btn btn-secondary w-50",onClick:n[6]||(n[6]=t=>M(o).push("/"))},"í™ˆìœ¼ë¡œ")])],32)])]))}},It=T($t,[["__scopeId","data-v-76ee2698"]]),ne=Object.freeze(Object.defineProperty({__proto__:null,default:It},Symbol.toStringTag,{value:"Module"})),xt={class:"container"},Tt={class:"row justify-content-center mt-5"},Ut={class:"col-md-6"},Nt={class:"card shadow-sm"},Pt={class:"card-body text-center"},jt={key:0},Ot={class:"input-group mb-3"},Ct={__name:"Google",setup(c){_();const o=g(!1),a=g(""),l=g(null),u=async i=>{try{const d=await(await fetch("/api/oauth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:i.providerId,username:i.username,email:i.email,password:i.password})})).json();localStorage.setItem("token",d.accessToken),window.location.href="/"}catch(s){console.error("JWT ë°œê¸‰ ì‹¤íŒ¨:",s)}},p=async()=>{const i={username:a.value,provider:l.value.provider,providerId:l.value.providerId,email:l.value.email};(await(await fetch("/api/oauth/username",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json()).result==="ok"&&u(i)};return L(async()=>{const s=new URLSearchParams(window.location.search).get("code");if(s)try{const n=await(await fetch(`/api/google/callback/json?code=${s}`)).text();let t;try{t=JSON.parse(n)}catch(r){console.error("JSON íŒŒì‹± ì‹¤íŒ¨:",r);return}l.value=t,console.log("êµ¬ê¸€ ì‘ë‹µ:",t),t.result==="ok"?u(t):t.result==="newUser"&&(o.value=!0)}catch(d){console.error("êµ¬ê¸€ Fetch ì—ëŸ¬:",d)}}),(i,s)=>(h(),y("div",xt,[e("div",Tt,[e("div",Ut,[e("div",Nt,[e("div",Pt,[s[3]||(s[3]=e("h2",{class:"card-title mb-4"},"êµ¬ê¸€ ë¡œê·¸ì¸ ì²˜ë¦¬ ì¤‘...",-1)),o.value?(h(),y("div",jt,[s[2]||(s[2]=e("p",{class:"mb-3"},"ì‚¬ìš©í•  ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”",-1)),e("div",Ot,[s[1]||(s[1]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-person"})],-1)),b(e("input",{"onUpdate:modelValue":s[0]||(s[0]=d=>a.value=d),type:"text",class:"form-control",placeholder:"ì•„ì´ë”” ì…ë ¥",required:""},null,512),[[k,a.value]])]),e("button",{onClick:p,class:"btn btn-danger w-100"},"í™•ì¸")])):I("",!0)])])])])]))}},Lt=T(Ct,[["__scopeId","data-v-e6ab86ba"]]),ae=Object.freeze(Object.defineProperty({__proto__:null,default:Lt},Symbol.toStringTag,{value:"Module"})),Jt=V("notification",{state:()=>({notifications:[]}),actions:{async fetchNotifications(){const{data:c}=await x.get("/notifications/recent");this.notifications=c}}}),Et={class:"container"},Mt={class:"row justify-content-center mt-5"},At={class:"col-md-6"},Ft={class:"card shadow-sm"},Vt={class:"card-body text-center"},qt={key:0},Rt={class:"input-group mb-3"},zt={__name:"Kakao",setup(c){R(),Jt(),_();const o=g(!1),a=g(""),l=g(null),u=async i=>{try{const d=await(await fetch("/api/oauth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:i.providerId,username:i.username,email:i.email,password:i.password})})).json();localStorage.setItem("token",d.accessToken),window.location.href="/"}catch(s){console.error("JWT ë°œê¸‰ ì‹¤íŒ¨:",s)}},p=async()=>{const i={username:a.value,provider:l.value.provider,providerId:l.value.providerId,email:l.value.email};(await(await fetch("/api/oauth/username",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json()).result==="ok"&&u(i)};return L(async()=>{const s=new URLSearchParams(window.location.search).get("code");if(s)try{const n=await(await fetch(`/api/kakao/callback/json?code=${s}`)).text();let t;try{t=JSON.parse(n)}catch(r){console.error("JSON íŒŒì‹± ì‹¤íŒ¨:",r);return}l.value=t,t.result==="ok"?u(t):t.result==="newUser"&&(o.value=!0)}catch(d){console.error("Fetch ì—ëŸ¬:",d)}}),(i,s)=>(h(),y("div",Et,[e("div",Mt,[e("div",At,[e("div",Ft,[e("div",Vt,[s[3]||(s[3]=e("h2",{class:"card-title mb-4"},"ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì²˜ë¦¬ ì¤‘...",-1)),o.value?(h(),y("div",qt,[s[2]||(s[2]=e("p",{class:"mb-3"},"ì‚¬ìš©í•  ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”",-1)),e("div",Rt,[s[1]||(s[1]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-person"})],-1)),b(e("input",{"onUpdate:modelValue":s[0]||(s[0]=d=>a.value=d),type:"text",class:"form-control",placeholder:"ì•„ì´ë”” ì…ë ¥",required:""},null,512),[[k,a.value]])]),e("button",{onClick:p,class:"btn btn-primary w-100"},"í™•ì¸")])):I("",!0)])])])])]))}},Dt=T(zt,[["__scopeId","data-v-ff3824e6"]]),re=Object.freeze(Object.defineProperty({__proto__:null,default:Dt},Symbol.toStringTag,{value:"Module"})),Wt={class:"container"},Kt={class:"row justify-content-center mt-5"},Bt={class:"col-md-6"},Gt={class:"card shadow-sm"},Zt={class:"card-body text-center"},Ht={key:0},Qt={class:"input-group mb-3"},Xt={__name:"Naver",setup(c){_();const o=g(!1),a=g(""),l=g(null),u=async i=>{try{const d=await(await fetch("/api/oauth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:i.providerId,username:i.username,email:i.email,password:i.password})})).json();localStorage.setItem("token",d.accessToken),window.location.href="/"}catch(s){console.error("JWT ë°œê¸‰ ì‹¤íŒ¨:",s)}},p=async()=>{const i={username:a.value,provider:l.value.provider,providerId:l.value.providerId,email:l.value.email};(await(await fetch("/api/oauth/username",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json()).result==="ok"&&u(i)};return L(async()=>{const i=new URLSearchParams(window.location.search),s=i.get("code"),d=i.get("state");if(s&&d)try{const t=await(await fetch(`/api/naver/callback/json?code=${s}&state=${d}`)).text();let r;try{r=JSON.parse(t)}catch(m){console.error("JSON íŒŒì‹± ì‹¤íŒ¨:",m);return}l.value=r,console.log("ë„¤ì´ë²„ ì‘ë‹µ:",r),r.result==="ok"?u(r):r.result==="newUser"&&(o.value=!0)}catch(n){console.error("ë„¤ì´ë²„ Fetch ì—ëŸ¬:",n)}}),(i,s)=>(h(),y("div",Wt,[e("div",Kt,[e("div",Bt,[e("div",Gt,[e("div",Zt,[s[3]||(s[3]=e("h2",{class:"card-title mb-4"},"ë„¤ì´ë²„ ë¡œê·¸ì¸ ì²˜ë¦¬ ì¤‘...",-1)),o.value?(h(),y("div",Ht,[s[2]||(s[2]=e("p",{class:"mb-3"},"ì‚¬ìš©í•  ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”",-1)),e("div",Qt,[s[1]||(s[1]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-person"})],-1)),b(e("input",{"onUpdate:modelValue":s[0]||(s[0]=d=>a.value=d),type:"text",class:"form-control",placeholder:"ì•„ì´ë”” ì…ë ¥",required:""},null,512),[[k,a.value]])]),e("button",{onClick:p,class:"btn btn-success w-100"},"í™•ì¸")])):I("",!0)])])])])]))}},Yt=T(Xt,[["__scopeId","data-v-10218991"]]),ie=Object.freeze(Object.defineProperty({__proto__:null,default:Yt},Symbol.toStringTag,{value:"Module"}));export{ae as G,re as K,se as L,ie as N,ne as S,T as _,x as a,X as b,oe as c,S as t,R as u};
