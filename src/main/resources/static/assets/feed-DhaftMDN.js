import{a as j,_ as Ct,u as ee}from"./auth-CM7Hud5Y.js";import{d as me,r as u,p as G,c as s,b as t,f as tt,t as v,w as Nt,v as $t,K as ge,u as jt,i as e,e as P,n as lt,F as Y,q as dt,m as Dt,L as Qt,M as oe,B as ae,N as le,O as he,h as H,l as kt,o as ve,x as rt,y as Mt,R as Bt,z as Yt,T as ye,P as te,s as ke,A as Rt,a as _e,g as ne,k as $e,j as we}from"./vendor-DMmp5gzX.js";const ie=me("sidebar",{state:()=>({dDayList:[],todoList:[],remaining:0,visitorStats:{active:0,today:0,total:0},topWriters:[],topRecentWriters:[],_staticLoaded:!1,_staticInFlight:null,_liveLoaded:!1,_liveInFlight:null}),getters:{todoProgress(g){const A=g.todoList.length-g.remaining;return g.todoList.length?Math.round(A/g.todoList.length*100):0}},actions:{async loadStatic(){if(!this._staticLoaded)return this._staticInFlight?this._staticInFlight:(this._staticInFlight=(async()=>{try{const[g,A]=await Promise.all([j.get("/day"),j.get("/search/today/todo")]);this.dDayList=g.data.D_Day??[],this.todoList=A.data.todos??[],this.remaining=A.data.remainingCount??0,this._staticLoaded=!0}catch(g){console.error("[sidebar] static ë¡œë”© ì‹¤íŒ¨",g)}finally{this._staticInFlight=null}})(),this._staticInFlight)},async loadLive(){if(!this._liveLoaded)return this._liveInFlight?this._liveInFlight:(this._liveLoaded=!0,this._liveInFlight=(async()=>{try{const[g,A,a]=await Promise.all([j.get("/get-ip"),j.get("/points/summary"),j.get("/points/recent")]);this.visitorStats={active:g.data.activeUsers,today:g.data.today},this.topWriters=A.data.top5??[],this.topRecentWriters=a.data.recent??[]}catch(g){console.error("[sidebar] live ë¡œë”© ì‹¤íŒ¨",g),this._liveLoaded=!1}finally{this._liveInFlight=null}})(),this._liveInFlight)}}}),xe={class:"search-bar d-flex align-items-center p-3 mb-3 rounded shadow-sm search-bg gap-2"},Ce={class:"dropdown"},Ae={class:"btn btn-outline-secondary dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Pe={class:"dropdown-menu"},Se=["placeholder"],Ie={__name:"SearchBar",setup(g){const A=u(""),a=u("post"),_=jt(),w={title:"ì œëª©",content:"ë‚´ìš©",post:"ì œëª©+ë‚´ìš©",user:"ìœ ì €"},i=G(()=>w[a.value]||"ì œëª©+ë‚´ìš©"),$=G(()=>a.value==="user"?"ë‹‰ë„¤ìž„ì„ ìž…ë ¥í•˜ì„¸ìš”":a.value==="title"?"ì œëª©ì„ ìž…ë ¥í•˜ì„¸ìš”":a.value==="content"?"ë‚´ìš© í‚¤ì›Œë“œë¥¼ ìž…ë ¥í•˜ì„¸ìš”":"ê´€ì‹¬ìžˆëŠ” ë‚´ìš©ì„ ê²€ìƒ‰í•´ë³´ì„¸ìš”!");function r(y){a.value=y}function c(){const y=A.value.trim();y&&_.push({path:"/search/view/content",query:{text:y,type:a.value,page:1}})}return(y,k)=>(e(),s("div",xe,[t("div",Ce,[t("button",Ae,v(i.value),1),t("ul",Pe,[t("li",null,[t("a",{class:"dropdown-item",href:"#",onClick:k[0]||(k[0]=Nt(T=>r("title"),["prevent"]))},"ì œëª©")]),t("li",null,[t("a",{class:"dropdown-item",href:"#",onClick:k[1]||(k[1]=Nt(T=>r("content"),["prevent"]))},"ë‚´ìš©")]),t("li",null,[t("a",{class:"dropdown-item",href:"#",onClick:k[2]||(k[2]=Nt(T=>r("post"),["prevent"]))},"ì œëª©+ë‚´ìš©")]),t("li",null,[t("a",{class:"dropdown-item",href:"#",onClick:k[3]||(k[3]=Nt(T=>r("user"),["prevent"]))},"ìœ ì €")])])]),t("i",{class:"fa-solid fa-search search-icon",onClick:c}),tt(t("input",{"onUpdate:modelValue":k[4]||(k[4]=T=>A.value=T),onKeyup:ge(c,["enter"]),type:"text",class:"form-control border-0 shadow-none flex-grow-1 search-input",placeholder:$.value},null,40,Se),[[$t,A.value]])]))}},Le=Ct(Ie,[["__scopeId","data-v-1f24bc29"]]),Te={key:0,class:"my-3"},Ee={class:"pagination justify-content-center mb-0"},Me=["onClick"],Oe={class:"page-link"},se=10,ze={__name:"Pagination",props:{page:Number,totalPages:Number},emits:["change"],setup(g,{emit:A}){const a=g,_=A,w=G(()=>Math.floor(a.page/se)*se),i=G(()=>Math.min(a.totalPages-1,w.value+se-1)),$=G(()=>Array.from({length:i.value-w.value+1},(c,y)=>w.value+y));function r(c){c!==a.page&&c>=0&&c<a.totalPages&&_("change",c)}return(c,y)=>g.totalPages>1?(e(),s("nav",Te,[t("ul",Ee,[t("li",{class:lt(["page-item",{disabled:g.page===0}]),onClick:y[0]||(y[0]=k=>r(0))},y[4]||(y[4]=[t("span",{class:"page-link"},"Â«",-1)]),2),w.value>0?(e(),s("li",{key:0,class:"page-item",onClick:y[1]||(y[1]=k=>r(w.value-1))},y[5]||(y[5]=[t("span",{class:"page-link"},"â€¹",-1)]))):P("",!0),(e(!0),s(Y,null,dt($.value,k=>(e(),s("li",{key:k,class:lt(["page-item",{active:k===g.page}]),onClick:T=>r(k)},[t("span",Oe,v(k+1),1)],10,Me))),128)),i.value<g.totalPages-1?(e(),s("li",{key:1,class:"page-item",onClick:y[2]||(y[2]=k=>r(i.value+1))},y[6]||(y[6]=[t("span",{class:"page-link"},"â€º",-1)]))):P("",!0),t("li",{class:lt(["page-item",{disabled:g.page===g.totalPages-1}]),onClick:y[3]||(y[3]=k=>r(g.totalPages-1))},y[7]||(y[7]=[t("span",{class:"page-link"},"Â»",-1)]),2)])])):P("",!0)}},Re={class:"tabs-container"},Ne={class:"tabs-inner"},De=["onClick"],je={__name:"BoardTabs",props:{modelValue:String,tabs:Array},emits:["update:modelValue"],setup(g,{emit:A}){const a=g,_=A,w=u([]),i=u({});function $(c){_("update:modelValue",c)}function r(){ae(()=>{const c=a.tabs.findIndex(O=>O.id===a.modelValue),y=w.value[c];if(!y)return;const k=y.getBoundingClientRect(),T=y.parentNode.getBoundingClientRect();i.value={width:k.width+"px",transform:`translateX(${k.left-T.left}px)`}})}return Dt(()=>r()),Qt(()=>a.modelValue,()=>r()),(c,y)=>(e(),s("div",Re,[t("div",Ne,[(e(!0),s(Y,null,dt(g.tabs,k=>(e(),s("button",{key:k.id,ref_for:!0,ref_key:"tabRefs",ref:w,class:lt(["tab-btn",{active:g.modelValue===k.id}]),onClick:T=>$(k.id)},v(k.label),11,De))),128)),t("div",{class:"highlight-bar",style:oe(i.value)},null,4)])]))}},Ue=Ct(je,[["__scopeId","data-v-3ca52636"]]);function re(){return{rankIcon:a=>["ðŸ‘‘","ðŸ¥‡","ðŸ¥ˆ","ðŸ¥‰","ðŸ”¥"][a]||`${a+1}.`,recentRankIcon:a=>`${a+1}. ðŸ”¥`}}const Be={class:"feed-main"},Fe={class:"feed-title-line"},Ve={class:"feed-title text-truncate mb-0"},We={key:0},He={key:1},qe={key:0,class:"feed-badge-new ms-1"},Ye={key:1,class:"feed-badge-comment"},Xe={class:"feed-meta"},Ke={class:"feed-meta__item"},Qe={key:0},Ge={key:1,class:"hot-fire me-1","aria-label":"top recent"},Je={class:"feed-meta__item"},Ze={class:"feed-meta__item"},ts={class:"feed-meta__item"},ue=6*60*60*1e3,es={__name:"FeedCard",props:{post:{type:Object,required:!0},posts:Array,notice:{type:Boolean,default:!1},isVote:{type:Boolean,default:!1},likeCount:{type:Number,default:null},commentCount:{type:Number,default:0},page:{type:Number,default:1}},setup(g){const A=g,a=G(()=>{const X=new Date(A.post.createdAt).getTime(),N=A.post.latestCommentTime?new Date(A.post.latestCommentTime).getTime():0,et=Date.now(),ut=et-X<ue,ot=A.commentCount>0&&et-N<ue;return ut||ot}),{rankIcon:_}=re(),w=jt(),i=G(()=>A.post?.category==="íˆ¬í‘œ"),$=ie(),{topWriters:r,topRecentWriters:c}=le($),y=G(()=>!r.value||!A.post.username?-1:r.value.findIndex(N=>N.username===A.post.username)),k=G(()=>new Set((c.value??[]).slice(0,5).map(X=>X.username)));function T(X){return X?k.value.has(X):!1}const O=G(()=>{const X=A.post?.createdAt;if(!X)return"";const N=new Date(X);if(isNaN(N.getTime()))return"";const et=N.getHours()>=12?"ì˜¤í›„":"ì˜¤ì „",ut=N.getHours()%12||12,ot=N.getMinutes().toString().padStart(2,"0");return`${N.getMonth()+1}.${N.getDate()}. ${et} ${ut}:${ot}`}),D=G(()=>A.likeCount??A.post?.likeCount??0),E=G(()=>A.post?.viewCount??0);function L(){w.push({name:"PostDetail",params:{id:A.post.id},query:{page:A.page}})}return(X,N)=>{const et=he("lift");return tt((e(),s("div",{class:lt(["feed-row",{"feed-row--notice":g.notice,"feed-row--vote":i.value}]),onClick:L},[t("div",Be,[t("div",Fe,[t("h6",Ve,[g.notice?(e(),s("span",We,"ðŸ“¢ ê³µì§€ | ")):i.value?(e(),s("span",He,"ðŸ—³ï¸ íˆ¬í‘œ | ")):P("",!0),H(" "+v(g.post.title),1)]),!g.notice&&a.value?(e(),s("span",qe," N ")):P("",!0),!g.notice&&g.commentCount?(e(),s("span",Ye,v(g.commentCount),1)):P("",!0)]),t("div",Xe,[t("span",Ke,[y.value!==-1?(e(),s("span",Qe,v(kt(_)(y.value)),1)):P("",!0),T(g.post.username)?(e(),s("span",Ge,"ðŸ”¥")):P("",!0),H(" "+v(g.post.username),1)]),N[4]||(N[4]=t("span",{class:"feed-meta__dot"},"Â·",-1)),t("span",Je,v(O.value),1),g.notice?P("",!0):(e(),s(Y,{key:0},[N[2]||(N[2]=t("span",{class:"feed-meta__dot"},"Â·",-1)),t("span",Ze,[N[0]||(N[0]=t("i",{class:"bi bi-eye me-1"},null,-1)),H(v(E.value),1)]),N[3]||(N[3]=t("span",{class:"feed-meta__dot"},"Â·",-1)),t("span",ts,[N[1]||(N[1]=t("i",{class:"bi bi-heart-fill me-1 text-like"},null,-1)),H(v(D.value),1)])],64))])])],2)),[[et]])}}},ce=Ct(es,[["__scopeId","data-v-7bb88319"]]),ss={class:"d-flex justify-content-center py-5"},ns={__name:"Spinner",setup(g){return(A,a)=>(e(),s("div",ss,a[0]||(a[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])))}},os=Ct(ns,[["__scopeId","data-v-3cb38245"]]),as={class:"section-title"},ls={class:"d-md-none position-relative"},is={class:"card card-custom p-3 h-100 shadow-sm border-0"},rs=["src"],us={class:"card-body d-flex flex-column"},cs={class:"card-title fw-bold title"},ds={key:2,class:"dots mt-2"},ms=["onClick"],vs={class:"row row-cols-1 row-cols-md-3 g-3 d-none d-md-flex"},ps={class:"card card-custom p-3 h-100 shadow-sm border-0"},fs=["src"],bs={class:"card-body d-flex flex-column"},gs={class:"card-title fw-bold title"},hs={key:0,class:"text-muted small mt-2"},ys={__name:"RecommendedPosts",props:{items:{type:Array,default:()=>[]},title:{type:String,default:"ì¶”ì²œ ê¸€"}},setup(g){const A=g,a=u(null),_=u(0),w=u(0),i=u(0),$=G(()=>A.items.length);function r(){return(w.value||0)+(i.value||0)}function c(L){a.value&&a.value.scrollTo({left:L*r(),behavior:"smooth"})}function y(){_.value=Math.max(0,_.value-1),c(_.value)}function k(){_.value=Math.min($.value-1,_.value+1),c(_.value)}function T(){if(!a.value||!r())return;const L=Math.round(a.value.scrollLeft/r());_.value=Math.min(Math.max(L,0),$.value-1)}function O(L){return L.feedUID??L.id??L.postId}function D(L){return`/post/${O(L)}`}function E(){if(!a.value)return;const L=a.value.querySelector(".snap-card");w.value=L?Math.round(L.offsetWidth):a.value.clientWidth;const X=getComputedStyle(a.value),N=X.getPropertyValue("--gap")||X.gap||"16px",et=parseFloat(N);i.value=Number.isFinite(et)?et:16}return Dt(async()=>{await ae(),E(),a.value?.addEventListener("scroll",T,{passive:!0}),window.addEventListener("resize",E)}),ve(()=>{a.value?.removeEventListener("scroll",T),window.removeEventListener("resize",E)}),(L,X)=>(e(),s("section",null,[t("h2",as,v(g.title),1),t("div",ls,[t("div",{ref_key:"railRef",ref:a,class:"snap-rail"},[(e(!0),s(Y,null,dt(g.items,N=>(e(),s("div",{key:O(N),class:"snap-card"},[t("div",is,[N.imageURL?(e(),s("img",{key:0,src:N.imageURL,class:"card-img-top rounded",alt:"ì´ë¯¸ì§€",style:{height:"150px","object-fit":"cover"}},null,8,rs)):P("",!0),t("div",us,[X[0]||(X[0]=t("div",{class:"d-flex justify-content-between align-items-center mb-2"},[t("span",{class:"badge badge-pick"},"GOOD"),t("small",{class:"text-muted"},"ì¶”ì²œê¸€")],-1)),t("h5",cs,[rt(kt(Bt),{to:D(N),class:"text-decoration-none text-dark"},{default:Mt(()=>[H(v(N.title),1)]),_:2},1032,["to"])])])])]))),128))],512),$.value>1?(e(),s("button",{key:0,class:"nav-btn prev",type:"button",onClick:y,"aria-label":"ì´ì „"},"â€¹")):P("",!0),$.value>1?(e(),s("button",{key:1,class:"nav-btn next",type:"button",onClick:k,"aria-label":"ë‹¤ìŒ"},"â€º")):P("",!0),$.value>1?(e(),s("div",ds,[(e(!0),s(Y,null,dt($.value,(N,et)=>(e(),s("span",{key:et,class:lt(["dot",{active:et===_.value}]),onClick:ut=>c(et)},null,10,ms))),128))])):P("",!0)]),t("div",vs,[(e(!0),s(Y,null,dt(g.items,N=>(e(),s("div",{key:O(N),class:"col"},[t("div",ps,[N.imageURL?(e(),s("img",{key:0,src:N.imageURL,class:"card-img-top rounded",alt:"ì´ë¯¸ì§€",style:{height:"150px","object-fit":"cover"}},null,8,fs)):P("",!0),t("div",bs,[X[1]||(X[1]=t("div",{class:"d-flex justify-content-between align-items-center mb-2"},[t("span",{class:"badge badge-pick"},"GOOD"),t("small",{class:"text-muted"},"ì¶”ì²œê¸€")],-1)),t("h5",gs,[rt(kt(Bt),{to:D(N),class:"text-decoration-none text-dark"},{default:Mt(()=>[H(v(N.title),1)]),_:2},1032,["to"])])])])]))),128))]),g.items.length?P("",!0):(e(),s("div",hs,"ì¶”ì²œê¸€ì´ ì—†ì–´ìš”."))]))}},ks=Ct(ys,[["__scopeId","data-v-cf1f0927"]]),_s={class:"container-fluid px-4 mt-4"},$s={class:"row gx-4"},ws={class:"col-lg-6"},xs={class:"d-flex justify-content-between align-items-center mb-3 border-bottom pb-2"},Cs={class:"list-unstyled small"},As={class:"fw-semibold text-truncate text-break"},Ps={class:"text-muted"},Ss={class:"board-wrap"},Is={key:0,class:"category-bar"},Ls={class:"segmented-tabs"},Ts=["onClick"],Es={key:1,class:"category-bar"},Ms={class:"segmented-tabs"},Os=["onClick"],zs={class:"d-flex justify-content-between align-items-center mb-4 border-bottom pb-2"},Rs={class:"dropdown"},Ns={class:"btn btn-sm btn-outline-secondary dropdown-toggle d-flex align-items-center gap-1","data-bs-toggle":"dropdown"},Ds={class:"dropdown-menu dropdown-menu-end shadow-sm"},js=["onClick"],Us={class:"post-list-area"},Bs={class:"d-flex justify-content-center mt-5"},Fs={__name:"FeedList",setup(g){const A=Yt(),a=jt(),_=u([]),w=u(!1),i=u([]),$=u([]),r=u("IT"),c=u(0),y=u(!1),k=u(0),T=u(0),O=u([]),D=u([]),E=u({}),L=u({});u(""),u(!1);const X=G(()=>r.value==="IT"?i.value:$.value);G(()=>X.value[c.value]??null);const N=u([]),et=["ì˜¤ëŠ˜","ì´ë²ˆì£¼","ì´ë²ˆë‹¬"],ut=["ìžë£Œ","ê¸°ìˆ ","ì·¨ì—…","ìžê²©ì¦"],ot=u("ALL"),mt=u("ì˜¤ëŠ˜"),bt=u("ìžë£Œ"),_t={ì˜¤ëŠ˜:"today",ì´ë²ˆì£¼:"week",ì´ë²ˆë‹¬:"month"},Q={COMMENT:"/post/comment",REPLY:"/post/reply",LIKE:"/post/like",VIEW:"/post/view"},M=[{id:"COMMENT",label:"ëŒ“ê¸€ìˆœ"},{id:"REPLY",label:"ë‹µê¸€ìˆœ"},{id:"LIKE",label:"ì¢‹ì•„ìš”ìˆœ"},{id:"VIEW",label:"ì¡°íšŒìˆœ"}],K=[{id:"ALL",label:"ì „ì²´ ê¸€",url:"/posts"},{id:"BEST",label:"ì¸ê¸°ê¸€ ëª¨ìŒ",url:"/posts/popular/week"},{id:"VOTE",label:"íˆ¬í‘œ",url:"/polls"},{id:"DATA",label:"í•™ìŠµ ìžë£Œ",url:"/data/feed",requiresCategory:!0},{id:"NOTICE",label:"ê³µì§€ì‚¬í•­",url:"/notices",category:"ê³µì§€ì‚¬í•­"},{id:"QNA",label:"Q&A",url:"/data/feed",category:"Q/A"}];function F(R){bt.value=R,pt(0)}function Et(){switch(mt.value){case"ì˜¤ëŠ˜":return"/posts/popular/today";case"ì´ë²ˆì£¼":return"/posts/popular/week";case"ì´ë²ˆë‹¬":return"/posts/popular/month";default:return"/posts/popular/today"}}function h(R){mt.value!==R&&(mt.value=R,pt(0))}u([]),u(0);const b=u("ALL"),S=G(()=>M.find(R=>R.id===b.value)?.label??"ì •ë ¬");function V(R){b.value!==R&&(b.value=R,pt(0))}G(()=>props.notice?`/notice/detail/${props.post.id}`:`/post/${props.post.id}`);function J(R){let z=R?.content??R?.data??[];return z&&!Array.isArray(z)&&Array.isArray(z.content)&&(z=z.content),Array.isArray(z)?z:[]}async function st(R){const z=R.map(ct=>ct.id).filter(Boolean);if(!z.length){E.value={},L.value={};return}try{const{data:ct}=await j.post("/post/stats/by-ids",z),U=ct?.stats||[],it={},gt={};for(const ft of U)ft.postId!=null&&ft.totalCommentCount!==void 0&&(it[ft.postId]=(ft.totalCommentCount??0)+(ft.replyCount??0),gt[ft.postId]=ft.likeCount??0);E.value=it,L.value=gt}catch(ct){console.error("[by-ids stats] ì‹¤íŒ¨",ct),E.value={},L.value={}}}async function vt(R=k.value){try{y.value=!0;const z=Number(R??0);k.value=z,a.replace({query:{...A.query,page:z}}).catch(()=>{});const U={page:Math.max(0,z),size:10},it=b.value!=="ALL",gt=it&&Q[b.value]||"/posts",[ft,yt]=await Promise.all([j.get(gt,{params:U}),j.get("/notice")]),At=ft.data?.ok??ft.data??{},wt=J(At),Lt=At.totalPages??At.totalPage??0;O.value=wt,T.value=Number.isFinite(Lt)?Lt:0,D.value=Array.isArray(yt.data)?yt.data:yt.data??[],it?await st(O.value):await nt(U)}catch(z){console.error("ì „ì²´ ê¸€ ë¡œë”© ì‹¤íŒ¨:",z),O.value=[],E.value={},L.value={},D.value=[],T.value=0}finally{y.value=!1}}async function nt(R){try{const{data:z}=await j.get("/post/stats",{params:R}),ct=z?.stats||[],U={},it={};for(const gt of ct)gt.postId&&gt.totalCommentCount!==void 0&&(U[gt.postId]=gt.totalCommentCount),gt.postId&&gt.likeCount!==void 0&&(it[gt.postId]=gt.likeCount);E.value=U,L.value=it}catch(z){console.error("[stats] ë¡œë”© ì‹¤íŒ¨:",z),E.value={},L.value={}}}async function pt(R=k.value){const z=K.find(ct=>ct.id===ot.value);if(O.value=[],D.value=[],E.value={},L.value={},!!z){if(z.id==="ALL")return vt(R);y.value=!0;try{const ct=Number(R)||0;k.value=ct;const U=ct+1;a.replace({query:{...A.query,page:U}});const it={page:ct,size:10};let gt=z.url;z.id==="BEST"?gt=Et():z.id==="DATA"?gt=`/post/category/${encodeURIComponent(bt.value)}`:z.category&&(gt=`/post/category/${encodeURIComponent(z.category)}`);const{data:ft}=await j.get(gt,{params:it}),yt=ft?.ok??ft??{},At=yt.posts??yt.content??yt.data??[],wt=yt.totalPages??yt.totalPage??0;if(z.id==="BEST"){const Lt=mt.value||"ì˜¤ëŠ˜",Ot=_t[Lt]||"today",{data:Ut}=await j.get(`/post/popular/stats/${Ot}`,{params:it}),zt=Ut.stats||[],xt={},Ft={};for(const St of zt)St.postId&&St.totalCommentCount!==void 0&&(xt[St.postId]=St.totalCommentCount),St.postId&&St.likeCount!==void 0&&(Ft[St.postId]=St.likeCount);E.value=xt,L.value=Ft}else if(z.id==="VOTE"){const{data:Lt}=await j.get("/poll/stats",{params:it}),Ot=Lt.stats||[],Ut={},zt={};for(const xt of Ot)xt.postId&&xt.totalCommentCount!==void 0&&(Ut[xt.postId]=xt.totalCommentCount),xt.postId&&xt.likeCount!==void 0&&(zt[xt.postId]=xt.likeCount);E.value=Ut,L.value=zt}else await nt(it);z.id==="NOTICE"?D.value=Array.isArray(At)?At:[]:(O.value=Array.isArray(At)?At:[],yt.count&&(E.value=yt.count)),T.value=Number.isFinite(wt)?wt:0}catch(ct){console.error(`${z?.label??""} ë¡œë”© ì‹¤íŒ¨`,ct),O.value=[],D.value=[],E.value={},L.value={},T.value=0}finally{y.value=!1}}}return Dt(()=>{const R=parseInt(A.query.page)||0;pt(R)}),Dt(async()=>{try{const{data:R}=await j.get("/post/recommend");N.value=Array.isArray(R?.post)?R.post:[]}catch(R){console.error("ì¶”ì²œ ê¸€ ë¡œë”© ì‹¤íŒ¨:",R),N.value=[]}}),Qt(ot,R=>{R==="ALL"&&b.value!=="ALL"&&(b.value="ALL"),pt(0)}),(R,z)=>{const ct=ke("router-link");return e(),s("section",_s,[t("div",$s,[z[7]||(z[7]=t("aside",{class:"col-lg-3 d-none d-lg-block"},null,-1)),t("main",ws,[rt(ye,{name:"slide"},{default:Mt(()=>[w.value?(e(),s("div",{key:0,class:"mobile-sidebar-backdrop",onClick:z[3]||(z[3]=U=>w.value=!1)},[t("div",{class:"mobile-sidebar bg-white shadow position-fixed top-0 start-0 h-100 p-3",onClick:z[2]||(z[2]=Nt(()=>{},["stop"])),style:{"z-index":"1060",width:"80%","max-width":"300px"}},[t("div",xs,[t("button",{class:"btn-close",onClick:z[0]||(z[0]=U=>w.value=!1)})]),t("ul",Cs,[(e(!0),s(Y,null,dt(_.value,U=>(e(),s("li",{key:U.feedUID,class:"mb-3 border-bottom pb-2"},[rt(ct,{to:`/search/view/feed/id/${U.feedUID}`,class:"text-dark text-decoration-none d-block",onClick:z[1]||(z[1]=it=>w.value=!1)},{default:Mt(()=>[t("div",As,v(U.title),1),t("small",Ps,v(U.username),1)]),_:2},1032,["to"])]))),128))])])])):P("",!0)]),_:1}),t("div",Ss,[rt(Le,{class:"mb-4"}),rt(ks,{items:N.value,class:"mb-4"},null,8,["items"]),rt(Ue,{modelValue:ot.value,"onUpdate:modelValue":z[4]||(z[4]=U=>ot.value=U),tabs:K,class:"mb-3"},null,8,["modelValue"]),ot.value==="BEST"?(e(),s("div",Is,[t("div",Ls,[(e(),s(Y,null,dt(et,U=>t("button",{key:U,class:lt(["seg-btn",{active:mt.value===U}]),onClick:it=>h(U),type:"button"},v(U),11,Ts)),64))])])):P("",!0),ot.value==="DATA"?(e(),s("div",Es,[t("div",Ms,[(e(),s(Y,null,dt(ut,U=>t("button",{key:U,class:lt(["seg-btn",{active:bt.value===U}]),onClick:it=>F(U)},v(U),11,Os)),64))])])):P("",!0),t("div",zs,[z[6]||(z[6]=t("h5",{class:"fw-bold text-dark"},null,-1)),t("div",Rs,[t("button",Ns,[z[5]||(z[5]=t("i",{class:"fas fa-sort-amount-down-alt"},null,-1)),H(" "+v(S.value),1)]),t("ul",Ds,[(e(),s(Y,null,dt(M,U=>t("li",{key:U.id},[t("a",{href:"#",class:lt(["dropdown-item",{"active fw-bold":b.value===U.id}]),onClick:Nt(it=>V(U.id),["prevent"])},v(U.label),11,js)])),64))])])]),t("div",Us,[(e(!0),s(Y,null,dt(D.value,U=>(e(),te(ct,{key:U.id,to:`/notice/detail/${U.id}`,class:"text-decoration-none text-dark d-block notice-card"},{default:Mt(()=>[rt(ce,{post:U,notice:"",class:"mb-3 bg-light-info border-start border-4 border-info"},null,8,["post"])]),_:2},1032,["to"]))),128)),(e(!0),s(Y,null,dt(O.value,U=>(e(),te(ce,{key:U.id,post:U,"is-vote":!U.id,"like-count":L.value[U.id],"comment-count":E.value[U.id],class:"mb-3 post-card",page:k.value,posts:O.value},null,8,["post","is-vote","like-count","comment-count","page","posts"]))),128))]),t("div",Bs,[rt(ze,{page:k.value,totalPages:T.value,onChange:pt},null,8,["page","totalPages"]),y.value?(e(),te(os,{key:0})):P("",!0)])])]),z[8]||(z[8]=t("div",{class:"col-lg-3 d-none d-lg-block"},null,-1))])])}}},Vs=Ct(Fs,[["__scopeId","data-v-ed1ad5a1"]]),zu=Object.freeze(Object.defineProperty({__proto__:null,default:Vs},Symbol.toStringTag,{value:"Module"})),Ws={key:0,class:"prev-next-fixed"},Hs=["disabled"],qs=["disabled"],Ys={__name:"PrevNextButtons",props:{posts:Array},setup(g){const A=g,a=Yt(),_=jt(),w=G(()=>a.params.id||a.query.id),i=G(()=>A.posts.map(k=>k.feedUID)),$=G(()=>i.value.findIndex(k=>String(k)===String(w.value))),r=G(()=>$.value>0?i.value[$.value-1]:null),c=G(()=>$.value<i.value.length-1?i.value[$.value+1]:null);function y(k){k&&_.push({path:`/search/view/feed/id/${k}`})}return(k,T)=>r.value||c.value?(e(),s("div",Ws,[t("button",{class:"nav-btn",disabled:!r.value,onClick:T[0]||(T[0]=O=>y(r.value)),title:"ì´ì „ê¸€"},T[2]||(T[2]=[t("i",{class:"bi bi-chevron-up"},null,-1)]),8,Hs),t("button",{class:"nav-btn",disabled:!c.value,onClick:T[1]||(T[1]=O=>y(c.value)),title:"ë‹¤ìŒê¸€"},T[3]||(T[3]=[t("i",{class:"bi bi-chevron-down"},null,-1)]),8,qs)])):P("",!0)}},Xs=Ct(Ys,[["__scopeId","data-v-79bcfec4"]]),pe=me("postDetail",{state:()=>({last:null}),actions:{setDetail(g){this.last=g},getByPostId(g){const A=Number(g);return this.last&&Number(this.last.post.id)===A?this.last:null},clear(){this.last=null}}}),Ks={key:1,class:"post-detail-loading text-center pt-5"},Qs={key:2,class:"post-detail-page container pt-navbar my-4"},Gs={key:0,class:"text-end mb-2"},Js={class:"card shadow-sm post-card"},Zs={class:"card-body"},tn={class:"post-header mb-3"},en={class:"post-title"},sn={class:"post-meta-row small"},nn={key:0,class:"me-1"},on={key:1,class:"hot-fire me-1","aria-label":"top recent"},an={class:"fw-semibold"},ln={key:0,class:"ms-1"},rn={class:"d-inline-flex align-items-center"},un={key:1,class:"dot"},cn={key:2,class:"text-muted"},dn=["innerHTML"],mn={class:"post-actions d-flex justify-content-between align-items-center mt-4"},vn={class:"text-muted small"},pn={class:"comments-section mt-4"},fn={class:"d-flex justify-content-between align-items-center mb-2"},bn={class:"mb-0"},gn={class:"text-muted small"},hn={key:0,class:"text-muted py-3 small"},yn={class:"comment-body flex-grow-1"},kn={class:"d-flex justify-content-between align-items-start"},_n={class:"comment-meta"},$n={class:"me-1"},wn={key:0,class:"hot-fire me-1","aria-label":"top recent"},xn={class:"fw-semibold"},Cn={key:1,class:"badge-author ms-1"},An={key:2,class:"badge-author ms-1"},Pn={class:"ms-2 text-muted"},Sn={class:"ms-2 d-flex align-items-center gap-2"},In=["onClick"],Ln=["onClick"],Tn=["onClick"],En={class:"small"},Mn=["innerHTML"],On={key:0,class:"mt-2"},zn=["onUpdate:modelValue"],Rn={class:"d-flex gap-2"},Nn=["disabled","onClick"],Dn={key:1,class:"mt-2 reply-list"},jn={class:"d-flex justify-content-between align-items-start"},Un={class:"reply-meta"},Bn={class:"me-1"},Fn={key:0,class:"hot-fire me-1","aria-label":"top recent"},Vn={class:"fw-semibold"},Wn={key:1,class:"badge-author ms-1"},Hn={key:2,class:"badge-author ms-1"},qn={class:"text-muted ms-2"},Yn={class:"ms-2 d-flex align-items-center gap-2 small"},Xn=["onClick"],Kn=["onClick"],Qn=["onClick"],Gn={class:"small"},Jn={key:0,class:"mt-2"},Zn=["onUpdate:modelValue"],to={class:"d-flex gap-2"},eo=["onClick"],so=["onClick"],no={key:1,class:"reply-content"},oo=["onClick"],ao={class:"mt-2"},lo=["onUpdate:modelValue"],io=["onClick","disabled"],ro={class:"card shadow-sm p-3 mt-4 comment-write-card"},uo={class:"d-flex justify-content-between align-items-center mb-2"},co=["placeholder"],mo={class:"text-end"},vo=["disabled"],po={__name:"FeedDetail",setup(g){const A=Yt(),a=jt(),_=ee(),w=u([]);A.params.id;const i=u({}),$=u({}),r=u({}),c=u({}),{rankIcon:y}=re();u("");const k=u([]),T=u(!1),O=u(!1),D=u(!1),E=u({}),L=u(""),X=u({}),N=u({}),et=u(null),ut=u(""),ot=u(!1),mt=u(0),bt=G(()=>_.isLoggedIn),_t=G(()=>i.value.owner===!0),Q=u(null),M=u({}),K=u(!1),F=pe();G(()=>{const p=parseInt(A.query.page??"0",10);return Number.isNaN(p)?0:p});const Et=ie(),{topWriters:h,topRecentWriters:b}=le(Et),S=G(()=>{const p=i.value.username;return!h.value||!p?-1:h.value.findIndex(n=>n.username===p)}),V=G(()=>new Set((b.value??[]).slice(0,5).map(p=>p.username)));function J(p){return p?V.value.has(p):!1}function st(p){if(!h.value||!p)return"";const d=h.value.findIndex(n=>n.username===p);return d!==-1?y(d):""}function vt(p){return st(p)}function nt(p=""){return p.replace(/(https?:\/\/[^\s<"]+)/g,(d,n,o,l)=>{const m=l.slice(Math.max(0,o-5),o);if(/src=\"?$/.test(m))return d;const I=d.match(/(?:youtu\.be\/|youtube\.com\/watch\?v=)([a-zA-Z0-9_-]+)/);return I?`
        <iframe width="100%" height="315"
          src="https://www.youtube.com/embed/${I[1]}"
          frameborder="0"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen
        ></iframe>
      `:`<a href="${d}" target="_blank">${d}</a>`})}function pt(p){$.value[p.id]=p.content,r.value[p.id]=!0}function R(p){r.value[p]=!1}async function z(p){const d=($.value[p.id]||"").trim();if(!d){alert("ë‹µê¸€ ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”.");return}const n=localStorage.getItem("token");if(!n){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."),a.push("/login");return}try{const{data:o}=await j.put(`/reply/${p.id}`,{content:d},{headers:{Authorization:`Bearer ${n}`}}),l=o?.reply??{},m=Object.keys(E.value).find(I=>E.value[I].some(W=>W.id===p.id));m&&(E.value[m]=E.value[m].map(I=>I.id===p.id?{...I,content:l.content??d,updatedAt:l.updatedAt??new Date().toISOString()}:I)),r.value[p.id]=!1}catch(o){console.error(o),alert("ë‹µê¸€ ìˆ˜ì • ì‹¤íŒ¨")}}async function ct(p){if(!confirm("ë‹µê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))return;const d=localStorage.getItem("token");if(!d){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."),a.push("/login");return}try{await j.delete(`/reply/${p.id}`,{headers:{Authorization:`Bearer ${d}`}});const n=Object.keys(E.value).find(o=>E.value[o].some(l=>l.id===p.id));n&&(E.value[n]=E.value[n].filter(o=>o.id!==p.id))}catch(n){console.error(n),alert("ë‹µê¸€ ì‚­ì œ ì‹¤íŒ¨")}}function U(p){Q.value=p.id,M.value[p.id]=p.content}function it(){Q.value!=null&&(M.value[Q.value]=""),Q.value=null}async function gt(p){const d=M.value[p]||"";if(!d.trim()){alert("ìˆ˜ì •í•  ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”.");return}const n=localStorage.getItem("token");if(!n){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."),a.push("/login");return}if(!K.value){K.value=!0;try{const{data:o}=await j.put(`/comment/${p}`,{content:d},{headers:{Authorization:`Bearer ${n}`}}),l=o?.comment??o??{};k.value=k.value.map(m=>m.id===p?{...m,content:l.content??d,modifiedAt:l.modifiedAt??l.updatedAt??m.modifiedAt}:m),Q.value=null}catch(o){console.error(o),alert("ëŒ“ê¸€ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ ë°œìƒ")}finally{K.value=!1}}}function ft(p){if(!p)return"";const d=new Date(p),n=d.getMonth()+1,o=d.getDate();let l=d.getHours();const m=d.getMinutes(),I=l>=12?"ì˜¤í›„":"ì˜¤ì „";l=l%12||12;const W=m<10?`0${m}`:m;return`${n}. ${o}. ${I} ${l}:${W}`}const yt=ft,At=G(()=>ft(i.value.createdAt));async function wt(p){const{data:d}=await j.get("/comments",{params:{postId:p}});k.value=Array.isArray(d?.ok)&&d.ok||Array.isArray(d?.comments)&&d.comments||Array.isArray(d?.data?.comments)&&d.data.comments||[]}function Lt(p=""){const d=/(https?:\/\/[^\s]+)/g;return p.replace(d,n=>`<a href="${n}" target="_blank">${n}</a>`)}function Ot(p=""){const d=document.createElement("textarea");return d.innerHTML=p,d.value}async function Ut(p){const{data:d}=await j.get("/replys",{params:{postId:p}}),o=(Array.isArray(d?.ok)&&d.ok||Array.isArray(d?.replies)&&d.replies||Array.isArray(d?.data)&&d.data||[]).reduce((l,m)=>{const I=m.commentId??m.commentUID??m.comment_id;return I&&(l[I]||(l[I]=[])).push({id:m.id,username:m.username,content:m.content,createdAt:m.createdAt,updatedAt:m.updatedAt??null,owner:m.owner,author:m.author}),l},{});E.value=o}async function zt(p){try{let o=function(m=""){return m.replace(/></g,">â€‹<").replace(/<\/div>/g,"<br>").replace(/<div>/g,"")};D.value=!1;const{data:d}=await j.get(`/post/${p}`);if(T.value=d?.ok?.hasPoll??!1,T.value&&d.ok.poll){F.setDetail({post:d.ok.post,poll:d.ok.poll});try{const m=localStorage.getItem("token");fetch("/api/view/count",{method:"POST",headers:{"Content-Type":"application/json",...m&&{Authorization:`Bearer ${m}`}},credentials:"include",body:JSON.stringify({id:p})}).then(I=>{if(!I.ok)throw new Error(`HTTP error! status: ${I.status}`)}).catch(I=>console.error("ì¡°íšŒìˆ˜ ì¦ê°€ ì‹¤íŒ¨:",I))}catch(m){console.error(m),a.replace("/")}a.replace({name:"PollDetail",params:{id:d.ok.post.id||p}});return}const n=d?.ok.post??{};i.value={id:n.id,username:n.username??"",imageURL:n.imageURL??n.imageUrl??null,title:n.title??"",description:n.description??"",category:n.category??null,likeCount:n.likeCount??0,viewCount:n.viewCount??0,createdAt:n.createdAt??null,modifiedAt:n.modifiedAt??null,owner:n.owner},Ft("POST",i.value.id,i.value.likeCount??0,d.isLiked??!1),await Promise.all([wt(i.value.id),Ut(i.value.id)]),await Xt(i.value.id),await x(i.value.id),O.value=d.isLiked,D.value=!0;const l=localStorage.getItem("token");fetch("/api/view/count",{method:"POST",headers:{"Content-Type":"application/json",...l&&{Authorization:`Bearer ${l}`}},credentials:"include",body:JSON.stringify({id:p})}).then(m=>{if(!m.ok)throw new Error(`HTTP error! status: ${m.status}`)}).catch(m=>console.error("ì¡°íšŒìˆ˜ ì¦ê°€ ì‹¤íŒ¨:",m))}catch(d){console.error(d),a.replace("/")}}Dt(()=>zt(A.params.id));const xt=(p,d)=>`${p}-${d}`;function Ft(p,d,n=0,o=!1){const l=xt(p,d);c.value[l]||(c.value[l]={liked:o,count:n})}function St(p,d){const n=xt(p,d);return c.value[n]?.liked??!1}function Wt(p,d){const n=xt(p,d);return c.value[n]?.count??0}Qt(()=>A.params.id,(p,d)=>{p&&p!==d&&zt(p)});async function Ht(p,d){if(!bt.value){typeof push=="function"?push("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤"):alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤"),a.push("/login");return}const n=i.value.id;Ft(p,d);const o=xt(p,d),l=c.value[o],m=l.liked,I=l.count;l.liked=!m,l.count=I+(m?-1:1);try{await j.post("/like",{postId:n,targetId:d,targetType:p})}catch(W){console.error(W),l.liked=m,l.count=I}}async function Xt(p){try{const{data:d}=await j.get(`/like/count/${p}`),n=Array.isArray(d?.likes)?d.likes:[],o=Array.isArray(k.value)?k.value:[],l=E.value&&typeof E.value=="object"?E.value:{},m=new Set(o.map(W=>Number(W.id))),I=new Set;Object.values(l).forEach(W=>{(W||[]).forEach(Z=>{I.add(Number(Z.id))})}),n.forEach(W=>{const Z=Number(W.targetId??W.id),It=Number(W.count??0);if(!Number.isFinite(Z))return;const Tt=Number(i.value.id);let Vt=null;if(Z===Tt?Vt="POST":m.has(Z)?Vt="COMMENT":I.has(Z)&&(Vt="REPLY"),!Vt){console.log("ë§¤ì¹­ ì•ˆ ëœ targetId:",Z);return}const qt=xt(Vt,Z),Gt=c.value[qt]||{liked:!1,count:0};c.value[qt]={liked:Gt.liked,count:It}})}catch(d){console.error("like count ë¡œë“œ ì‹¤íŒ¨",d)}}async function x(p){const d=localStorage.getItem("token");if(d)try{const{data:n}=await j.get(`/like/detail/${p}`,{headers:{Authorization:`Bearer ${d}`}});(Array.isArray(n?.likes)?n.likes:[]).forEach(l=>{const m=l.targetType??l.target_type??l.type,I=Number(l.targetId??l.target_id??l.id),W=!!(l.isOwner??l.owner??l.liked);if(!m||!I)return;const Z=xt(m,I),It=c.value[Z]||{liked:!1,count:0};c.value[Z]={liked:W,count:It.count}})}catch(n){console.error("like detail ë¡œë“œ ì‹¤íŒ¨",n)}}async function f(){if(ot.value)return;if(!ut.value.trim()){alert("ëŒ“ê¸€ ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”!");return}const p=localStorage.getItem("token");if(!p){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."),a.push("/login");return}ot.value=!0;try{await j.post("/comment",{content:ut.value,username:_.username,postId:i.value.id},{headers:{Authorization:`Bearer ${p}`}}),await new Promise(d=>setTimeout(d,1e3)),await wt(i.value.id),ut.value=""}catch(d){console.error(d),alert("ëŒ“ê¸€ ì €ìž¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ")}finally{ot.value=!1}}function C(){a.push({path:"/post/update",query:{id:i.value.id}})}async function B(){if(confirm("ì •ë§ë¡œ ì´ ê²Œì‹œê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))try{const p=localStorage.getItem("token");await j.delete(`/post/${i.value.id}`,{headers:p?{Authorization:`Bearer ${p}`}:{}}),a.push("/")}catch(p){console.error(p),alert("ì‚­ì œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ")}}async function q(p){if(!confirm("ì‚­ì œí• ê¹Œìš”?"))return;const d=localStorage.getItem("token");if(!d){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."),a.push("/login");return}try{await j.delete(`/comment/${p.id}`,{headers:{Authorization:`Bearer ${d}`}}),k.value=k.value.filter(n=>n.id!==p.id),alert("ëŒ“ê¸€ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(n){console.error(n),alert("ì‚­ì œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ")}}function at(p){et.value=et.value===p?null:p,L.value=""}async function ht(p){const d=X.value[p]||"";if(!bt.value){a.push("/login");return}if(!d.trim()){alert("ë‹µê¸€ ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”.");return}if(N.value[p])return;N.value[p]=!0;const n=localStorage.getItem("token");try{await j.post("/reply",{commentId:p,postId:i.value.id,username:_.username,content:d},{headers:{Authorization:`Bearer ${n}`}}),await Promise.all([wt(i.value.id),Ut(i.value.id)]),et.value=null,X.value[p]="",mt.value++}catch(o){console.error(o),alert("ë‹µê¸€ ì €ìž¥ ì‹¤íŒ¨")}finally{N.value[p]=!1}}const Pt=G(()=>{const p=i.value.description||"";return nt(Ot(p))});return(p,d)=>(e(),s(Y,null,[D.value?(e(),te(Xs,{key:0,posts:w.value,class:"mb-3"},null,8,["posts"])):P("",!0),D.value?(e(),s("section",Qs,[_t.value?(e(),s("div",Gs,[t("div",{class:"dropdown d-none d-md-inline-block"},[d[6]||(d[6]=t("button",{class:"btn btn-outline-secondary btn-sm rounded-pill","data-bs-toggle":"dropdown"},[t("i",{class:"fas fa-ellipsis-v"})],-1)),t("ul",{class:"dropdown-menu dropdown-menu-end"},[t("li",null,[t("button",{type:"button",class:"dropdown-item",onClick:C},d[4]||(d[4]=[t("i",{class:"fas fa-edit me-2"},null,-1),H(" ìˆ˜ì • ")]))]),t("li",null,[t("button",{type:"button",class:"dropdown-item text-danger",onClick:B},d[5]||(d[5]=[t("i",{class:"fas fa-trash me-2"},null,-1),H(" ì‚­ì œ ")]))])])]),t("div",{class:"dropup d-md-none position-fixed action-fab"},[d[9]||(d[9]=t("button",{class:"btn btn-primary rounded-circle shadow dropdown-toggle","data-bs-toggle":"dropdown","aria-expanded":"false"},[t("i",{class:"fas fa-ellipsis-v"})],-1)),t("ul",{class:"dropdown-menu dropdown-menu-end"},[t("li",null,[t("button",{class:"dropdown-item",onClick:C},d[7]||(d[7]=[t("i",{class:"fas fa-edit me-2"},null,-1),H(" ìˆ˜ì • ")]))]),t("li",null,[t("button",{class:"dropdown-item text-danger",onClick:B},d[8]||(d[8]=[t("i",{class:"fas fa-trash me-2"},null,-1),H(" ì‚­ì œ ")]))])])])])):P("",!0),t("article",Js,[t("div",Zs,[t("header",tn,[t("h1",en,v(i.value.title),1),t("div",sn,[rt(kt(Bt),{to:`/user/profile/${i.value.username}`,class:"post-author-link text-decoration-none d-inline-flex align-items-center"},{default:Mt(()=>[S.value!==-1?(e(),s("span",nn,v(kt(y)(S.value)),1)):P("",!0),J(i.value.username)?(e(),s("span",on,"ðŸ”¥")):P("",!0),t("span",an,v(i.value.username),1)]),_:1},8,["to"]),d[10]||(d[10]=t("span",{class:"dot"},"Â·",-1)),i.value.modifiedAt?P("",!0):(e(),s("span",ln,"Â· "+v(At.value),1)),d[11]||(d[11]=t("span",{class:"dot"},"Â·",-1)),t("span",null,"ì¡°íšŒ "+v(i.value.viewCount??0),1),d[12]||(d[12]=t("span",{class:"dot"},"Â·",-1)),t("span",rn,[t("i",{class:lt([["bi",St("POST",i.value.id)?"bi-heart-fill text-like":"bi-heart"],"me-1"])},null,2),t("span",null,v(Wt("POST",i.value.id)),1)]),i.value.modifiedAt?(e(),s("span",un,"Â·")):P("",!0),i.value.modifiedAt?(e(),s("span",cn," ìˆ˜ì • "+v(kt(yt)(i.value.modifiedAt)),1)):P("",!0)])]),t("section",{class:"post-content",innerHTML:Pt.value},null,8,dn),t("footer",mn,[t("div",vn,[d[13]||(d[13]=t("i",{class:"bi bi-chat-dots me-1"},null,-1)),H(" ëŒ“ê¸€ "+v(k.value.length),1)]),t("button",{class:"btn btn-sm btn-outline-danger like-btn d-inline-flex align-items-center",onClick:d[0]||(d[0]=()=>Ht("POST",i.value.id))},[t("i",{class:lt([["bi",St("POST",i.value.id)?"bi-heart-fill text-like":"bi-heart"],"me-1"])},null,2),t("span",null,v(Wt("POST",i.value.id)),1)])])])]),t("section",pn,[t("div",fn,[t("h5",bn,[d[14]||(d[14]=t("i",{class:"bi bi-chat"},null,-1)),d[15]||(d[15]=H(" ëŒ“ê¸€ ")),t("span",gn,"("+v(k.value.length)+")",1)])]),k.value.length===0?(e(),s("div",hn," ì•„ì§ ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ ëŒ“ê¸€ì„ ë‚¨ê²¨ë³´ì„¸ìš”. ")):P("",!0),(e(!0),s(Y,null,dt(k.value,n=>(e(),s("div",{key:n.id+"-"+mt.value,class:"comment-item d-flex"},[t("div",yn,[t("div",kn,[t("div",_n,[rt(kt(Bt),{to:`/user/profile/${n.username}`,class:"comment-author text-decoration-none"},{default:Mt(()=>[t("span",$n,v(vt(n.username)),1),J(n.username)?(e(),s("span",wn,"ðŸ”¥")):P("",!0),t("span",xn,v(n.username),1),n.author?(e(),s("span",Cn,"ê¸€ì“´ì´")):P("",!0),n.owner?(e(),s("span",An,"ìž‘ì„±ìž")):P("",!0)]),_:2},1032,["to"]),t("small",Pn,[n.updatedAt?(e(),s(Y,{key:0},[H(" (ìˆ˜ì •ë¨ Â· "+v(kt(yt)(n.updatedAt))+") ",1)],64)):(e(),s(Y,{key:1},[H(v(kt(yt)(n.createdAt)),1)],64))])]),t("div",Sn,[n.owner?(e(),s("button",{key:0,class:"btn btn-sm btn-link text-secondary p-0",onClick:o=>U(n)}," ìˆ˜ì • ",8,In)):P("",!0),n.owner?(e(),s("button",{key:1,class:"btn btn-sm btn-link text-danger p-0",onClick:o=>q(n)},"ì‚­ì œ ",8,Ln)):P("",!0),t("button",{class:"btn btn-sm btn-link text-danger p-0 d-inline-flex align-items-center",onClick:()=>Ht("COMMENT",n.id)},[t("i",{class:lt([["bi",St("COMMENT",n.id)?"bi-heart-fill text-like":"bi-heart"],"me-1"])},null,2),t("span",En,v(Wt("COMMENT",n.id)),1)],8,Tn)])]),t("div",{class:"mt-1 comment-content",innerHTML:Lt(n.content)},null,8,Mn),Q.value===n.id?(e(),s("div",On,[tt(t("textarea",{"onUpdate:modelValue":o=>M.value[n.id]=o,rows:"2",class:"form-control mb-2",placeholder:"ìˆ˜ì •í•  ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”."},null,8,zn),[[$t,M.value[n.id]]]),t("div",Rn,[t("button",{class:"btn btn-sm btn-primary",disabled:K.value,onClick:o=>gt(n.id)},"ìˆ˜ì • ì™„ë£Œ ",8,Nn),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:it}," ì·¨ì†Œ ")])])):P("",!0),E.value&&E.value[n.id]?(e(),s("div",Dn,[(e(!0),s(Y,null,dt(E.value[n.id],o=>(e(),s("div",{key:o.id,class:"reply-item"},[t("div",jn,[t("div",Un,[rt(kt(Bt),{to:`/user/profile/${o.username}`,class:"comment-author text-decoration-none"},{default:Mt(()=>[t("span",Bn,v(vt(o.username)),1),J(o.username)?(e(),s("span",Fn,"ðŸ”¥")):P("",!0),t("span",Vn,v(o.username),1),o.author?(e(),s("span",Wn,"ê¸€ì“´ì´")):P("",!0),o.owner?(e(),s("span",Hn,"ìž‘ì„±ìž")):P("",!0)]),_:2},1032,["to"]),t("small",qn,[o.updatedAt?(e(),s(Y,{key:0},[H(" (ìˆ˜ì •ë¨ Â· "+v(kt(yt)(o.updatedAt))+") ",1)],64)):(e(),s(Y,{key:1},[H(v(kt(yt)(o.createdAt)),1)],64))])]),t("div",Yn,[o.owner?(e(),s("button",{key:0,class:"btn btn-link btn-sm text-secondary p-0 me-2",onClick:l=>pt(o)}," ìˆ˜ì • ",8,Xn)):P("",!0),o.owner?(e(),s("button",{key:1,class:"btn btn-link btn-sm text-danger p-0",onClick:l=>ct(o)}," ì‚­ì œ ",8,Kn)):P("",!0),t("button",{class:"btn btn-link btn-sm text-danger p-0 d-inline-flex align-items-center",onClick:()=>Ht("REPLY",o.id)},[t("i",{class:lt([["bi",St("REPLY",o.id)?"bi-heart-fill  text-like":"bi-heart"],"me-1"])},null,2),t("span",Gn,v(Wt("REPLY",o.id)),1)],8,Qn)])]),r.value[o.id]?(e(),s("div",Jn,[tt(t("textarea",{"onUpdate:modelValue":l=>$.value[o.id]=l,rows:"2",class:"form-control mb-2"},null,8,Zn),[[$t,$.value[o.id]]]),t("div",to,[t("button",{class:"btn btn-sm btn-primary",onClick:l=>z(o)}," ì €ìž¥ ",8,eo),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:l=>R(o.id)}," ì·¨ì†Œ ",8,so)])])):(e(),s("div",no,v(o.content),1))]))),128))])):P("",!0),t("button",{class:"btn btn-sm btn-outline-primary mt-2",onClick:o=>at(n.id)}," ë‹µê¸€ ë‹¬ê¸° ",8,oo),tt(t("div",ao,[tt(t("textarea",{"onUpdate:modelValue":o=>X.value[n.id]=o,rows:"2",class:"form-control mb-2",placeholder:"ë‹µê¸€ ìž…ë ¥"},null,8,lo),[[$t,X.value[n.id]]]),t("button",{class:"btn btn-sm btn-primary",onClick:o=>ht(n.id),disabled:N.value[n.id]}," ë‹µê¸€ ìž‘ì„± ",8,io)],512),[[Rt,et.value===n.id]])])]))),128))]),t("section",ro,[t("div",uo,[d[16]||(d[16]=t("h6",{class:"mb-0"},[t("i",{class:"bi bi-pencil-square me-1"}),H(" ëŒ“ê¸€ ì“°ê¸° ")],-1)),bt.value?P("",!0):(e(),s("button",{key:0,class:"btn btn-sm btn-outline-secondary",onClick:d[1]||(d[1]=n=>kt(a).push("/login"))},"ë¡œê·¸ì¸ "))]),tt(t("textarea",{"onUpdate:modelValue":d[2]||(d[2]=n=>ut.value=n),rows:"3",class:"form-control mb-2",placeholder:bt.value?"ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”.":"ë¡œê·¸ì¸ í›„ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤."},null,8,co),[[$t,ut.value]]),t("div",mo,[t("button",{class:"btn btn-success px-4",disabled:!bt.value||ot.value||!ut.value.trim(),onClick:f}," ìž‘ì„±í•˜ê¸° ",8,vo)])])])):(e(),s("div",Ks,d[3]||(d[3]=[t("i",{class:"bi bi-arrow-repeat fs-2 spin"},null,-1)])))],64))}},fo=Ct(po,[["__scopeId","data-v-38ee31c4"]]),Ru=Object.freeze(Object.defineProperty({__proto__:null,default:fo},Symbol.toStringTag,{value:"Module"})),bo={class:"container mt-5"},go={class:"row justify-content-center"},ho={class:"col-md-6"},yo={class:"card shadow-lg"},ko={class:"card-body"},_o={class:"mb-3"},$o={class:"form-group mb-3"},wo={class:"mb-3"},xo={__name:"PostFeed",setup(g){const A=u(""),a=u(""),_=u([]),w=jt();function i(r){_.value=Array.from(r.target.files)}async function $(){const r=localStorage.getItem("token");if(!r){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");return}const c=new FormData;c.append("title",A.value),c.append("description",a.value.replace(/\n/g,"\\n")),_.value.length>0&&c.append("imageFile",_.value[0]);try{await _e.post("/api/notice",c,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"multipart/form-data"}}),alert("ê³µì§€ì‚¬í•­ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!"),w.push("/")}catch{alert("ê³µì§€ì‚¬í•­ ë“±ë¡ ì‹¤íŒ¨!")}}return(r,c)=>(e(),s("div",bo,[t("div",go,[t("div",ho,[t("div",yo,[c[6]||(c[6]=t("div",{class:"card-header bg-primary text-white text-center"},[t("h3",null,"ðŸ“¢ ê³µì§€ì‚¬í•­ ìž‘ì„±")],-1)),t("div",ko,[t("form",{onSubmit:Nt($,["prevent"])},[t("div",_o,[c[2]||(c[2]=t("label",{for:"title",class:"form-label"}," ì œëª© ",-1)),tt(t("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":c[0]||(c[0]=y=>A.value=y),required:"",placeholder:"ê³µì§€ì‚¬í•­ ì œëª© ìž…ë ¥"},null,512),[[$t,A.value]])]),t("div",$o,[c[3]||(c[3]=t("label",{for:"imageFiles"}," ì´ë¯¸ì§€ íŒŒì¼ë“¤: ",-1)),t("input",{type:"file",id:"imageFiles",class:"form-control",accept:"image/*",multiple:"",onChange:i},null,32)]),t("div",wo,[c[4]||(c[4]=t("label",{for:"content",class:"form-label"}," ë‚´ìš© ",-1)),tt(t("textarea",{class:"form-control",id:"content",rows:"5","onUpdate:modelValue":c[1]||(c[1]=y=>a.value=y),placeholder:"ê³µì§€ì‚¬í•­ ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”",required:""},null,512),[[$t,a.value]])]),c[5]||(c[5]=t("button",{type:"submit",class:"btn btn-primary w-100"}," ë“±ë¡í•˜ê¸° ",-1))],32)])])])])]))}},Co=Ct(xo,[["__scopeId","data-v-84f0fe72"]]),Nu=Object.freeze(Object.defineProperty({__proto__:null,default:Co},Symbol.toStringTag,{value:"Module"})),Ao={class:"container my-4 pt-navbar"},Po={key:0,class:"text-center pt-5"},So={key:1,class:"alert alert-danger"},Io={key:2},Lo={key:0,class:"text-end mb-2"},To={class:"card shadow-sm feed-card"},Eo={class:"card-body"},Mo={class:"d-flex justify-content-between align-items-start gap-3"},Oo={class:"feed-title mb-0"},zo={class:"feed-meta text-muted mt-2"},Ro={class:"me-2"},No={class:"me-2"},Do=["innerHTML"],jo={class:"post-actions d-flex justify-content-between align-items-center mt-4"},Uo={class:"text-muted small"},Bo={key:3,class:"comments-section mt-4"},Fo={class:"d-flex justify-content-between align-items-center mb-2"},Vo={class:"mb-0"},Wo={class:"text-muted small"},Ho={key:0,class:"text-muted py-3 small"},qo={class:"comment-body flex-grow-1"},Yo={class:"d-flex justify-content-between align-items-start"},Xo={class:"comment-meta"},Ko={class:"me-1"},Qo={class:"fw-semibold"},Go={key:0,class:"badge-author ms-1"},Jo={key:1,class:"badge-author ms-1"},Zo={class:"ms-2 text-muted"},ta={class:"ms-2 d-flex align-items-center gap-2"},ea=["onClick"],sa=["onClick"],na=["onClick"],oa={class:"small"},aa=["innerHTML"],la={key:0,class:"mt-2"},ia=["onUpdate:modelValue"],ra={class:"d-flex gap-2"},ua=["disabled","onClick"],ca={key:1,class:"mt-2 reply-list"},da={class:"d-flex justify-content-between align-items-start"},ma={class:"reply-meta"},va={class:"me-1"},pa={class:"fw-semibold"},fa={key:0,class:"badge-author ms-1"},ba={key:1,class:"badge-author ms-1"},ga={class:"text-muted ms-2"},ha={class:"ms-2 d-flex align-items-center gap-2 small"},ya=["onClick"],ka=["onClick"],_a=["onClick"],$a={class:"small"},wa={key:0,class:"mt-2"},xa=["onUpdate:modelValue"],Ca={class:"d-flex gap-2"},Aa=["onClick"],Pa=["onClick"],Sa={key:1,class:"reply-content"},Ia=["onClick"],La={class:"mt-2"},Ta=["onUpdate:modelValue"],Ea=["onClick","disabled"],Ma={key:4,class:"card shadow-sm p-3 mt-4 comment-write-card"},Oa={class:"d-flex justify-content-between align-items-center mb-2"},za=["placeholder"],Ra={class:"text-end"},Na=["disabled"],Da={__name:"NoticeDetail",setup(g){const A=Yt(),a=jt(),_=ee(),w=u(!0),i=u(""),$=u({}),r=G(()=>A.params.id),c=u([]),y=u({}),k=u({}),T=u(null),O=u({}),D=u({}),E=u(""),L=u(!1),X=u(0),N=u(null),et=u({}),ut=u(!1),ot=u({}),mt=u({}),{rankIcon:bt}=re(),_t=ie(),{topWriters:Q}=le(_t),M=G(()=>S($.value.description)),K=G(()=>V($.value.createdAt)),F=G(()=>_.isLoggedIn),Et=G(()=>$.value.owner===!0);G(()=>-1);function h(x){if(!Q.value||!x)return"";const f=Q.value.findIndex(C=>C.username===x);return f!==-1?bt(f):""}function b(x){return h(x)}function S(x=""){return x?x.replace(/<\/div>/g,"<br>").replace(/<div>/g,"").replace(/(https?:\/\/[^\s<"]+)/g,C=>`<a href="${C}" target="_blank" rel="noopener">${C}</a>`):""}function V(x){if(!x)return"";const f=new Date(x),C=f.getMonth()+1,B=f.getDate();let q=f.getHours();const at=f.getMinutes(),ht=q>=12?"ì˜¤í›„":"ì˜¤ì „";q=q%12||12;const Pt=at<10?`0${at}`:at;return`${C}. ${B}. ${ht} ${q}:${Pt}`}function J(x=""){const f=/(https?:\/\/[^\s]+)/g;return x.replace(f,C=>`<a href="${C}" target="_blank">${C}</a>`)}const st=(x,f)=>`${x}-${f}`;function vt(x,f,C=0,B=!1){const q=st(x,f);k.value[q]||(k.value[q]={liked:B,count:C})}function nt(x,f){const C=st(x,f);return k.value[C]?.liked??!1}function pt(x,f){const C=st(x,f);return k.value[C]?.count??0}async function R(x,f){if(!F.value){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤"),a.push("/login");return}const C=$.value.id;vt(x,f);const B=st(x,f),q=k.value[B],at=q.liked,ht=q.count;q.liked=!at,q.count=ht+(at?-1:1);try{await j.post("/like",{postId:C,targetId:f,targetType:x})}catch(Pt){console.error(Pt),q.liked=at,q.count=ht}}async function z(x){try{const{data:f}=await j.get(`/like/count/${x}`),C=Array.isArray(f?.likes)?f.likes:[],B=Array.isArray(c.value)?c.value:[],q=y.value&&typeof y.value=="object"?y.value:{},at=new Set(B.map(Pt=>Number(Pt.id))),ht=new Set;Object.values(q).forEach(Pt=>{(Pt||[]).forEach(p=>{ht.add(Number(p.id))})}),C.forEach(Pt=>{const p=Number(Pt.targetId??Pt.id),d=Number(Pt.count??0);if(!Number.isFinite(p))return;const n=Number($.value.id);let o=null;if(p===n?o="POST":at.has(p)?o="COMMENT":ht.has(p)&&(o="REPLY"),!o)return;const l=st(o,p),m=k.value[l]||{liked:!1,count:0};k.value[l]={liked:m.liked,count:d}})}catch(f){console.error("like count ë¡œë“œ ì‹¤íŒ¨",f)}}async function ct(x){const f=localStorage.getItem("token");if(f)try{const{data:C}=await j.get(`/like/detail/${x}`,{headers:{Authorization:`Bearer ${f}`}});(Array.isArray(C?.likes)?C.likes:[]).forEach(q=>{const at=q.targetType??q.target_type??q.type,ht=Number(q.targetId??q.target_id??q.id),Pt=!!(q.isOwner??q.owner??q.liked);if(!at||!ht)return;const p=st(at,ht),d=k.value[p]||{liked:!1,count:0};k.value[p]={liked:Pt,count:d.count}})}catch(C){console.error("like detail ë¡œë“œ ì‹¤íŒ¨",C)}}async function U(x){const{data:f}=await j.get("/comments",{params:{postId:x}});c.value=Array.isArray(f?.ok)&&f.ok||Array.isArray(f?.comments)&&f.comments||Array.isArray(f?.data?.comments)&&f.data.comments||[]}async function it(x){const{data:f}=await j.get("/replys",{params:{postId:x}}),B=(Array.isArray(f?.ok)&&f.ok||Array.isArray(f?.replies)&&f.replies||Array.isArray(f?.data)&&f.data||[]).reduce((q,at)=>{const ht=at.commentId??at.commentUID??at.comment_id;return ht&&(q[ht]||(q[ht]=[])).push({id:at.id,username:at.username,content:at.content,createdAt:at.createdAt,updatedAt:at.updatedAt??null,owner:at.owner,author:at.author}),q},{});y.value=B}async function gt(){if(L.value)return;if(!E.value.trim()){alert("ëŒ“ê¸€ ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”!");return}const x=localStorage.getItem("token");if(!x){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."),a.push("/login");return}L.value=!0;try{await j.post("/comment",{content:E.value,username:_.username,postId:$.value.id},{headers:{Authorization:`Bearer ${x}`}}),await new Promise(f=>setTimeout(f,500)),await U($.value.id),E.value=""}catch(f){console.error(f),alert("ëŒ“ê¸€ ì €ìž¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ")}finally{L.value=!1}}async function ft(x){if(!confirm("ëŒ“ê¸€ì„ ì‚­ì œí• ê¹Œìš”?"))return;const f=localStorage.getItem("token");if(!f){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."),a.push("/login");return}try{await j.delete(`/comment/${x.id}`,{headers:{Authorization:`Bearer ${f}`}}),c.value=c.value.filter(C=>C.id!==x.id),alert("ëŒ“ê¸€ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(C){console.error(C),alert("ì‚­ì œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ")}}function yt(x){N.value=x.id,et.value[x.id]=x.content}function At(){N.value!=null&&(et.value[N.value]=""),N.value=null}async function wt(x){const f=et.value[x]||"";if(!f.trim()){alert("ìˆ˜ì •í•  ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”.");return}const C=localStorage.getItem("token");if(!C){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."),a.push("/login");return}if(!ut.value){ut.value=!0;try{const{data:B}=await j.put(`/comment/${x}`,{content:f},{headers:{Authorization:`Bearer ${C}`}}),q=B?.comment??B??{};c.value=c.value.map(at=>at.id===x?{...at,content:q.content??f,modifiedAt:q.modifiedAt??q.updatedAt??at.modifiedAt}:at),N.value=null}catch(B){console.error(B),alert("ëŒ“ê¸€ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ ë°œìƒ")}finally{ut.value=!1}}}function Lt(x){T.value=T.value===x?null:x,O.value[x]=""}async function Ot(x){const f=O.value[x]||"";if(!F.value){a.push("/login");return}if(!f.trim()){alert("ë‹µê¸€ ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”.");return}if(D.value[x])return;D.value[x]=!0;const C=localStorage.getItem("token");try{await j.post("/reply",{commentId:x,postId:$.value.id,username:_.username,content:f},{headers:{Authorization:`Bearer ${C}`}}),await Promise.all([U($.value.id),it($.value.id)]),T.value=null,O.value[x]="",X.value++}catch(B){console.error(B),alert("ë‹µê¸€ ì €ìž¥ ì‹¤íŒ¨")}finally{D.value[x]=!1}}function Ut(x){ot.value[x.id]=x.content,mt.value[x.id]=!0}function zt(x){mt.value[x]=!1}async function xt(x){const f=(ot.value[x.id]||"").trim();if(!f){alert("ë‹µê¸€ ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”.");return}const C=localStorage.getItem("token");if(!C){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."),a.push("/login");return}try{const{data:B}=await j.put(`/reply/${x.id}`,{content:f},{headers:{Authorization:`Bearer ${C}`}}),q=B?.reply??{},at=Object.keys(y.value).find(ht=>y.value[ht].some(Pt=>Pt.id===x.id));at&&(y.value[at]=y.value[at].map(ht=>ht.id===x.id?{...ht,content:q.content??f,updatedAt:q.updatedAt??new Date().toISOString()}:ht)),mt.value[x.id]=!1}catch(B){console.error(B),alert("ë‹µê¸€ ìˆ˜ì • ì‹¤íŒ¨")}}async function Ft(x){if(!confirm("ë‹µê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))return;const f=localStorage.getItem("token");if(!f){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."),a.push("/login");return}try{await j.delete(`/reply/${x.id}`,{headers:{Authorization:`Bearer ${f}`}});const C=Object.keys(y.value).find(B=>y.value[B].some(q=>q.id===x.id));C&&(y.value[C]=y.value[C].filter(B=>B.id!==x.id))}catch(C){console.error(C),alert("ë‹µê¸€ ì‚­ì œ ì‹¤íŒ¨")}}async function St(x){w.value=!0,i.value="";try{const{data:f}=await j.get(`/notice/detail/${x}`),C=f.detail??f?.ok??{};$.value={id:C.id??null,title:C.title??"",description:C.description??"",username:C.username??"ê´€ë¦¬ìž",createdAt:C.createdAt??null,viewCount:C.viewCount??0,owner:C.owner??!1},vt("POST",$.value.id,0,f.isLiked??!1),await Promise.all([U($.value.id),it($.value.id)]),await z($.value.id),await ct($.value.id)}catch(f){console.error(f),i.value="ê³µì§€ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤."}finally{w.value=!1}}function Wt(){a.push({path:"/notice/update",query:{id:$.value.id}})}async function Ht(){if(confirm("ì •ë§ë¡œ ì´ ê³µì§€ì‚¬í•­ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))try{const x=localStorage.getItem("token");await j.delete(`/notice/${$.value.id}`,{headers:x?{Authorization:`Bearer ${x}`}:{}}),a.push("/notice")}catch(x){console.error(x),alert("ì‚­ì œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ")}}function Xt(){a.push("/notice")}return Dt(()=>St(r.value)),Qt(()=>r.value,(x,f)=>{x&&x!==f&&St(x)}),(x,f)=>(e(),s("section",Ao,[w.value?(e(),s("div",Po,f[3]||(f[3]=[t("i",{class:"bi bi-arrow-repeat fs-2 spin"},null,-1)]))):i.value?(e(),s("div",So,[H(v(i.value)+" ",1),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:Xt},"ëª©ë¡")])):(e(),s("div",Io,[Et.value?(e(),s("div",Lo,[t("div",{class:"dropdown d-none d-md-inline-block"},[f[6]||(f[6]=t("button",{class:"btn btn-outline-secondary btn-sm rounded-pill","data-bs-toggle":"dropdown"},[t("i",{class:"fas fa-ellipsis-v"})],-1)),t("ul",{class:"dropdown-menu dropdown-menu-end"},[t("li",null,[t("button",{type:"button",class:"dropdown-item",onClick:Wt},f[4]||(f[4]=[t("i",{class:"fas fa-edit me-2"},null,-1),H(" ìˆ˜ì • ")]))]),t("li",null,[t("button",{type:"button",class:"dropdown-item text-danger",onClick:Ht},f[5]||(f[5]=[t("i",{class:"fas fa-trash me-2"},null,-1),H(" ì‚­ì œ ")]))])])])])):P("",!0),t("div",To,[t("div",Eo,[t("div",Mo,[t("h2",Oo,v($.value.title),1)]),t("p",zo,[f[8]||(f[8]=t("span",{class:"badge bg-primary-subtle text-primary me-2"},"ê³µì§€ì‚¬í•­",-1)),t("strong",Ro,v($.value.username||"ê´€ë¦¬ìž"),1),f[9]||(f[9]=H(" Â· ")),t("span",No,v(K.value),1),f[10]||(f[10]=H(" Â· ")),t("span",null,[f[7]||(f[7]=t("i",{class:"bi bi-eye"},null,-1)),H(" "+v($.value.viewCount??0),1)])]),f[12]||(f[12]=t("hr",null,null,-1)),t("div",{class:"feed-content",innerHTML:M.value},null,8,Do),t("footer",jo,[t("div",Uo,[f[11]||(f[11]=t("i",{class:"bi bi-chat-dots me-1"},null,-1)),H(" ëŒ“ê¸€ "+v(c.value.length),1)]),t("button",{class:"btn btn-sm btn-outline-danger like-btn d-inline-flex align-items-center",onClick:f[0]||(f[0]=()=>R("POST",$.value.id))},[t("i",{class:lt([["bi",nt("POST",$.value.id)?"bi-heart-fill text-like":"bi-heart"],"me-1"])},null,2),t("span",null,v(pt("POST",$.value.id)),1)])])])])])),!w.value&&!i.value?(e(),s("section",Bo,[t("div",Fo,[t("h5",Vo,[f[13]||(f[13]=t("i",{class:"bi bi-chat"},null,-1)),f[14]||(f[14]=H(" ëŒ“ê¸€ ")),t("span",Wo,"("+v(c.value.length)+")",1)])]),c.value.length===0?(e(),s("div",Ho," ì•„ì§ ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ ëŒ“ê¸€ì„ ë‚¨ê²¨ë³´ì„¸ìš”. ")):P("",!0),(e(!0),s(Y,null,dt(c.value,C=>(e(),s("div",{key:C.id+"-"+X.value,class:"comment-item d-flex"},[t("div",qo,[t("div",Yo,[t("div",Xo,[rt(kt(Bt),{to:`/user/profile/${C.username}`,class:"comment-author text-decoration-none"},{default:Mt(()=>[t("span",Ko,v(b(C.username)),1),t("span",Qo,v(C.username),1),C.author?(e(),s("span",Go,"ê¸€ì“´ì´")):P("",!0),C.owner?(e(),s("span",Jo,"ìž‘ì„±ìž")):P("",!0)]),_:2},1032,["to"]),t("small",Zo,[C.updatedAt?(e(),s(Y,{key:0},[H(" (ìˆ˜ì •ë¨ Â· "+v(V(C.updatedAt))+") ",1)],64)):(e(),s(Y,{key:1},[H(v(V(C.createdAt)),1)],64))])]),t("div",ta,[C.owner?(e(),s("button",{key:0,class:"btn btn-sm btn-link text-secondary p-0",onClick:B=>yt(C)}," ìˆ˜ì • ",8,ea)):P("",!0),C.owner?(e(),s("button",{key:1,class:"btn btn-sm btn-link text-danger p-0",onClick:B=>ft(C)},"ì‚­ì œ ",8,sa)):P("",!0),t("button",{class:"btn btn-sm btn-link text-danger p-0 d-inline-flex align-items-center",onClick:()=>R("COMMENT",C.id)},[t("i",{class:lt([["bi",nt("COMMENT",C.id)?"bi-heart-fill text-like":"bi-heart"],"me-1"])},null,2),t("span",oa,v(pt("COMMENT",C.id)),1)],8,na)])]),t("div",{class:"mt-1 comment-content",innerHTML:J(C.content)},null,8,aa),N.value===C.id?(e(),s("div",la,[tt(t("textarea",{"onUpdate:modelValue":B=>et.value[C.id]=B,rows:"2",class:"form-control mb-2",placeholder:"ìˆ˜ì •í•  ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”."},null,8,ia),[[$t,et.value[C.id]]]),t("div",ra,[t("button",{class:"btn btn-sm btn-primary",disabled:ut.value,onClick:B=>wt(C.id)},"ìˆ˜ì • ì™„ë£Œ ",8,ua),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:At}," ì·¨ì†Œ ")])])):P("",!0),y.value&&y.value[C.id]?(e(),s("div",ca,[(e(!0),s(Y,null,dt(y.value[C.id],B=>(e(),s("div",{key:B.id,class:"reply-item"},[t("div",da,[t("div",ma,[rt(kt(Bt),{to:`/user/profile/${B.username}`,class:"comment-author text-decoration-none"},{default:Mt(()=>[t("span",va,v(b(B.username)),1),t("span",pa,v(B.username),1),B.author?(e(),s("span",fa,"ê¸€ì“´ì´")):P("",!0),B.owner?(e(),s("span",ba,"ìž‘ì„±ìž")):P("",!0)]),_:2},1032,["to"]),t("small",ga,[B.updatedAt?(e(),s(Y,{key:0},[H(" (ìˆ˜ì •ë¨ Â· "+v(V(B.updatedAt))+") ",1)],64)):(e(),s(Y,{key:1},[H(v(V(B.createdAt)),1)],64))])]),t("div",ha,[B.owner?(e(),s("button",{key:0,class:"btn btn-link btn-sm text-secondary p-0 me-2",onClick:q=>Ut(B)}," ìˆ˜ì • ",8,ya)):P("",!0),B.owner?(e(),s("button",{key:1,class:"btn btn-link btn-sm text-danger p-0",onClick:q=>Ft(B)}," ì‚­ì œ ",8,ka)):P("",!0),t("button",{class:"btn btn-link btn-sm text-danger p-0 d-inline-flex align-items-center",onClick:()=>R("REPLY",B.id)},[t("i",{class:lt([["bi",nt("REPLY",B.id)?"bi-heart-fill  text-like":"bi-heart"],"me-1"])},null,2),t("span",$a,v(pt("REPLY",B.id)),1)],8,_a)])]),mt.value[B.id]?(e(),s("div",wa,[tt(t("textarea",{"onUpdate:modelValue":q=>ot.value[B.id]=q,rows:"2",class:"form-control mb-2"},null,8,xa),[[$t,ot.value[B.id]]]),t("div",Ca,[t("button",{class:"btn btn-sm btn-primary",onClick:q=>xt(B)}," ì €ìž¥ ",8,Aa),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:q=>zt(B.id)}," ì·¨ì†Œ ",8,Pa)])])):(e(),s("div",Sa,v(B.content),1))]))),128))])):P("",!0),t("button",{class:"btn btn-sm btn-outline-primary mt-2",onClick:B=>Lt(C.id)}," ë‹µê¸€ ë‹¬ê¸° ",8,Ia),tt(t("div",La,[tt(t("textarea",{"onUpdate:modelValue":B=>O.value[C.id]=B,rows:"2",class:"form-control mb-2",placeholder:"ë‹µê¸€ ìž…ë ¥"},null,8,Ta),[[$t,O.value[C.id]]]),t("button",{class:"btn btn-sm btn-primary",onClick:B=>Ot(C.id),disabled:D.value[C.id]}," ë‹µê¸€ ìž‘ì„± ",8,Ea)],512),[[Rt,T.value===C.id]])])]))),128))])):P("",!0),!w.value&&!i.value?(e(),s("section",Ma,[t("div",Oa,[f[15]||(f[15]=t("h6",{class:"mb-0"},[t("i",{class:"bi bi-pencil-square me-1"}),H(" ëŒ“ê¸€ ì“°ê¸° ")],-1)),F.value?P("",!0):(e(),s("button",{key:0,class:"btn btn-sm btn-outline-secondary",onClick:f[1]||(f[1]=C=>kt(a).push("/login"))},"ë¡œê·¸ì¸ "))]),tt(t("textarea",{"onUpdate:modelValue":f[2]||(f[2]=C=>E.value=C),rows:"3",class:"form-control mb-2",placeholder:F.value?"ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”.":"ë¡œê·¸ì¸ í›„ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤."},null,8,za),[[$t,E.value]]),t("div",Ra,[t("button",{class:"btn btn-success px-4",disabled:!F.value||L.value||!E.value.trim(),onClick:gt}," ìž‘ì„±í•˜ê¸° ",8,Na)])])):P("",!0)]))}},ja=Ct(Da,[["__scopeId","data-v-f8c01027"]]),Du=Object.freeze(Object.defineProperty({__proto__:null,default:ja},Symbol.toStringTag,{value:"Module"}));function de(g){if(!g)return"";const A=new DOMParser().parseFromString(g,"text/html");return A.querySelectorAll("br").forEach(a=>a.replaceWith(`
`)),A.querySelectorAll("p").forEach(a=>{a.replaceWith(a.textContent+`

`)}),(A.body.textContent||"").replace(/\u00A0/g," ").replace(/\n{3,}/g,`

`).trim()}function Ua(g){return g?g.split(/\n{2,}/).map(a=>a.trim()).filter(Boolean).map(a=>`<p>${Ba(a).replace(/\n/g,"<br>")}</p>`).join(""):""}function Ba(g){return g.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}const Fa={class:"container py-5",style:{"max-width":"880px"}},Va={key:0,class:"alert alert-danger"},Wa={key:1,class:"text-center py-5"},Ha={class:"card shadow-sm mb-4"},qa={class:"card-body"},Ya={class:"mb-3"},Xa=["innerHTML"],Ka={class:"card shadow-sm"},Qa={class:"card-body"},Ga={class:"form-floating mb-3"},Ja={class:"form-floating mb-4"},Za={class:"d-flex gap-2"},tl=["disabled"],el={key:0,class:"spinner-border spinner-border-sm me-2"},sl={__name:"FeedUpdate",setup(g){const A=Yt(),a=jt(),_=A.query.id,w=u(""),i=u(""),$=u(""),r=u(""),c=u(!1),y=u(!0),k=u("");Dt(async()=>{try{const{data:E}=await j.get(`/post/${_}`);w.value=E.ok.post.title??"",i.value=E.ok.post.description??"",$.value=w.value,r.value=de(i.value)}catch(E){console.error(E),k.value="ê²Œì‹œê¸€ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤."}finally{y.value=!1}});async function T(){if(!$.value.trim()||!r.value.trim()){k.value="ì œëª©ê³¼ ë‚´ìš©ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”.";return}c.value=!0,k.value="";try{const E=localStorage.getItem("token");await j.put(`/post/${_}`,{id:_,title:$.value,description:Ua(r.value)},{headers:{Authorization:`Bearer ${E}`}}),a.push(`/post/${_}`)}catch(E){console.error(E),k.value="ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."}finally{c.value=!1}}function O(){$.value=w.value,r.value=de(i.value)}function D(){a.back()}return(E,L)=>(e(),s("div",Fa,[L[9]||(L[9]=t("h2",{class:"fw-bold mb-4 text-center"},"ê²Œì‹œê¸€ ìˆ˜ì •",-1)),k.value?(e(),s("div",Va,v(k.value),1)):P("",!0),y.value?(e(),s("div",Wa,L[2]||(L[2]=[t("div",{class:"spinner-border"},null,-1)]))):(e(),s(Y,{key:2},[t("div",Ha,[t("div",{class:"card-header d-flex justify-content-between align-items-center"},[L[3]||(L[3]=t("strong",null,"í˜„ìž¬ ê²Œì‹œê¸€",-1)),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:D},"ì´ì „ìœ¼ë¡œ")]),t("div",qa,[t("h4",Ya,v(w.value||"ì œëª© ì—†ìŒ"),1),L[4]||(L[4]=t("div",{class:"text-muted small mb-2"},"í˜„ìž¬ ê²Œì‹œê¸€ ë‚´ìš©",-1)),t("div",{class:"preview-content",innerHTML:i.value||"<em>ë‚´ìš© ì—†ìŒ</em>"},null,8,Xa)])]),L[8]||(L[8]=t("div",{class:"text-center my-3"},[t("span",{class:"badge rounded-pill text-bg-light"},"ì•„ëž˜ì—ì„œ ìˆ˜ì •")],-1)),t("div",Ka,[t("div",Qa,[t("div",Ga,[tt(t("input",{"onUpdate:modelValue":L[0]||(L[0]=X=>$.value=X),type:"text",class:"form-control",id:"titleInput",placeholder:"ì œëª©"},null,512),[[$t,$.value]]),L[5]||(L[5]=t("label",{for:"titleInput"},"ìˆ˜ì •í•  ì œëª©",-1))]),t("div",Ja,[tt(t("textarea",{"onUpdate:modelValue":L[1]||(L[1]=X=>r.value=X),class:"form-control",id:"descInput",placeholder:"ë‚´ìš© ìž…ë ¥",style:{height:"240px"}},null,512),[[$t,r.value]]),L[6]||(L[6]=t("label",{for:"descInput"},"ìˆ˜ì •í•  ë‚´ìš©",-1))]),t("div",Za,[t("button",{class:"btn btn-outline-secondary",type:"button",onClick:O}," í˜„ìž¬ ë‚´ìš©ìœ¼ë¡œ ë˜ëŒë¦¬ê¸° "),t("button",{class:"btn btn-primary ms-auto",disabled:c.value,onClick:T},[c.value?(e(),s("span",el)):P("",!0),L[7]||(L[7]=H(" ìˆ˜ì • ì™„ë£Œ "))],8,tl)])])])],64))]))}},nl=Ct(sl,[["__scopeId","data-v-41cf7b90"]]),ju=Object.freeze(Object.defineProperty({__proto__:null,default:nl},Symbol.toStringTag,{value:"Module"})),ol={class:"container-xl py-5"},al={class:"d-flex align-items-center gap-3 mb-3"},ll={class:"form-check form-switch m-0"},il={class:"row g-2 mb-3"},rl={class:"col-auto"},ul={class:"col"},cl={class:"editor-wrapper mb-3"},dl={class:"editor-toolbar"},ml={key:0,class:"editor-placeholder"},vl={key:0,class:"thumb-tray mb-2"},pl={class:"tray-head"},fl={class:"thumbs"},bl=["src","alt"],gl=["onClick"],hl=["onClick"],yl=["disabled"],kl={key:0},_l={key:1},Jt=3,$l={__name:"FeedForm",setup(g){const A=jt(),a=u(!1),_=u(""),w=u(""),i=u(""),$=ee(),r=u([]);function c(h){alert(h)}const y=["ìžìœ ","ìžê²©ì¦","ë¬¸ì œ","ê¸°ìˆ ","ì·¨ì—…","Q/A","ìžë£Œ","ê³ ë¯¼"],k=u(!0),T=u(null),O=u(!1),D=h=>{if(h==="link"){const b=prompt("URL ìž…ë ¥");b&&document.execCommand("createLink",!1,b)}else document.execCommand(h,!1,null)},E=()=>k.value=!T.value?.innerText.trim(),L=()=>E();async function X(h){const b=h.target?.files?Array.from(h.target.files):Array.from(h),S=Jt-r.value.length;if(S<=0){c(`ì´ë¯¸ì§€ëŠ” ìµœëŒ€ ${Jt}ìž¥ê¹Œì§€ ì—…ë¡œë“œí•  ìˆ˜ ìžˆì–´ìš”.`),et();return}const V=b.slice(0,S);b.length>S&&c(`ìµœëŒ€ ${Jt}ìž¥ê¹Œì§€ ê°€ëŠ¥: ${S}ìž¥ë§Œ ì¶”ê°€ë©ë‹ˆë‹¤.`);for(const J of V){if(!J.type.startsWith("image/"))continue;const st=crypto.randomUUID(),vt=URL.createObjectURL(J),nt=new Image;await new Promise(pt=>{nt.onload=pt,nt.src=vt}),r.value.push({id:st,file:J,url:vt,width:480,height:Math.round(480*(nt.naturalHeight/nt.naturalWidth)),ratio:nt.naturalWidth/nt.naturalHeight})}et()}function N(h){const b=window.getSelection();T.value?.appendChild(h);const S=document.createElement("br");if(T.value?.appendChild(S),b){const V=document.createRange();V.setStartAfter(h),V.collapse(!0),b.removeAllRanges(),b.addRange(V)}}function et(){imageInput.value&&(imageInput.value.value="")}function ut(h){const b=T.value?.querySelector(`.image-wrapper[data-id="${h}"]`);b&&b.remove();const S=r.value.findIndex(V=>V.id===h);S>=0&&(URL.revokeObjectURL(r.value[S].url),r.value.splice(S,1))}function ot(h){X(h)}function mt(){const h=T.value;if(!h)return 720;const b=h.getBoundingClientRect();return Math.max(320,Math.min(720,Math.round(b.width-28)))}let bt;Dt(async()=>{bt=()=>_t(),window.addEventListener("resize",bt),await ae(),_t()}),ve(()=>{window.removeEventListener("resize",bt)});function _t(){const h=mt();T.value?.querySelectorAll(".image-wrapper").forEach(b=>{const S=b.querySelector("img");if(!S)return;let V=b.clientWidth;if(V>h){V=h;const J=parseInt(S.getAttribute("width")),st=parseInt(S.getAttribute("height")),vt=J&&st?J/st:S.naturalWidth&&S.naturalHeight?S.naturalWidth/S.naturalHeight:1,nt=Math.round(V/(vt||1));b.style.width=V+"px",b.style.height=nt+"px",S.style.width=V+"px",S.style.height=nt+"px";const pt=b.dataset.id,R=r.value.find(z=>z.id===pt);R&&(R.width=V,R.height=nt)}})}function Q(h){const b=document.createElement("div");b.className="image-wrapper",b.dataset.id=h.id,b.contentEditable="false";const V=mt(),J=Math.round(V/(h.ratio||1));Object.assign(b.style,{position:"relative",maxWidth:"100%",resize:"both",overflow:"auto",width:V+"px",height:J+"px"});const st=document.createElement("img");st.src=h.url,st.draggable=!1,Object.assign(st.style,{width:V+"px",height:J+"px",display:"block",maxWidth:"100%"});const vt=document.createElement("button");vt.type="button",vt.className="img-del",vt.textContent="Ã—",vt.onclick=R=>{R.stopPropagation(),ut(h.id)};const nt=document.createElement("div");nt.className="resize-handle resize-handle-left";const pt=document.createElement("div");pt.className="resize-handle resize-handle-right",b.append(st,vt,nt,pt),M(b,st,h),N(b),T.value?.focus()}function M(h,b,S){let V=!1,J,st;h.querySelectorAll(".resize-handle").forEach(nt=>{nt.addEventListener("mousedown",pt=>{pt.stopPropagation(),V=!0,J=pt.clientX,st=h.clientWidth;const R=getComputedStyle(h).transform,ct=new DOMMatrixReadOnly(R).m41,U=gt=>{if(!V)return;gt.preventDefault();let ft=gt.clientX-J,yt=st+ft;nt.classList.contains("resize-handle-left")&&(yt=st-ft);const At=mt(),wt=Math.max(240,Math.min(yt,At));if(nt.classList.contains("resize-handle-left")){const Ot=st-wt;h.style.transform=`translateX(${ct+Ot/2}px)`}else if(nt.classList.contains("resize-handle-right")){const Ot=wt-st;h.style.transform=`translateX(${ct+Ot/2}px)`}const Lt=Math.round(wt/(S.ratio||1));h.style.width=wt+"px",h.style.height=Lt+"px",b.style.width=wt+"px",b.style.height=Lt+"px",S.width=wt,S.height=Lt},it=()=>{V=!1,window.removeEventListener("mousemove",U),window.removeEventListener("mouseup",it)};window.addEventListener("mousemove",U),window.addEventListener("mouseup",it)})}),new ResizeObserver(()=>{const nt=mt(),pt=h.clientWidth,R=Math.max(240,Math.min(pt,nt)),z=Math.round(R/(S.ratio||1));h.style.width=R+"px",h.style.height=z+"px",b.style.width=R+"px",b.style.height=z+"px",S.width=R,S.height=z;const ct=parseFloat(getComputedStyle(h).marginLeft),U=h.parentNode?h.parentNode.clientWidth:nt;if(U&&h.clientWidth<U){const it=(U-h.clientWidth)/2;h.style.transform=`translateX(${it-ct}px)`}else h.style.transform="none"}).observe(h)}async function K(){const h={};await Promise.all(r.value.map(async S=>{const V=new FormData;V.append("file",S.file),V.append("width",S.width||0),V.append("height",S.height||0);try{const J=await fetch("/api/upload-images",{method:"POST",body:V}),{url:st}=await J.json();h[S.id]=st}catch(J){console.error("ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹¤íŒ¨",J)}}));const b=T.value.cloneNode(!0);return b.querySelectorAll(".image-wrapper").forEach(S=>{const V=S.querySelector("img"),J=S.dataset.id,st=h[J];if(!V||!J||!st){S.remove();return}const vt=Math.round(V.clientWidth||parseInt(V.style.width)||V.naturalWidth||0),nt=r.value.find(z=>z.id===J)?.ratio||(V.naturalWidth?V.naturalWidth/(V.naturalHeight||1):0),pt=vt&&nt?Math.round(vt/nt):V.naturalHeight||0,R=document.createElement("img");R.src=st,vt&&R.setAttribute("width",vt),pt&&R.setAttribute("height",pt),R.setAttribute("loading","lazy"),R.style.maxWidth="100%",R.style.display="block",R.style.margin="0 auto",S.replaceWith(R)}),b.innerHTML}async function F(){if(!O.value){O.value=!0;try{if(!w.value||!i.value||T.value.innerText.trim()===""){alert("í•„ìˆ˜ í•­ëª©ì„ ìž…ë ¥í•˜ì„¸ìš”");return}const h=await K();console.log(`[DEBUG] HTML to send:
`,h);const b=new Blob([JSON.stringify({title:i.value,category:w.value,description:h,username:$.username})],{type:"application/json"}),S=new FormData;S.append("feed",b);const V=localStorage.getItem("token"),J=await fetch("/api/post",{method:"POST",body:S,headers:{Authorization:`Bearer ${V}`}});if(!J.ok){const vt=await J.json();if(J.status===401&&vt.code==="INVALID_TOKEN"){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤!"),A.push("/login");return}else throw new Error(vt.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ ë°œìƒ")}alert("ìž‘ì„± ì™„ë£Œ");const st=await J.json();A.push("/")}catch(h){console.error(h),alert("ìž‘ì„± ì‹¤íŒ¨: "+h.message)}finally{O.value=!1}}}function Et(){A.push("/search/view/feed/vote")}return Dt(async()=>{const h=localStorage.getItem("token");if(!h)return;const S=await(await fetch("/api/auth/status",{headers:{Authorization:`Bearer ${h}`}})).json();S.isLoggedIn&&!a.value&&(_.value=S.username)}),(h,b)=>(e(),s("div",ol,[t("form",{onSubmit:Nt(F,["prevent"]),class:"mx-auto write-card shadow-sm"},[t("header",{class:"d-flex justify-content-between align-items-center mb-4"},[b[11]||(b[11]=t("h3",{class:"m-0 fw-bold"},"ìƒˆ ê¸€ ìž‘ì„±",-1)),t("button",{class:"btn btn-outline-primary btn-sm",type:"button",onClick:Et}," ðŸ—³ï¸ íˆ¬í‘œ ìž‘ì„± ")]),t("div",al,[t("div",ll,[tt(t("input",{id:"anonymous",class:"form-check-input",type:"checkbox","onUpdate:modelValue":b[0]||(b[0]=S=>a.value=S)},null,512),[[ne,a.value]]),b[12]||(b[12]=t("label",{class:"form-check-label small",for:"anonymous"},"ìµëª…",-1))]),a.value?tt((e(),s("input",{key:0,"onUpdate:modelValue":b[1]||(b[1]=S=>_.value=S),class:"form-control flex-grow-1",placeholder:"ìµëª… ë‹‰ë„¤ìž„"},null,512)),[[$t,_.value]]):P("",!0)]),t("div",il,[t("div",rl,[tt(t("select",{"onUpdate:modelValue":b[2]||(b[2]=S=>w.value=S),class:"form-select category-pill",required:""},[b[13]||(b[13]=t("option",{disabled:"",value:""},"ì¹´í…Œê³ ë¦¬",-1)),(e(),s(Y,null,dt(y,S=>t("option",{key:S},v(S),1)),64))],512),[[$e,w.value]])]),t("div",ul,[tt(t("input",{"onUpdate:modelValue":b[3]||(b[3]=S=>i.value=S),class:"form-control fs-5 fw-semibold",placeholder:"ì œëª©ì„ ìž…ë ¥í•˜ì„¸ìš”",required:""},null,512),[[$t,i.value]])])]),t("div",cl,[t("div",dl,[t("button",{type:"button",onClick:b[4]||(b[4]=S=>D("bold"))},b[14]||(b[14]=[t("i",{class:"bi bi-type-bold"},null,-1)])),t("button",{type:"button",onClick:b[5]||(b[5]=S=>D("link"))},b[15]||(b[15]=[t("i",{class:"bi bi-link-45deg"},null,-1)])),t("button",{type:"button",onClick:b[6]||(b[6]=S=>D("code"))},b[16]||(b[16]=[t("i",{class:"bi bi-code-slash"},null,-1)]))]),t("div",{ref_key:"editor",ref:T,class:"content-editor",contenteditable:"",onInput:L,onFocus:b[7]||(b[7]=S=>k.value=!1),onBlur:E},null,544),k.value?(e(),s("p",ml,"ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”â€¦")):P("",!0)]),r.value.length?(e(),s("div",vl,[t("div",pl,[t("span",null,"ì´ë¯¸ì§€ "+v(r.value.length)+"/"+v(Jt),1)]),t("div",fl,[(e(!0),s(Y,null,dt(r.value,S=>(e(),s("div",{class:"thumb",key:S.id},[t("img",{src:S.url,alt:S.file?.name||"preview"},null,8,bl),t("button",{type:"button",class:"thumb-del",onClick:V=>ut(S.id)},"Ã—",8,gl),t("button",{type:"button",class:"thumb-insert",onClick:Nt(V=>Q(S),["stop"])},"ì‚½ìž…",8,hl)]))),128))])])):P("",!0),t("div",{class:"upload-dropzone mb-4",onDragover:b[8]||(b[8]=Nt(()=>{},["prevent"])),onDrop:b[9]||(b[9]=Nt(S=>ot(S.dataTransfer.files),["prevent"])),onClick:b[10]||(b[10]=S=>h.$refs.imageInput.click())},[t("input",{ref:"imageInput",type:"file",accept:"image/*",multiple:"",class:"d-none",onChange:X},null,544),b[17]||(b[17]=t("p",{class:"m-0 text-muted small"},"í´ë¦­ ë˜ëŠ” ë“œëž˜ê·¸í•˜ì—¬ ì´ë¯¸ì§€ ì—…ë¡œë“œ",-1))],32),t("button",{class:"btn btn-success w-100 py-2 fs-6",disabled:O.value},[O.value?(e(),s("span",kl,b[18]||(b[18]=[t("i",{class:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"},null,-1),H(" ìž‘ì„± ì¤‘... ")]))):(e(),s("span",_l,b[19]||(b[19]=[t("i",{class:"bi bi-pencil-square me-1"},null,-1),H(" ìž‘ì„±í•˜ê¸° ")])))],8,yl)],32)]))}},wl=Ct($l,[["__scopeId","data-v-7720d4ca"]]),Uu=Object.freeze(Object.defineProperty({__proto__:null,default:wl},Symbol.toStringTag,{value:"Module"})),xl={class:"container my-5"},Cl={class:"form-container"},Al={class:"mb-3"},Pl={class:"mb-3"},Sl={class:"row mb-3"},Il={class:"col-auto form-check"},Ll={class:"col-auto form-check"},Tl={key:0,class:"col-auto"},El=["onUpdate:modelValue","placeholder"],Ml=["onClick"],Ol={__name:"VoteForm",setup(g){const A=jt(),a=u({category:"",title:"",description:"",multiSelect:!1,maxSelectCnt:null,anonymous:!1,options:[{content:""}]});function _(){a.value.options.length<5?a.value.options.push({content:""}):alert("íˆ¬í‘œ í•­ëª©ì€ ìµœëŒ€ 5ê°œê¹Œì§€ ì¶”ê°€í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.")}function w($){a.value.options.length>1?a.value.options.splice($,1):alert("ìµœì†Œí•œ í•˜ë‚˜ì˜ íˆ¬í‘œ í•­ëª©ì€ ìžˆì–´ì•¼ í•©ë‹ˆë‹¤.")}async function i(){const $=localStorage.getItem("token");if(!$){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");return}const r={title:a.value.title,description:a.value.description,multiSelect:a.value.multiSelect,maxSelectCnt:a.value.multiSelect?a.value.maxSelectCnt:null,anonymous:a.value.anonymous,options:a.value.options.map((c,y)=>({content:c.content,sortOrder:y})),closesAt:null};try{const c=await fetch("/api/poll",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${$}`},body:JSON.stringify(r)}),y=await c.json();c.ok?(alert("íˆ¬í‘œê°€ ì„±ê³µì ìœ¼ë¡œ ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤!"),A.push("/")):alert(y.error||"íˆ¬í‘œ ì €ìž¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}catch(c){console.error("íˆ¬í‘œ ì €ìž¥ ì˜¤ë¥˜:",c),alert("ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}return($,r)=>(e(),s("div",xl,[t("div",Cl,[r[9]||(r[9]=t("h4",{class:"mb-3 fw-bold"},"íˆ¬í‘œ ìž‘ì„±",-1)),t("form",{onSubmit:Nt(i,["prevent"])},[t("div",Al,[tt(t("input",{"onUpdate:modelValue":r[0]||(r[0]=c=>a.value.title=c),type:"text",class:"form-control",placeholder:"ì œëª©ì„ ìž…ë ¥í•´ ì£¼ì„¸ìš”.",required:""},null,512),[[$t,a.value.title]])]),t("div",Pl,[tt(t("textarea",{"onUpdate:modelValue":r[1]||(r[1]=c=>a.value.description=c),class:"form-control",rows:"5",placeholder:"ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”.",required:""},null,512),[[$t,a.value.description]])]),t("div",Sl,[t("div",Il,[tt(t("input",{id:"multiSelect","onUpdate:modelValue":r[2]||(r[2]=c=>a.value.multiSelect=c),type:"checkbox",class:"form-check-input"},null,512),[[ne,a.value.multiSelect]]),r[5]||(r[5]=t("label",{for:"multiSelect",class:"form-check-label"},"ë³µìˆ˜ ì„ íƒ í—ˆìš©",-1))]),t("div",Ll,[tt(t("input",{id:"anonymous","onUpdate:modelValue":r[3]||(r[3]=c=>a.value.anonymous=c),type:"checkbox",class:"form-check-input"},null,512),[[ne,a.value.anonymous]]),r[6]||(r[6]=t("label",{for:"anonymous",class:"form-check-label"},"ìµëª… íˆ¬í‘œ",-1))]),a.value.multiSelect?(e(),s("div",Tl,[tt(t("input",{"onUpdate:modelValue":r[4]||(r[4]=c=>a.value.maxSelectCnt=c),type:"number",min:"1",class:"form-control",placeholder:"ìµœëŒ€ ì„ íƒ ìˆ˜"},null,512),[[$t,a.value.maxSelectCnt,void 0,{number:!0}]])])):P("",!0)]),r[7]||(r[7]=t("label",{class:"fw-bold mb-2"},"íˆ¬í‘œ í•­ëª© (ìµœëŒ€ 5ê°œ)",-1)),(e(!0),s(Y,null,dt(a.value.options,(c,y)=>(e(),s("div",{key:y,class:"input-group mb-2"},[tt(t("input",{"onUpdate:modelValue":k=>c.content=k,type:"text",class:"form-control",placeholder:`íˆ¬í‘œ í•­ëª© ${y+1}`,required:""},null,8,El),[[$t,c.content]]),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:k=>w(y)}," X ",8,Ml)]))),128)),t("button",{type:"button",class:"btn btn-outline-secondary btn-sm mb-3",onClick:_}," + í•­ëª© ì¶”ê°€ "),r[8]||(r[8]=t("div",{class:"text-start"},[t("button",{type:"submit",class:"btn btn-success"},"ìž‘ì„±í•˜ê¸°")],-1))],32)])]))}},zl=Ct(Ol,[["__scopeId","data-v-0ad9d923"]]),Bu=Object.freeze(Object.defineProperty({__proto__:null,default:zl},Symbol.toStringTag,{value:"Module"})),Rl={class:"poll-page container my-4"},Nl={class:"poll-card mb-5"},Dl={key:0},jl={class:"poll-title mb-2",id:"poll-title"},Ul={class:"text-muted mb-3 d-flex align-items-center flex-wrap gap-2"},Bl={key:0,class:"d-inline-flex align-items-center"},Fl={key:0,class:"mb-3",style:{"white-space":"pre-wrap"}},Vl={class:"fw-bold d-flex align-items-center gap-2"},Wl={key:0,class:"text-muted"},Hl=["onClick"],ql={class:"d-inline-flex align-items-center gap-2"},Yl={class:"poll-bar-wrapper mt-1"},Xl={class:"poll-bar-text"},Kl={key:1,class:"text-danger small mt-2"},Ql={class:"d-flex justify-content-between align-items-center mt-4"},Gl={class:"text-muted"},Jl={class:"text-end"},Zl=["disabled"],ti={key:1,class:"text-muted small mt-2 mb-0"},ei={class:"post-actions d-flex justify-content-between align-items-center mt-3"},si={class:"text-muted small"},ni={key:1,class:"text-center py-5"},oi={class:"comments-section mt-4"},ai={class:"d-flex justify-content-between align-items-center mb-2"},li={class:"mb-0"},ii={class:"text-muted small"},ri={key:0,class:"text-muted py-3 small"},ui={class:"comment-avatar d-none d-sm-flex"},ci={class:"comment-body flex-grow-1"},di={class:"d-flex justify-content-between align-items-start"},mi={class:"comment-meta"},vi={class:"badge-rank me-1"},pi={class:"fw-semibold"},fi={key:0,class:"badge-author ms-1"},bi={key:1,class:"badge-author ms-1"},gi={class:"ms-2 text-muted"},hi={class:"ms-2 d-flex align-items-center gap-2"},yi=["onClick"],ki=["onClick"],_i=["onClick"],$i={class:"small"},wi=["innerHTML"],xi={key:0,class:"mt-2"},Ci=["onUpdate:modelValue"],Ai={class:"d-flex gap-2"},Pi=["disabled","onClick"],Si={key:1,class:"mt-2 reply-list"},Ii={class:"d-flex justify-content-between align-items-start"},Li={class:"reply-meta"},Ti={class:"badge-rank me-1"},Ei={class:"fw-semibold"},Mi={key:0,class:"badge-author ms-1"},Oi={key:1,class:"badge-author ms-1"},zi={class:"text-muted ms-2"},Ri={class:"ms-2 d-flex align-items-center gap-2 small"},Ni=["onClick"],Di=["onClick"],ji=["onClick"],Ui={class:"small"},Bi={key:0,class:"mt-2"},Fi=["onUpdate:modelValue"],Vi={class:"d-flex gap-2"},Wi=["onClick"],Hi=["onClick"],qi={key:1,class:"reply-content"},Yi=["onClick"],Xi={class:"mt-2"},Ki=["onUpdate:modelValue"],Qi=["onClick","disabled"],Gi={class:"card shadow-sm p-3 mt-4 comment-write-card"},Ji={class:"d-flex justify-content-between align-items-center mb-2"},Zi=["placeholder"],tr={class:"text-end"},er=["disabled"],sr={__name:"PollDetail",setup(g){const A=Yt(),a=jt(),_=ee(),w=pe(),i=u(null),$=u({}),r=["#5AC8FA","#FF9F40","#4CD964","#FF5E7E","#AF7CFF","#FFD460"],c=u(0),y=u(!1),k=u([]),T=u([]),O=u({}),D=u(""),E=u(!1),L=u(null),X=u({}),N=u({}),et=u({}),ut=u({}),ot=u({}),mt=u(0),bt=u(null),_t=u({}),Q=u(!1),M=u(null),K=u(!1),F=u(""),Et=JSON.parse(localStorage.getItem("topWriters")||"{}"),h=G(()=>i.value?.postId??null),b=G(()=>_.isLoggedIn),S=G(()=>!!i.value?.multiSelect),V=G(()=>Number(i.value?.maxSelectCnt)||1),J=u(new Set),st=G(()=>J.value.size),vt=G(()=>S.value?st.value>0&&st.value<=V.value:st.value===1);function nt(n){const o=Et[n]||0;return o===1?"ðŸ‘‘":o===2?"ðŸ¥‡":o===3?"ðŸ¥ˆ":o>0&&o<=5?"ðŸ¥‰":""}const pt=G(()=>i.value?nt(i.value.username):"");function R(n){if(!n)return"";const o=new Date(n),l=o.getMonth()+1,m=o.getDate();let I=o.getHours();const W=o.getMinutes(),Z=I>=12?"ì˜¤í›„":"ì˜¤ì „";return I=I%12||12,`${l}. ${m}. ${Z} ${I}:${W.toString().padStart(2,"0")}`}function z(n=""){const o=/(https?:\/\/[^\s]+)/g;return n.replace(o,l=>`<a href="${l}" target="_blank">${l}</a>`)}function ct(n){return c.value?Math.round(n/c.value*100):0}const U=n=>k.value?.[n],it=n=>n?J.value.has(n):!1;function gt(n){const o=n?.optionId;if(o){if(F.value="",!S.value||V.value<=1){J.value=new Set([o]);return}if(J.value.has(o))J.value.delete(o);else{if(J.value.size>=V.value){F.value=`ìµœëŒ€ ${V.value}ê°œê¹Œì§€ ì„ íƒí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.`;return}J.value.add(o)}}}const ft=(n,o)=>`${n}-${o}`;function yt(n,o,l=0,m=!1){const I=ft(n,o);ot.value[I]||(ot.value[I]={liked:m,count:l})}function At(n,o){const l=ft(n,o);return ot.value[l]?.liked??!1}function wt(n,o){const l=ft(n,o);return ot.value[l]?.count??0}Dt(async()=>{const n=localStorage.getItem("token");y.value=!!n||_.isLoggedIn;const o=A.params.id||A.query.id;let l=w.getByPostId(o);if(!l)try{const{data:W}=await j.get(`/post/${o}`),Z=W?.ok??{},It=Z.post,Tt=Z.poll;if(!It||!Tt){console.error("post/poll ë°ì´í„° ì—†ìŒ",Z);return}l={post:It,poll:Tt}}catch(W){console.error("íˆ¬í‘œ ìƒì„¸ ë¡œë“œ ì‹¤íŒ¨",W);return}const{post:m,poll:I}=l;Lt(m,I),n&&M.value&&await Ot(n),h.value&&await Promise.all([zt(h.value),Xt(h.value),Pt(h.value),p(h.value)])});function Lt(n,o){M.value=o.pollId,k.value=Array.isArray(o.options)?o.options:[],i.value={title:n.title,description:n.description,username:n.username,createdAt:n.createdAt,Owner:n.owner,voteType:k.value.map(W=>W.content),multiSelect:o.multiSelect,maxSelectCnt:o.maxSelectCnt,postId:o.postId};const l=new Map,m={};k.value.forEach(W=>{l.set(W.optionId,W.content),m[W.content]=0});const I=Array.isArray(o.votes)?o.votes:[];I.forEach(W=>{const Z=l.get(W.optionId);Z&&(m[Z]=(m[Z]||0)+1)}),$.value=m,c.value=I.length}async function Ot(n){try{const{data:o}=await j.get(`/poll/check/${M.value}`,{headers:{Authorization:`Bearer ${n}`}});K.value=!!o?.check}catch(o){console.error("íˆ¬í‘œ ì—¬ë¶€ í™•ì¸ ì‹¤íŒ¨",o)}}async function Ut(){if(!i.value)return;const n=localStorage.getItem("token");if(!n||!b.value){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."),a.push("/login");return}const o=Array.from(J.value);if(o.length===0){alert("í•­ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");return}if(S.value&&o.length>V.value){alert(`ìµœëŒ€ ${V.value}ê°œê¹Œì§€ ì„ íƒí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.`);return}try{const l=A.params.id||A.query.id;S.value&&V.value>1?await j.post("/votes",{pollId:M.value,optionIds:o},{headers:{Authorization:`Bearer ${n}`}}):await j.post("/vote",{pollId:M.value,optionId:o[0]},{headers:{Authorization:`Bearer ${n}`}}),alert("íˆ¬í‘œ ì™„ë£Œ!"),K.value=!0,window.location.href="/post/"+l}catch(l){console.error(l),alert("íˆ¬í‘œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ")}}async function zt(n){const{data:o}=await j.get("/comments",{params:{postId:n}});T.value=Array.isArray(o?.ok)&&o.ok||Array.isArray(o?.comments)&&o.comments||Array.isArray(o?.data?.comments)&&o.data.comments||[]}async function xt(){if(E.value)return;if(!D.value.trim()){alert("ëŒ“ê¸€ ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”!");return}const n=localStorage.getItem("token");if(!n||!b.value){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."),a.push("/login");return}E.value=!0;try{await j.post("/comment",{content:D.value,username:_.username,postId:h.value},{headers:{Authorization:`Bearer ${n}`}}),await zt(h.value),D.value=""}catch(o){console.error(o),alert("ëŒ“ê¸€ ì €ìž¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ")}finally{E.value=!1}}async function Ft(n){if(!confirm("ëŒ“ê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))return;const o=localStorage.getItem("token");if(!o){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."),a.push("/login");return}try{await j.delete(`/comment/${n.id}`,{headers:{Authorization:`Bearer ${o}`}}),T.value=T.value.filter(l=>l.id!==n.id)}catch(l){console.error(l),alert("ëŒ“ê¸€ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ")}}function St(n){bt.value=n.id,_t.value[n.id]=n.content}function Wt(){bt.value!=null&&(_t.value[bt.value]=""),bt.value=null}async function Ht(n){const o=_t.value[n]||"";if(!o.trim()){alert("ìˆ˜ì •í•  ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”.");return}const l=localStorage.getItem("token");if(!l){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."),a.push("/login");return}if(!Q.value){Q.value=!0;try{const{data:m}=await j.put(`/comment/${n}`,{content:o},{headers:{Authorization:`Bearer ${l}`}}),I=m?.comment??m??{};T.value=T.value.map(W=>W.id===n?{...W,content:I.content??o,modifiedAt:I.modifiedAt??I.updatedAt??W.modifiedAt}:W),bt.value=null}catch(m){console.error(m),alert("ëŒ“ê¸€ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ ë°œìƒ")}finally{Q.value=!1}}}async function Xt(n){const{data:o}=await j.get("/replys",{params:{postId:n}}),m=(Array.isArray(o?.ok)&&o.ok||Array.isArray(o?.replies)&&o.replies||Array.isArray(o?.data)&&o.data||[]).reduce((I,W)=>{const Z=W.commentId??W.commentUID??W.comment_id;return Z&&(I[Z]||(I[Z]=[])).push({id:W.id,username:W.username,content:W.content,createdAt:W.createdAt,updatedAt:W.updatedAt??null,owner:W.owner,author:W.author}),I},{});O.value=m}function x(n){L.value=L.value===n?null:n}async function f(n){const o=X.value[n]||"";if(!b.value){a.push("/login");return}if(!o.trim()){alert("ë‹µê¸€ ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”.");return}if(N.value[n])return;N.value[n]=!0;const l=localStorage.getItem("token");try{await j.post("/reply",{commentId:n,postId:h.value,username:_.username,content:o},{headers:{Authorization:`Bearer ${l}`}}),await Promise.all([zt(h.value),Xt(h.value)]),L.value=null,X.value[n]="",mt.value++}catch(m){console.error(m),alert("ë‹µê¸€ ì €ìž¥ ì‹¤íŒ¨")}finally{N.value[n]=!1}}function C(n){et.value[n.id]=n.content,ut.value[n.id]=!0}function B(n){ut.value[n]=!1}async function q(n){const o=(et.value[n.id]||"").trim();if(!o){alert("ë‹µê¸€ ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”.");return}const l=localStorage.getItem("token");if(!l){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."),a.push("/login");return}try{const{data:m}=await j.put(`/reply/${n.id}`,{content:o},{headers:{Authorization:`Bearer ${l}`}}),I=m?.reply??{},W=Object.keys(O.value).find(Z=>O.value[Z].some(It=>It.id===n.id));W&&(O.value[W]=O.value[W].map(Z=>Z.id===n.id?{...Z,content:I.content??o,updatedAt:I.updatedAt??new Date().toISOString()}:Z)),ut.value[n.id]=!1}catch(m){console.error(m),alert("ë‹µê¸€ ìˆ˜ì • ì‹¤íŒ¨")}}async function at(n){if(!confirm("ë‹µê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))return;const o=localStorage.getItem("token");if(!o){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."),a.push("/login");return}try{await j.delete(`/reply/${n.id}`,{headers:{Authorization:`Bearer ${o}`}});const l=Object.keys(O.value).find(m=>O.value[m].some(I=>I.id===n.id));l&&(O.value[l]=O.value[l].filter(m=>m.id!==n.id))}catch(l){console.error(l),alert("ë‹µê¸€ ì‚­ì œ ì‹¤íŒ¨")}}async function ht(n,o){if(!b.value){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."),a.push("/login");return}if(!h.value)return;yt(n,o);const l=ft(n,o),m=ot.value[l],I=m.liked,W=m.count;m.liked=!I,m.count=W+(I?-1:1);try{await j.post("/like",{postId:h.value,targetId:o,targetType:n})}catch(Z){console.error(Z),m.liked=I,m.count=W}}async function Pt(n){try{const{data:o}=await j.get(`/like/count/${n}`),l=Array.isArray(o?.likes)?o.likes:[],m=Array.isArray(T.value)?T.value:[],I=O.value&&typeof O.value=="object"?O.value:{},W=new Set(m.map(It=>Number(It.id))),Z=new Set;Object.values(I).forEach(It=>(It||[]).forEach(Tt=>Z.add(Number(Tt.id)))),l.forEach(It=>{const Tt=Number(It.targetId??It.id),Vt=Number(It.count??0);if(!Number.isFinite(Tt))return;let qt=null;h.value&&Tt===Number(h.value)?qt="POST":W.has(Tt)?qt="COMMENT":Z.has(Tt)&&(qt="REPLY");const Gt=ft(qt,Tt),be=ot.value[Gt]||{liked:!1,count:0};ot.value[Gt]={liked:be.liked,count:Vt}})}catch(o){console.error("like count ë¡œë“œ ì‹¤íŒ¨",o)}}async function p(n){const o=localStorage.getItem("token");if(o)try{const{data:l}=await j.get(`/like/detail/${n}`,{headers:{Authorization:`Bearer ${o}`}});(Array.isArray(l?.likes)?l.likes:[]).forEach(I=>{const W=I.targetType??I.target_type??I.type,Z=Number(I.targetId??I.target_id??I.id),It=!!(I.isOwner??I.owner??I.liked);if(!W||!Z)return;const Tt=ft(W,Z),Vt=ot.value[Tt]||{liked:!1,count:0};ot.value[Tt]={liked:It,count:Vt.count}})}catch(l){console.error("like detail ë¡œë“œ ì‹¤íŒ¨",l)}}async function d(){if(confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&i.value)try{const n=localStorage.getItem("token");await j.delete(`/post/${i.value.postId}`,{headers:n?{Authorization:`Bearer ${n}`}:{}}),a.push("/")}catch(n){console.error(n),alert("ì‚­ì œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ")}}return(n,o)=>(e(),s("div",Rl,[t("div",Nl,[i.value?(e(),s("div",Dl,[t("div",jl,v(i.value.title),1),t("div",Ul,[t("span",null,v(pt.value)+" "+v(i.value.username)+" Â· "+v(R(i.value.createdAt)),1),o[3]||(o[3]=t("span",{class:"text-muted"},"Â·",-1)),h.value?(e(),s("span",Bl,[t("i",{class:lt([["bi",At("POST",h.value)?"bi-heart-fill text-like":"bi-heart"],"me-1"])},null,2),t("span",null,v(wt("POST",h.value)),1)])):P("",!0),i.value.Owner?(e(),s("button",{key:1,class:"btn btn-sm btn-danger ms-2",onClick:d},"ì‚­ì œ")):P("",!0)]),i.value.description?(e(),s("p",Fl,v(i.value.description),1)):P("",!0),t("h6",Vl,[o[4]||(o[4]=H(" íˆ¬í‘œ ")),S.value?(e(),s("small",Wl," (ìµœëŒ€ "+v(V.value)+"ê°œ ì„ íƒ ê°€ëŠ¥ Â· í˜„ìž¬ "+v(st.value)+"ê°œ) ",1)):P("",!0)]),(e(!0),s(Y,null,dt(i.value.voteType,(l,m)=>(e(),s("div",{key:m,class:"mb-3"},[t("div",{class:lt(["poll-choice d-flex justify-content-between align-items-center",{active:it(U(m)?.optionId),"disabled-choice":S.value&&!it(U(m)?.optionId)&&st.value>=V.value}]),onClick:I=>gt(U(m))},[t("span",ql,[S.value?(e(),s("i",{key:1,class:lt(["far",it(U(m)?.optionId)?"fa-check-square":"fa-square"])},null,2)):(e(),s("i",{key:0,class:lt(["far",it(U(m)?.optionId)?"fa-dot-circle":"fa-circle"])},null,2)),H(" "+v(l),1)]),o[5]||(o[5]=t("i",{class:"far fa-circle"},null,-1))],10,Hl),t("div",Yl,[t("div",{class:"poll-bar-fill",style:oe({width:ct($.value[l]||0)+"%",background:r[m%r.length]})},[t("span",Xl,v(ct($.value[l]||0))+"% ",1)],4)])]))),128)),F.value?(e(),s("p",Kl,v(F.value),1)):P("",!0),t("div",Ql,[t("small",Gl,"ðŸ‘¥ "+v(c.value)+"ëª… ì°¸ì—¬",1),t("div",Jl,[b.value?(e(),s(Y,{key:0},[K.value?(e(),s("p",ti,"ì´ë¯¸ íˆ¬í‘œí•˜ì‹  ì„¤ë¬¸ìž…ë‹ˆë‹¤.")):(e(),s("button",{key:0,class:"btn btn-kakao",disabled:!vt.value,onClick:Ut}," íˆ¬í‘œí•˜ê¸° ",8,Zl))],64)):(e(),s(Y,{key:1},[o[6]||(o[6]=t("button",{class:"btn btn-kakao",disabled:"",title:"ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤"},"íˆ¬í‘œí•˜ê¸°",-1)),o[7]||(o[7]=t("p",{class:"text-danger small mt-2 mb-0"},"â€» ë¡œê·¸ì¸ í›„ íˆ¬í‘œí•˜ì‹¤ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.",-1))],64))])]),t("footer",ei,[t("div",si,[o[8]||(o[8]=t("i",{class:"bi bi-chat-dots me-1"},null,-1)),H(" ëŒ“ê¸€ "+v(T.value.length),1)]),h.value?(e(),s("button",{key:0,class:"btn btn-sm btn-outline-danger like-btn d-inline-flex align-items-center",onClick:o[0]||(o[0]=()=>ht("POST",h.value))},[t("i",{class:lt([["bi",At("POST",h.value)?"bi-heart-fill text-like":"bi-heart"],"me-1"])},null,2),t("span",null,v(wt("POST",h.value)),1)])):P("",!0)])])):(e(),s("div",ni,"íˆ¬í‘œ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤."))]),t("section",oi,[t("div",ai,[t("h5",li,[o[9]||(o[9]=t("i",{class:"bi bi-chat"},null,-1)),o[10]||(o[10]=H(" ëŒ“ê¸€ ")),t("span",ii,"("+v(T.value.length)+")",1)])]),T.value.length===0?(e(),s("div",ri," ì•„ì§ ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ ëŒ“ê¸€ì„ ë‚¨ê²¨ë³´ì„¸ìš”. ")):P("",!0),(e(!0),s(Y,null,dt(T.value,l=>(e(),s("div",{key:l.id+"-"+mt.value,class:"comment-item d-flex"},[t("div",ui,[t("span",null,v((l.username||"?").charAt(0).toUpperCase()),1)]),t("div",ci,[t("div",di,[t("div",mi,[rt(kt(Bt),{to:`/user/profile/${l.username}`,class:"comment-author text-decoration-none"},{default:Mt(()=>[t("span",vi,v(nt(l.username)),1),t("span",pi,v(l.username),1),l.author?(e(),s("span",fi,"ê¸€ì“´ì´")):P("",!0),l.owner?(e(),s("span",bi,"ìž‘ì„±ìž")):P("",!0)]),_:2},1032,["to"]),t("small",gi,[l.updatedAt||l.modifiedAt?(e(),s(Y,{key:0},[H(" (ìˆ˜ì •ë¨ Â· "+v(R(l.updatedAt||l.modifiedAt))+") ",1)],64)):(e(),s(Y,{key:1},[H(v(R(l.createdAt)),1)],64))])]),t("div",hi,[l.owner?(e(),s("button",{key:0,class:"btn btn-sm btn-link text-secondary p-0",onClick:m=>St(l)}," ìˆ˜ì • ",8,yi)):P("",!0),l.owner?(e(),s("button",{key:1,class:"btn btn-sm btn-link text-danger p-0",onClick:m=>Ft(l)}," ì‚­ì œ ",8,ki)):P("",!0),t("button",{class:"btn btn-sm btn-link text-danger p-0 d-inline-flex align-items-center",onClick:()=>ht("COMMENT",l.id)},[t("i",{class:lt([["bi",At("COMMENT",l.id)?"bi-heart-fill text-like":"bi-heart"],"me-1"])},null,2),t("span",$i,v(wt("COMMENT",l.id)),1)],8,_i)])]),t("div",{class:"mt-1 comment-content",innerHTML:z(l.content)},null,8,wi),bt.value===l.id?(e(),s("div",xi,[tt(t("textarea",{"onUpdate:modelValue":m=>_t.value[l.id]=m,rows:"2",class:"form-control mb-2",placeholder:"ìˆ˜ì •í•  ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”."},null,8,Ci),[[$t,_t.value[l.id]]]),t("div",Ai,[t("button",{class:"btn btn-sm btn-primary",disabled:Q.value,onClick:m=>Ht(l.id)}," ìˆ˜ì • ì™„ë£Œ ",8,Pi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:Wt}," ì·¨ì†Œ ")])])):P("",!0),O.value&&O.value[l.id]?(e(),s("div",Si,[(e(!0),s(Y,null,dt(O.value[l.id],m=>(e(),s("div",{key:m.id,class:"reply-item"},[t("div",Ii,[t("div",Li,[rt(kt(Bt),{to:`/user/profile/${m.username}`,class:"comment-author text-decoration-none"},{default:Mt(()=>[t("span",Ti,v(nt(m.username)),1),t("span",Ei,v(m.username),1),m.author?(e(),s("span",Mi,"ê¸€ì“´ì´")):P("",!0),m.owner?(e(),s("span",Oi,"ìž‘ì„±ìž")):P("",!0)]),_:2},1032,["to"]),t("small",zi,[m.updatedAt?(e(),s(Y,{key:0},[H(" (ìˆ˜ì •ë¨ Â· "+v(R(m.updatedAt))+") ",1)],64)):(e(),s(Y,{key:1},[H(v(R(m.createdAt)),1)],64))])]),t("div",Ri,[m.owner?(e(),s("button",{key:0,class:"btn btn-link btn-sm text-secondary p-0 me-2",onClick:I=>C(m)}," ìˆ˜ì • ",8,Ni)):P("",!0),m.owner?(e(),s("button",{key:1,class:"btn btn-link btn-sm text-danger p-0",onClick:I=>at(m)}," ì‚­ì œ ",8,Di)):P("",!0),t("button",{class:"btn btn-link btn-sm text-danger p-0 d-inline-flex align-items-center",onClick:()=>ht("REPLY",m.id)},[t("i",{class:lt([["bi",At("REPLY",m.id)?"bi-heart-fill text-like":"bi-heart"],"me-1"])},null,2),t("span",Ui,v(wt("REPLY",m.id)),1)],8,ji)])]),ut.value[m.id]?(e(),s("div",Bi,[tt(t("textarea",{"onUpdate:modelValue":I=>et.value[m.id]=I,rows:"2",class:"form-control mb-2"},null,8,Fi),[[$t,et.value[m.id]]]),t("div",Vi,[t("button",{class:"btn btn-sm btn-primary",onClick:I=>q(m)}," ì €ìž¥ ",8,Wi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:I=>B(m.id)}," ì·¨ì†Œ ",8,Hi)])])):(e(),s("div",qi,v(m.content),1))]))),128))])):P("",!0),t("button",{class:"btn btn-sm btn-outline-primary mt-2",onClick:m=>x(l.id)}," ë‹µê¸€ ë‹¬ê¸° ",8,Yi),tt(t("div",Xi,[tt(t("textarea",{"onUpdate:modelValue":m=>X.value[l.id]=m,rows:"2",class:"form-control mb-2",placeholder:"ë‹µê¸€ ìž…ë ¥"},null,8,Ki),[[$t,X.value[l.id]]]),t("button",{class:"btn btn-sm btn-primary",onClick:m=>f(l.id),disabled:N.value[l.id]}," ë‹µê¸€ ìž‘ì„± ",8,Qi)],512),[[Rt,L.value===l.id]])])]))),128))]),t("section",Gi,[t("div",Ji,[o[11]||(o[11]=t("h6",{class:"mb-0"},[t("i",{class:"bi bi-pencil-square me-1"}),H(" ëŒ“ê¸€ ì“°ê¸° ")],-1)),b.value?P("",!0):(e(),s("button",{key:0,class:"btn btn-sm btn-outline-secondary",onClick:o[1]||(o[1]=l=>kt(a).push("/login"))}," ë¡œê·¸ì¸ "))]),tt(t("textarea",{"onUpdate:modelValue":o[2]||(o[2]=l=>D.value=l),rows:"3",class:"form-control mb-2",placeholder:b.value?"ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”.":"ë¡œê·¸ì¸ í›„ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤."},null,8,Zi),[[$t,D.value]]),t("div",tr,[t("button",{class:"btn btn-success px-4",disabled:!b.value||E.value||!D.value.trim(),onClick:xt}," ìž‘ì„±í•˜ê¸° ",8,er)])])]))}},nr=Ct(sr,[["__scopeId","data-v-4bd0b04c"]]),Fu=Object.freeze(Object.defineProperty({__proto__:null,default:nr},Symbol.toStringTag,{value:"Module"})),or={class:"row g-3"},ar={key:0,class:"text-center text-muted w-100"},lr={class:"card shadow-sm rounded-4 overflow-hidden position-relative hover-effect"},ir={class:"card-body p-3"},rr={class:"card-title text-truncate"},ur={class:"card-text text-muted text-truncate"},cr={class:"badge bg-primary"},dr={class:"card-footer d-flex justify-content-between align-items-center bg-light"},mr={class:"text-muted"},vr={class:"text-muted me-2"},pr={class:"text-muted"},fr={__name:"PostCardList",props:{items:Array},setup(g){function A(a){if(!a)return"";const _=new Date(a),w=_.getMonth()+1,i=_.getDate();let $=_.getHours();const r=_.getMinutes(),c=$>=12?"ì˜¤í›„":"ì˜¤ì „";return $=$%12||12,`${w}.${i}. ${c} ${$}:${r.toString().padStart(2,"0")}`}return(a,_)=>(e(),s("div",or,[g.items.length?P("",!0):(e(),s("div",ar," ìž‘ì„±ëœ í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤. ")),(e(!0),s(Y,null,dt(g.items,w=>(e(),s("div",{key:w.id,class:"col-md-6 col-lg-4"},[rt(kt(Bt),{to:`/post/${w.id}`,class:"text-decoration-none text-dark"},{default:Mt(()=>[t("div",lr,[t("div",{class:"feed-img position-relative",style:oe({background:`url(${w.imageURL||"https://source.unsplash.com/300x200/?abstract"}) center/cover no-repeat`,height:"180px"})},_[0]||(_[0]=[t("div",{class:"overlay d-flex align-items-center justify-content-center"},[t("button",{class:"btn btn-light btn-sm"},"ìƒì„¸ë³´ê¸°")],-1)]),4),t("div",ir,[t("h5",rr,v(w.title||"ì œëª© ì—†ìŒ"),1),t("p",ur,v(w.description||"ë‚´ìš© ì—†ìŒ"),1),t("span",cr,v(w.category||"ì¹´í…Œê³ ë¦¬ ì—†ìŒ"),1)]),t("div",dr,[t("small",mr,v(A(w.createdAt)),1),t("div",null,[t("span",vr,[_[1]||(_[1]=t("i",{class:"fas fa-heart text-danger"},null,-1)),H(" "+v(w.likeCount||0),1)]),t("span",pr,[_[2]||(_[2]=t("i",{class:"fas fa-eye"},null,-1)),H(" "+v(w.viewCount||0),1)])])])])]),_:2},1032,["to"])]))),128))]))}},Kt=Ct(fr,[["__scopeId","data-v-6c1fcea9"]]),br={class:"list-group"},gr={key:0,class:"list-group-item text-center text-muted"},hr={class:"comment-item"},yr={class:"mt-2"},kr={__name:"CommentList",props:{items:Array},setup(g){function A(a){return a?new Date(a).toLocaleString("ko-KR"):""}return(a,_)=>(e(),s("ul",br,[g.items.length?P("",!0):(e(),s("li",gr," ìž‘ì„±ëœ ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤. ")),(e(!0),s(Y,null,dt(g.items,w=>(e(),s("li",{key:w.postId,class:"list-group-item"},[t("div",hr,[t("div",null,[_[0]||(_[0]=t("strong",null,"ëŒ“ê¸€ ë‚´ìš©:",-1)),H(" "+v(w.content||"ë‚´ìš© ì—†ìŒ"),1)]),t("div",null,[_[1]||(_[1]=t("strong",null,"ìž‘ì„±ì¼ìž:",-1)),H(" "+v(A(w.createdAt)),1)]),t("div",null,[_[2]||(_[2]=t("strong",null,"ì¢‹ì•„ìš”:",-1)),H(" "+v(w.likeCount||0)+"ê°œ",1)]),t("div",yr,[rt(kt(Bt),{class:"btn btn-sm btn-primary",to:`/post/${w.postId}`},{default:Mt(()=>_[3]||(_[3]=[H(" ê²Œì‹œë¬¼ ë³´ëŸ¬ ê°€ê¸° ")])),_:2},1032,["to"])])])]))),128))]))}},fe=Ct(kr,[["__scopeId","data-v-f3b8dd34"]]),_r={key:0,"aria-label":"Page navigation"},$r={class:"pagination justify-content-center"},wr=["onClick"],xr={__name:"PaginationControls",props:{paging:{type:Object,required:!0,default:()=>({currentPage:0,totalPages:1,totalElements:0,size:10})}},emits:["goToPage"],setup(g,{emit:A}){return(a,_)=>g.paging.totalPages>1?(e(),s("nav",_r,[t("ul",$r,[t("li",{class:lt(["page-item",{disabled:g.paging.currentPage===0}])},[t("button",{class:"page-link",onClick:_[0]||(_[0]=w=>a.$emit("goToPage",g.paging.currentPage-1))},"ì´ì „")],2),(e(!0),s(Y,null,dt(g.paging.totalPages,w=>(e(),s("li",{class:lt(["page-item",{active:w-1===g.paging.currentPage}]),key:w},[t("button",{class:"page-link",onClick:i=>a.$emit("goToPage",w-1)},v(w),9,wr)],2))),128)),t("li",{class:lt(["page-item",{disabled:g.paging.currentPage===g.paging.totalPages-1}])},[t("button",{class:"page-link",onClick:_[1]||(_[1]=w=>a.$emit("goToPage",g.paging.currentPage+1))},"ë‹¤ìŒ")],2)])])):P("",!0)}},Zt=Ct(xr,[["__scopeId","data-v-785a59ac"]]),Cr={class:"mypage with-fixed-bars container mt-3 mt-md-4"},Ar={class:"profile-header card-soft p-3 p-md-4 mb-3 mb-md-4"},Pr={class:"d-flex align-items-center gap-3"},Sr={class:"avatar"},Ir={class:"flex-grow-1"},Lr={class:"d-flex align-items-center gap-2 flex-wrap"},Tr={class:"name m-0"},Er={class:"point-chip"},Mr={class:"sub text-muted mt-1"},Or={class:"stats-grid mb-3 mb-md-4"},zr={class:"icon"},Rr={class:"meta"},Nr={class:"label"},Dr={class:"tabs-wrap mb-3 mb-md-4"},jr={class:"segmented-tabs",role:"tablist"},Ur=["onClick"],Br={class:"tab-content mt-3"},Fr={class:"mt-4 pager-sticky"},Vr={class:"mt-4 pager-sticky"},Wr={class:"mt-4 pager-sticky"},Hr={class:"mt-4 pager-sticky"},qr={__name:"SomeoneProfile",setup(g){const A=Yt(),a=jt(),_=localStorage.getItem("token"),w=u({value:null,point:0}),i=A.params.username??"",$=i,r=u("posts"),c=[{id:"posts",label:"ìž‘ì„±í•œ ê²Œì‹œê¸€"},{id:"comments",label:"ìž‘ì„±í•œ ëŒ“ê¸€"},{id:"commentedPosts",label:"ëŒ“ê¸€ ë‹¨ ê²Œì‹œê¸€"},{id:"likedPosts",label:"ì¢‹ì•„ìš”í•œ ê¸€"}],y=u([]),k=u([]),T=u([]),O=u([]),D=u({posts:{currentPage:0,totalPages:1,totalElements:0,size:10},comments:{currentPage:0,totalPages:1,totalElements:0,size:10},commentedPosts:{currentPage:0,totalPages:1,totalElements:0,size:10},likedPosts:{currentPage:0,totalPages:1,totalElements:0,size:10}}),E=u([{label:"ê²Œì‹œë¬¼ ìˆ˜",icon:"fas fa-pen",value:0,color:"text-primary"},{label:"ëŒ“ê¸€ ìˆ˜",icon:"fas fa-comments",value:0,color:"text-success"},{label:"ë°›ì€ ì¢‹ì•„ìš”",icon:"fas fa-heart",value:0,color:"text-danger"},{label:"ë°©ë¬¸ ìˆ˜",icon:"fas fa-eye",value:0,color:"text-info"}]);async function L(Q,M,K,F,Et){const h=new URLSearchParams;K&&h.set("username",K),F!=null&&h.set("page",F),Et!=null&&h.set("size",Et);const b=await fetch(`/api${Q}?${h.toString()}`,{headers:M});return b.ok?await b.json():null}async function X(){const Q={Authorization:`Bearer ${_}`},M=await L("/someone/point",Q,i,null,null);M?.point&&(w.value.point=M.point.userPoint,E.value[2].value=M.point.likeCount??0),w.value.value=i}async function N(Q=0){if(!_)return;const M={Authorization:`Bearer ${_}`},K=D.value.posts.size,F=await L("/someone",M,i,Q,K);F&&(y.value=F.content||[],D.value.posts.currentPage=F.page,D.value.posts.totalPages=F.totalPages,D.value.posts.totalElements=F.totalElements,E.value[0].value=F.totalElements||0)}async function et(Q=0){if(!_)return;const M={Authorization:`Bearer ${_}`},K=D.value.comments.size,F=await L("/someone/comment/paging",M,i,Q,K);F&&(k.value=F.comments||[],D.value.comments.currentPage=Q,D.value.comments.totalPages=F.totalPage,D.value.comments.totalElements=F.totalCountComment,E.value[1].value=F.totalCountComment||0)}async function ut(Q=0){if(!_)return;const M={Authorization:`Bearer ${_}`},K=D.value.commentedPosts.size,F=await L("/someone/post/comment/paging",M,i,Q,K);F&&(T.value=F.all||[],D.value.commentedPosts.currentPage=Q,D.value.commentedPosts.totalPages=F.totalPage,D.value.commentedPosts.totalElements=F.totalCountComment)}async function ot(Q=0){if(!_)return;const M={Authorization:`Bearer ${_}`},K=D.value.likedPosts.size,F=await L("/someone/feed/like/paging",M,i,Q,K);if(!F){O.value=[],D.value.likedPosts={...D.value.likedPosts,currentPage:0,totalPages:1,totalElements:0};return}O.value=F.content??F.posts??[],D.value.likedPosts.currentPage=F.page??Q,D.value.likedPosts.totalPages=F.totalPages??F.totalPage??1,D.value.likedPosts.totalElements=F.totalElements??F.total??0}const mt=Q=>{const M=D.value[r.value];if(M&&!(Q<0||Q>=M.totalPages))switch(r.value){case"posts":return N(Q);case"comments":return et(Q);case"commentedPosts":return ut(Q);case"likedPosts":return ot(Q)}};function bt(){const Q=document.querySelector(".fixed-top, header.navbar, .navbar"),M=document.querySelector(".app-bottom-bar, .mobile-tabbar, .fab-bar"),K=Q?.offsetHeight||64,F=M?.offsetHeight||0;document.documentElement.style.setProperty("--app-nav-h",`${K}px`),document.documentElement.style.setProperty("--app-bottom-h",`${F}px`)}async function _t(){if(!_){alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."),a.push("/login");return}bt(),await X(),await N(0)}return Qt(r,()=>{mt(0)}),Dt(()=>{_t(),window.addEventListener("resize",bt)}),(Q,M)=>(e(),s("div",Cr,[t("section",Ar,[t("div",Pr,[t("div",Sr,[t("span",null,v((kt(i)||"U").charAt(0).toUpperCase()),1)]),t("div",Ir,[t("div",Lr,[t("h2",Tr,v(kt(i)),1),t("span",Er,[M[0]||(M[0]=t("i",{class:"fas fa-bolt me-1"},null,-1)),H(v((w.value.point||0).toLocaleString()),1)])]),t("div",Mr,[M[1]||(M[1]=H("ì•„ì´ë”” ")),t("strong",null,v(kt($)),1)])]),M[2]||(M[2]=t("button",{class:"btn btn-icon d-none d-md-inline-flex",type:"button",title:"í†µê³„"},[t("i",{class:"fas fa-chart-pie"})],-1))])]),t("section",Or,[(e(!0),s(Y,null,dt(E.value,K=>(e(),s("div",{class:"stat-card",key:K.label},[t("div",zr,[t("i",{class:lt(K.icon)},null,2)]),t("div",Rr,[t("div",Nr,v(K.label),1),t("div",{class:lt(["value",K.color])},v((K.value??0).toLocaleString()),3)])]))),128))]),t("section",Dr,[t("div",jr,[(e(),s(Y,null,dt(c,K=>t("button",{key:K.id,type:"button",class:lt(["seg-btn",{active:r.value===K.id}]),onClick:F=>r.value=K.id},v(K.label),11,Ur)),64))])]),t("section",Br,[tt(t("div",null,[rt(Kt,{items:y.value,type:"feed"},null,8,["items"]),t("div",Fr,[rt(Zt,{paging:D.value.posts,onGoToPage:mt},null,8,["paging"])])],512),[[Rt,r.value==="posts"]]),tt(t("div",null,[rt(fe,{items:k.value},null,8,["items"]),t("div",Vr,[rt(Zt,{paging:D.value.comments,onGoToPage:mt},null,8,["paging"])])],512),[[Rt,r.value==="comments"]]),tt(t("div",null,[rt(Kt,{items:T.value,type:"commented"},null,8,["items"]),t("div",Wr,[rt(Zt,{paging:D.value.commentedPosts,onGoToPage:mt},null,8,["paging"])])],512),[[Rt,r.value==="commentedPosts"]]),tt(t("div",null,[rt(Kt,{items:O.value,type:"liked"},null,8,["items"]),t("div",Hr,[rt(Zt,{paging:D.value.likedPosts,onGoToPage:mt},null,8,["paging"])])],512),[[Rt,r.value==="likedPosts"]])])]))}},Yr=Ct(qr,[["__scopeId","data-v-8fb6229a"]]),Vu=Object.freeze(Object.defineProperty({__proto__:null,default:Yr},Symbol.toStringTag,{value:"Module"})),Xr={class:"list-group"},Kr={class:"fw-semibold mb-2"},Qr={class:"mb-2 ps-3 small"},Gr=["onClick"],Jr={key:0,class:"text-muted small"},Zr={__name:"BookmarkList",props:{items:Array},setup(g){const A=we({});function a(w){A[w]=!A[w]}function _(w){if(!w)return[];try{return typeof w=="string"?JSON.parse(w):w}catch{return[]}}return(w,i)=>(e(),s("ul",Xr,[(e(!0),s(Y,null,dt(g.items,($,r)=>(e(),s("li",{key:$.id||r,class:"list-group-item"},[t("div",Kr,v(r+1)+". "+v($.question),1),t("ul",Qr,[(e(!0),s(Y,null,dt(_($.choices),(c,y)=>(e(),s("li",{key:y},v(y+1)+". "+v(c),1))),128))]),t("button",{class:"btn btn-sm btn-outline-primary mb-2",onClick:c=>a(r)},v(A[r]?"ì •ë‹µ ìˆ¨ê¸°ê¸°":"ì •ë‹µ ë³´ê¸°"),9,Gr),A[r]?(e(),s("div",Jr,[i[0]||(i[0]=t("span",{class:"fw-bold"},"ì •ë‹µ:",-1)),H(" "+v($.answer),1)])):P("",!0)]))),128))]))}},tu={class:"pagination-container my-4"},eu={class:"pagination-grid"},su={class:"nav-side left"},nu=["disabled"],ou=["disabled"],au=["disabled"],lu={class:"num-center"},iu=["onClick"],ru={class:"nav-side right"},uu=["disabled"],cu=["disabled"],du=["disabled"],mu={__name:"Pagination",props:{page:{type:Number,required:!0},totalPages:{type:Number,required:!0}},emits:["change"],setup(g,{emit:A}){const a=g,_=A,w=G(()=>{const $=a.page,r=a.totalPages,c=window.innerWidth<576?1:2;let y=Math.max(0,$-c),k=Math.min(r-1,$+c);y===0&&(k=Math.min(r-1,c*2)),k===r-1&&(y=Math.max(0,r-c*2-1));const T=[];for(let O=y;O<=k;O++)T.push(O);return T});function i($){$>=0&&$<a.totalPages&&_("change",$)}return($,r)=>(e(),s("nav",tu,[t("div",eu,[t("div",su,[t("button",{class:"p-btn icon",disabled:g.page===0,onClick:r[0]||(r[0]=c=>i(0))},r[6]||(r[6]=[t("i",{class:"fas fa-angle-double-left"},null,-1)]),8,nu),t("button",{class:"p-btn text d-none d-md-block",disabled:g.page===0,onClick:r[1]||(r[1]=c=>i(g.page-1))}," ì´ì „ ",8,ou),t("button",{class:"p-btn icon d-md-none",disabled:g.page===0,onClick:r[2]||(r[2]=c=>i(g.page-1))},r[7]||(r[7]=[t("i",{class:"fas fa-angle-left"},null,-1)]),8,au)]),t("div",lu,[(e(!0),s(Y,null,dt(w.value,c=>(e(),s("button",{key:c,class:lt(["num-btn",{active:c===g.page}]),onClick:y=>i(c)},v(c+1),11,iu))),128))]),t("div",ru,[t("button",{class:"p-btn text d-none d-md-block",disabled:g.page>=g.totalPages-1,onClick:r[3]||(r[3]=c=>i(g.page+1))}," ë‹¤ìŒ ",8,uu),t("button",{class:"p-btn icon d-md-none",disabled:g.page>=g.totalPages-1,onClick:r[4]||(r[4]=c=>i(g.page+1))},r[8]||(r[8]=[t("i",{class:"fas fa-angle-right"},null,-1)]),8,cu),t("button",{class:"p-btn icon",disabled:g.page>=g.totalPages-1,onClick:r[5]||(r[5]=c=>i(g.totalPages-1))},r[9]||(r[9]=[t("i",{class:"fas fa-angle-double-right"},null,-1)]),8,du)])])]))}},vu=Ct(mu,[["__scopeId","data-v-2591f7d9"]]),pu={class:"mypage container mt-3 mt-md-4"},fu={class:"profile-header card-soft p-3 p-md-4 mb-3 mb-md-4"},bu={class:"d-flex align-items-center gap-3"},gu={class:"avatar"},hu={class:"flex-grow-1"},yu={class:"d-flex align-items-center gap-2 flex-wrap"},ku={class:"name m-0"},_u={class:"point-chip"},$u={class:"sub text-muted mt-1"},wu={class:"stats-grid mb-3 mb-md-4"},xu={class:"icon"},Cu={class:"meta"},Au={class:"label"},Pu={class:"tabs-wrap mb-3 mb-md-4"},Su={class:"segmented-tabs",role:"tablist"},Iu=["onClick"],Lu={class:"tab-content mt-3"},Tu={__name:"MyPage",setup(g){const A=localStorage.getItem("token"),a=u(""),_=u(""),w=u(0),i=u("posts"),$=[{id:"posts",label:"ë‚´ê°€ ìž‘ì„±í•œ ê²Œì‹œê¸€"},{id:"comments",label:"ìž‘ì„±í•œ ëŒ“ê¸€"},{id:"commentedPosts",label:"ëŒ“ê¸€ ë‹¨ ê²Œì‹œë¬¼"},{id:"likedPosts",label:"ì¢‹ì•„ìš” í•œ ê¸€"},{id:"bookmarkedQuestions",label:"ë¶ë§ˆí¬í•œ ë¬¸ì œ"}],r=u([]),c=u([]),y=u([]),k=u([]),T=u([]),O=u(0),D=u(10),E=u(1),L=u([{label:"ê²Œì‹œë¬¼ ìˆ˜",icon:"fas fa-pen",value:0,color:"text-primary"},{label:"ëŒ“ê¸€ ìˆ˜",icon:"fas fa-comments",value:0,color:"text-success"},{label:"ë°›ì€ ì¢‹ì•„ìš”",icon:"fas fa-heart",value:0,color:"text-danger"},{label:"ë°©ë¬¸ ìˆ˜",icon:"fas fa-eye",value:0,color:"text-info"}]);async function X(){const{data:M}=await j.get("/user/information",_t());a.value=M.username,_.value=M.userId}async function N(){const{data:M}=await j.get("/mypage/point",_t());w.value=M.point.userPoint,L.value[2].value=M.point.likeCount}async function et(){i.value==="posts"?await ut():i.value==="comments"?await ot():i.value==="commentedPosts"?await mt():i.value==="likedPosts"?await loadLikedPosts():i.value==="bookmarkedQuestions"&&await bt()}async function ut(){const{data:M}=await j.get(`/mypage/post/paging?page=${O.value}&size=${D.value}`,_t());r.value=M.posts??[],E.value=M.totalPage??1,L.value[0].value=M.totalCountPost??0}async function ot(){const{data:M}=await j.get(`/mypage/comment/paging?page=${O.value}&size=${D.value}`,_t());c.value=M.comments,E.value=M.totalPages??1,L.value[1].value=M.totalCountComment??0}async function mt(){const{data:M}=await j.get(`/mypage/post/comment/paging?page=${O.value}&size=${D.value}`,_t());y.value=M.all,E.value=M.totalPages??1}async function bt(){const{data:M}=await j.get(`/get/daily/bookmark?page=${O.value}&size=${D.value}`,_t());T.value=M.bookmarks,E.value=M.totalPages??1}function _t(){return{headers:{Authorization:`Bearer ${A}`}}}Qt(i,()=>{O.value=0,et()});function Q(M){O.value=M,et()}return Dt(async()=>{A&&(await X(),await N(),await ut())}),(M,K)=>(e(),s("div",pu,[t("section",fu,[t("div",bu,[t("div",gu,[t("span",null,v((a.value||"U").charAt(0).toUpperCase()),1)]),t("div",hu,[t("div",yu,[t("h2",ku,v(a.value),1),t("span",_u,[K[0]||(K[0]=t("i",{class:"fas fa-bolt me-1"},null,-1)),H(v(w.value.toLocaleString()),1)])]),t("div",$u,[K[1]||(K[1]=H("ì•„ì´ë”” ")),t("strong",null,v(_.value),1)])]),K[2]||(K[2]=t("button",{class:"btn btn-icon d-none d-md-inline-flex",type:"button",title:"í†µê³„"},[t("i",{class:"fas fa-chart-pie"})],-1))])]),t("section",wu,[(e(!0),s(Y,null,dt(L.value,F=>(e(),s("div",{class:"stat-card",key:F.label},[t("div",xu,[t("i",{class:lt(F.icon)},null,2)]),t("div",Cu,[t("div",Au,v(F.label),1),t("div",{class:lt(["value",F.color])},v((F.value??0).toLocaleString()),3)])]))),128))]),t("section",Pu,[t("div",Su,[(e(),s(Y,null,dt($,F=>t("button",{key:F.id,type:"button",class:lt(["seg-btn",{active:i.value===F.id}]),onClick:Et=>i.value=F.id},v(F.label),11,Iu)),64))])]),t("section",Lu,[tt(t("div",null,[rt(Kt,{items:r.value,type:"feed"},null,8,["items"])],512),[[Rt,i.value==="posts"]]),tt(t("div",null,[rt(fe,{items:c.value},null,8,["items"])],512),[[Rt,i.value==="comments"]]),tt(t("div",null,[rt(Kt,{items:y.value,type:"commented"},null,8,["items"])],512),[[Rt,i.value==="commentedPosts"]]),tt(t("div",null,[rt(Kt,{items:k.value,type:"liked"},null,8,["items"])],512),[[Rt,i.value==="likedPosts"]]),tt(t("div",null,[rt(Zr,{items:T.value},null,8,["items"])],512),[[Rt,i.value==="bookmarkedQuestions"]]),rt(vu,{class:"mt-4",page:O.value,totalPages:E.value,onChange:Q},null,8,["page","totalPages"])])]))}},Eu=Ct(Tu,[["__scopeId","data-v-c97e2f18"]]),Wu=Object.freeze(Object.defineProperty({__proto__:null,default:Eu},Symbol.toStringTag,{value:"Module"}));export{zu as F,Wu as M,Du as N,Nu as P,Vu as S,Bu as V,Ru as a,ju as b,Uu as c,Fu as d,ie as u};
