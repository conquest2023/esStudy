import{r as d,z as R,p as m,m as N,L as K,c as o,b as t,h as v,t as i,F as b,q as g,e as D,u as L,i as l,a3 as V,K as z,n as A}from"./vendor-DMmp5gzX.js";import{_ as T,a as F}from"./auth-CM7Hud5Y.js";const I={class:"search-result-wrap"},P={class:"result-header"},E={class:"result-title"},U={class:"keyword"},j={class:"mode-badge"},G={class:"result-meta"},H={class:"meta-text"},J={key:0,class:"skeleton-list"},O={key:1,class:"result-list"},Q=["onClick","onKeyup"],W={class:"feed-card__main"},X={class:"feed-card__title"},Y={class:"feed-card__meta"},Z={class:"author"},ee={class:"time"},te={class:"feed-card__stats"},se={class:"metric"},ae={class:"metric"},ne={key:0,class:"pager","aria-label":"Search pagination"},oe=["disabled"],le=["onClick"],re=["disabled"],ie={key:2,class:"empty"},x=10,ce={__name:"SearchResult",setup(ue){const n=R(),q=L(),p=d(n.query.text||""),h=d(n.query.type||"content"),y=d(!1),u=d([]),c=d(Number(n.query.page)||1),_=m(()=>Math.max(1,Math.ceil((u.value?.length||0)/x))),C=m(()=>{const s=(c.value-1)*x;return u.value.slice(s,s+x)}),B=m(()=>{const s=[];let e=Math.max(1,c.value-Math.floor(2.5)),r=Math.min(_.value,e+5-1);r-e+1<5&&(e=Math.max(1,r-5+1));for(let k=e;k<=r;k++)s.push(k);return s}),S=m(()=>({title:"제목",content:"내용",post:"제목+내용",user:"유저"})[h.value]||"제목+내용");N(w),K(()=>[n.query.text,n.query.type,n.query.page],()=>{p.value=n.query.text||"",h.value=n.query.type||"content",c.value=Number(n.query.page)||1,w()});async function w(){if(p.value){y.value=!0;try{const s=encodeURIComponent(p.value),a=(()=>{switch(h.value){case"title":return`/search/title/${s}`;case"content":return`/search/content/${s}`;case"post":return`/search/post/${s}`;case"user":return`/search/user/${s}`;default:return`/search/post/${s}`}})(),e=await F.get(a),r=e.data?.content??e.data?.data??[];u.value=Array.isArray(r)?r:[]}catch(s){console.error("검색 실패",s),u.value=[]}finally{y.value=!1}}}function f(s){s<1||s>_.value||q.replace({query:{...n.query,page:s}})}function $(s){q.push({name:"PostDetail",params:{id:s}})}function M(s){return s?new Date(s).toLocaleString("ko-KR",{hour12:!1}):""}return(s,a)=>(l(),o("section",I,[t("div",P,[t("div",E,[a[2]||(a[2]=t("i",{class:"fas fa-search"},null,-1)),t("span",U,"'"+i(p.value)+"'",1),a[3]||(a[3]=v(" 검색 결과 ")),t("span",j,i(S.value),1)]),t("div",G,[a[4]||(a[4]=t("span",{class:"count-dot"},null,-1)),t("span",H,"총 "+i(u.value.length)+"건",1)])]),y.value?(l(),o("div",J,[(l(),o(b,null,g(4,e=>t("div",{key:e,class:"skeleton-card"},a[5]||(a[5]=[V('<div class="sk-title shimmer" data-v-3e717354></div><div class="sk-sub shimmer" data-v-3e717354></div><div class="sk-metrics" data-v-3e717354><div class="sk-metric shimmer" data-v-3e717354></div><div class="sk-metric shimmer" data-v-3e717354></div></div>',3)]))),64))])):C.value.length?(l(),o("div",O,[(l(!0),o(b,null,g(C.value,e=>(l(),o("article",{key:e.id??e.id,class:"feed-card",onClick:r=>$(e.id??e.id),tabindex:"0",onKeyup:z(r=>$(e.id??e.id),["enter"]),role:"button","aria-label":"검색 결과 항목"},[t("div",W,[t("h6",X,i(e.title),1),t("div",Y,[t("span",Z,i(e.username),1),a[6]||(a[6]=t("span",{class:"dot"},"•",-1)),t("span",ee,i(M(e.createdAt)),1)])]),t("div",te,[t("span",se,[a[7]||(a[7]=t("i",{class:"bi bi-eye"},null,-1)),v(i(e.viewCount??0),1)]),t("span",ae,[a[8]||(a[8]=t("i",{class:"bi bi-heart-fill"},null,-1)),v(i(e.likeCount??0),1)])])],40,Q))),128)),_.value>1?(l(),o("nav",ne,[t("button",{class:"pg-btn",disabled:c.value<=1,onClick:a[0]||(a[0]=e=>f(c.value-1))},"이전",8,oe),(l(!0),o(b,null,g(B.value,e=>(l(),o("button",{key:e,class:A(["pg-btn",{active:e===c.value}]),onClick:r=>f(e)},i(e),11,le))),128)),t("button",{class:"pg-btn",disabled:c.value>=_.value,onClick:a[1]||(a[1]=e=>f(c.value+1))},"다음",8,re)])):D("",!0)])):(l(),o("div",ie,a[9]||(a[9]=[t("div",{class:"empty-illust"},[t("div",{class:"circle"}),t("div",{class:"glass"})],-1),t("p",{class:"empty-text"},[v(" 검색 결과가 없습니다."),t("br"),v(" 다른 키워드를 시도해보세요! ")],-1)])))]))}},pe=T(ce,[["__scopeId","data-v-3e717354"]]);export{pe as default};
